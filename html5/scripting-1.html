<!DOCTYPE html><html lang="ja"><meta charset="utf-8"><title>4.11 スクリプティング — HTML5 日本語訳</title><script src="link-fixup.js"></script>
<style type="text/css">

     .applies thead th > * { display: block; }
     .applies thead code { display: block; }
     .applies tbody th { white-space: nowrap; }
     .applies td { text-align: center; }
     .applies .yes { background: yellow; }

     .matrix, .matrix td { border: hidden; text-align: right; }
     .matrix { margin-left: 2em; }

     .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
     .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
     .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

     td.eg { border-width: thin; text-align: center; }

     #table-example-1 { border: solid thin; border-collapse: collapse; margin-left: 3em; }
     #table-example-1 * { font-family: "Essays1743", serif; line-height: 1.01em; }
     #table-example-1 caption { padding-bottom: 0.5em; }
     #table-example-1 thead, #table-example-1 tbody { border: none; }
     #table-example-1 th, #table-example-1 td { border: solid thin; }
     #table-example-1 th { font-weight: normal; }
     #table-example-1 td { border-style: none solid; vertical-align: top; }
     #table-example-1 th { padding: 0.5em; vertical-align: middle; text-align: center; }
     #table-example-1 tbody tr:first-child td { padding-top: 0.5em; }
     #table-example-1 tbody tr:last-child td { padding-bottom: 1.5em; }
     #table-example-1 tbody td:first-child { padding-left: 2.5em; padding-right: 0; width: 9em; }
     #table-example-1 tbody td { padding-left: 2em; padding-right: 2em; }
     #table-example-1 tbody td:first-child + td { width: 10em; }
     #table-example-1 tbody td:first-child + td ~ td { width: 2.5em; }
     #table-example-1 tbody td:first-child + td + td + td ~ td { width: 1.25em; }

     .apple-table-examples { border: none; border-collapse: separate; border-spacing: 1.5em 0em; width: 40em; margin-left: 3em; }
     .apple-table-examples * { font-family: "Times", serif; }
     .apple-table-examples td, .apple-table-examples th { border: none; white-space: nowrap; padding-top: 0; padding-bottom: 0; }
     .apple-table-examples tbody th:first-child { border-left: none; width: 100%; }
     .apple-table-examples thead th:first-child ~ th { font-size: smaller; font-weight: bolder; border-bottom: solid 2px; text-align: center; }
     .apple-table-examples tbody th, .apple-table-examples tfoot th { font: inherit; text-align: left; }
     .apple-table-examples td { text-align: right; vertical-align: top; }
     .apple-table-examples.e1 tbody tr:last-child td { border-bottom: solid 1px; }
     .apple-table-examples.e1 tbody + tbody tr:last-child td { border-bottom: double 3px; }
     .apple-table-examples.e2 th[scope=row] { padding-left: 1em; }
     .apple-table-examples sup { line-height: 0; }

     .details-example img { vertical-align: top; }

     #base64-table {
       white-space: nowrap;
       font-size: 0.6em;
       column-width: 6em;
       column-count: 5;
       column-gap: 1em;
       -moz-column-width: 6em;
       -moz-column-count: 5;
       -moz-column-gap: 1em;
       -webkit-column-width: 6em;
       -webkit-column-count: 5;
       -webkit-column-gap: 1em;
     }
     #base64-table thead { display: none; }
     #base64-table * { border: none; }
     #base64-table tbody td:first-child:after { content: ':'; }
     #base64-table tbody td:last-child { text-align: right; }

     #named-character-references-table {
       white-space: nowrap;
       font-size: 0.6em;
       column-width: 30em;
       column-gap: 1em;
       -moz-column-width: 30em;
       -moz-column-gap: 1em;
       -webkit-column-width: 30em;
       -webkit-column-gap: 1em;
     }
     #named-character-references-table > table > tbody > tr > td:first-child + td,
     #named-character-references-table > table > tbody > tr > td:last-child { text-align: center; }
     #named-character-references-table > table > tbody > tr > td:last-child:hover > span { position: absolute; top: auto; left: auto; margin-left: 0.5em; line-height: 1.2; font-size: 5em; border: outset; padding: 0.25em 0.5em; background: white; width: 1.25em; height: auto; text-align: center; }
     #named-character-references-table > table > tbody > tr#entity-CounterClockwiseContourIntegral > td:first-child { font-size: 0.5em; }

     .glyph.control { color: red; }

     @font-face {
       font-family: 'Essays1743';
       src: url('fonts/Essays1743.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-weight: bold;
       src: url('fonts/Essays1743-Bold.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-style: italic;
       src: url('fonts/Essays1743-Italic.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-style: italic;
       font-weight: bold;
       src: url('fonts/Essays1743-BoldItalic.ttf');
     }

    </style>
<style type="text/css">
       pre { margin-left: 2em; white-space: pre-wrap; }
       h2 { margin: 3em 0 1em 0; }
       h3 { margin: 2.5em 0 1em 0; }
       h4 { margin: 2.5em 0 0.75em 0; }
       h5, h6 { margin: 2.5em 0 1em; }
       h1 + h2, h1 + h2 + h2, h1 + p, h1 + p + h2 { margin: 0.75em 0 0.75em; }
       h2 + h3, h3 + h4, h4 + h5, h5 + h6 { margin-top: 0.5em; }
       p { margin: 1em 0; }
       hr:not(.top) { display: block; background: none; border: none; padding: 0; margin: 2em 0; height: auto; }
       .element dd,  .element dl { margin-top: 0em; margin-bottom: 0.25em;}
       dt { margin-top: 0.75em; margin-bottom: 0.5em; clear: left; }
        .element dt { margin-top: 0.5em; margin-bottom: 0.5em;  }
       dt + dt { margin-top: 0; }
       dd dt { margin-top: 0.25em; margin-bottom: 0; }
       dd p { margin-top: 0; }
       dd dl + p { margin-top: 1em; }
       dd table + p { margin-top: 1em; }
       p + * > li, dd li { margin: 1em 0; }
       dt, dfn { font-weight: bold; font-style: normal; }
       i, em { font-style: italic; }
       dt dfn { font-style: italic; }
       pre, code { font-size: inherit; font-family: monospace; font-variant: normal; }
       pre strong { color: black; font: inherit; font-weight: bold; background: yellow; }
       pre em { font-weight: bolder; font-style: normal; }
       @media screen { code { color: #D93B00; } code :link, code :visited { color: inherit; } }
       var { background-color: #f9f9f9; border: 1px solid #eee; padding: 0 2px; }
       var sub { vertical-align: bottom; font-size: smaller; position: relative; top: 0.1em; }
       table { border-collapse: collapse; border-style: hidden hidden none hidden; }
       table thead, table tbody { border-bottom: solid; }
       table tbody th:first-child { border-left: solid; }
       table tbody th { text-align: left; }
       table td, table th { border-left: solid; border-right: solid; border-bottom: solid thin; vertical-align: top; padding: 0.2em; }
       blockquote { margin: 0 0 0 2em; border: 0; padding: 0; font-style: italic; }

       .bad, .bad *:not(.XXX) { color: #5F6D7A; border-color: gray; background: transparent; }
       .matrix, .matrix td { border: none; text-align: right; }
       .matrix { margin-left: 2em; }
       .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
       .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
       .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

       .toc dfn, h1 dfn, h2 dfn, h3 dfn, h4 dfn, h5 dfn, h6 dfn { font: inherit; }
       img.extra, p.overview { float: right; }
       pre.idl { border: solid thin #d3d3d3; background: #FCFCFC; color: black; padding: 0.5em 1em; position: relative; }
       pre.idl :link, pre.idl :visited { color: inherit; background: transparent; }
       pre.idl::before { content: "IDL"; font: bold small sans-serif; padding: 0.5em; background: white; position: absolute; top: 0; margin: -1px 0 0 -4em; width: 1.5em; border: thin solid; border-radius: 0 0 0 0.5em }
       pre.css { border: solid thin; background: #FFFFEE; color: black; padding: 0.5em 1em; }
       pre.css:first-line { color: #AAAA50; }
       dl.domintro {padding: 0.5em 1em; border: none; background:#E9FBE9; border: 1px solid lightgray; }
       hr + dl.domintro, div.impl + dl.domintro { margin-top: 2.5em; margin-bottom: 1.5em; }
       dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
       dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
       dl.domintro dd p { margin: 0.5em 0; }
       dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This definition is non-normative. Implementation requirements are given below this definition.'; color: #606060; border:1px solid lightgray; background: white; padding: 0 0.25em;font-size:.9em;}
       dl.switch { padding-left: 2em; }
       dl.switch > dt { text-indent: -1.5em; }
       dl.switch > dt:before { content: '\21AA'; padding: 0 0.5em 0 0; display: inline-block; width: 1em; text-align: right; line-height: 0.5em; }
       dl.triple { padding: 0 0 0 1em; }
       dl.triple dt, dl.triple dd { margin: 0; display: inline }
       dl.triple dt:after { content: ':'; }
       dl.triple dd:after { content: '\A'; white-space: pre; }
       .diff-old { text-decoration: line-through; color: silver; background: transparent; }
       .diff-chg, .diff-new { text-decoration: underline; color: green; background: transparent; }
       a .diff-new { border-bottom: 1px blue solid; }

       figure.diagrams { border: double black; background: white; padding: 1em; }
       figure.diagrams img { display: block; margin: 1em auto; } 

       h2 { page-break-before: always; }
       h1, h2, h3, h4, h5, h6 { page-break-after: avoid; }
       h1 + h2, hr + h2.no-toc { page-break-before: auto; }

       p  > span:not([title=""]):not([class="XXX"]):not([class="impl"]):not([class="note"]):not([class="t2"]):not([id]):not([lang]),
       li > span:not([title=""]):not([class="XXX"]):not([class="impl"]):not([class="note"]):not([class="t2"]):not([id]):not([lang])
       { border-bottom: solid #9999CC; }

       div.head { margin: 0 0 1em; padding: 1em 0 0 0; }
       div.head p { margin: 0; }
       div.head h1 { margin: 0; }
       div.head .logo { float: right; margin: 0 1em; }
       div.head .logo img { border: none } /* remove border from top image */
       div.head dl { margin: 1em 0; }
       div.head p.copyright, div.head p.alt { font-size: x-small; font-style: oblique; margin: 0; }

       body > .toc > li { margin-top: 1em; margin-bottom: 1em; }
       body > .toc.brief > li { margin-top: 0.35em; margin-bottom: 0.35em; }
       body > .toc > li > * { margin-bottom: 0.5em; }
       body > .toc > li > * > li > * { margin-bottom: 0.25em; }
       .toc, .toc li { list-style: none; }

       .brief { margin-top: 1em; margin-bottom: 1em; line-height: 1.1; }
       .brief li { margin: 0; padding: 0; }
       .brief li p { margin: 0; padding: 0; }

       .category-list { margin-top: -0.75em; margin-bottom: 1em; line-height: 1.5; }
       .category-list::before { content: '\21D2\A0'; font-size: 1.2em; font-weight: 900; }
       .category-list li { display: inline; }
       .category-list li:not(:last-child)::after { content: ', '; }
       .category-list li > span, .category-list li > a { text-transform: lowercase; }
       .category-list li * { text-transform: none; } /* don't affect <code> nested in <a> */

       .XXX { color: #E50000; background: white; border: solid red; padding: 0.5em; margin: 1em 0; }
       .XXX > :first-child { margin-top: 0; }
       p .XXX { line-height: 3em; }
       .annotation { border: solid thin black; background: #0C479D; color: white; position: relative; margin: 8px 0 20px 0; }
       .annotation:before { position: absolute; left: 0; top: 0; width: 100%; height: 100%; margin: 6px -6px -6px 6px; background: #333333; z-index: -1; content: ''; }
       .annotation :link, .annotation :visited { color: inherit; }
       .annotation :link:hover, .annotation :visited:hover { background: transparent; }
       .annotation span { border: none ! important; }
       .note { border-left-style: solid; border-left-width: 0.25em; background: none repeat scroll 0 0 #E9FBE9; border-color: #52E052; }
       .warning { background-color: #F9F0D4; border: medium double #FF0000; margin: 1em; padding: 1em; }
       .note em, .warning em, .note i, .warning i { font-style: normal; }
       p.note, div.note { padding: 0.5em 2em; }
       span.note { padding: 0 2em; }
       .note p:first-child, .warning p:first-child { margin-top: 0; }
       .note p:last-child, .warning p:last-child { margin-bottom: 0; }
       .warning:before { font-style: normal; }
       p.note:before { content: 'Note: '; font-weight: bolder;}
       p.warning:before { content: '\26A0 Warning! '; font-weight:bolder;}
       .critical {margin:1em; border:double red; padding:1em; background-color:#F9F0D4;}

       .bookkeeping:before { display: block; content: 'Bookkeeping details'; font-weight: bolder; font-style: italic; }
       .bookkeeping { font-size: 0.8em; margin: 2em 0; }
       .bookkeeping p { margin: 0.5em 2em; display: list-item; list-style: square; }
       .bookkeeping dt { margin: 0.5em 2em 0; }
       .bookkeeping dd { margin: 0 3em 0.5em; }

       h4 { position: relative; z-index: 3; }
       h4 + .element, h4 + div + .element { margin-top: -2.5em; padding-top: 2em; }
       .element {
         background: #F4F4FA;
         color: black;
         margin: 0 0 1em 0.15em;
         padding: 0 1em 0.25em 0.75em;
         border-left: solid #9999FF 0.25em;
         position: relative;
         z-index: 1;
       }
       .element:before {
         position: absolute;
         z-index: 2;
         top: 0;
         left: -1.15em;
         height: 2em;
         width: 0.9em;
         background: #F4F4FA;
         content: ' ';
         border-style: none none solid solid;
         border-color: #9999FF;
         border-width: 0.25em;
       }

       .example { display: block; color: #222222; background: #FCFCFC; border-left-style: solid;border-color:#c0c0c0; border-left-width: 0.25em; margin-left: 1em; padding-left: 1em;padding-bottom: 0.5em;}
       div.example:before { content: 'Code Example: '; font-weight: bolder;}
       td > .example:only-child { margin: 0 0 0 0.1em; }

       ul.domTree, ul.domTree ul { padding: 0 0 0 1em; margin: 0; }
       ul.domTree li { padding: 0; margin: 0; list-style: none; position: relative; }
       ul.domTree li li { list-style: none; }
       ul.domTree li:first-child::before { position: absolute; top: 0; height: 0.6em; left: -0.75em; width: 0.5em; border-style: none none solid solid; content: ''; border-width: 0.1em; }
       ul.domTree li:not(:last-child)::after { position: absolute; top: 0; bottom: -0.6em; left: -0.75em; width: 0.5em; border-style: none none solid solid; content: ''; border-width: 0.1em; }
       ul.domTree span { font-style: italic; font-family: serif; }
       ul.domTree .t1 code { color: purple; font-weight: bold; }
       ul.domTree .t2 { font-style: normal; font-family: monospace; }
       ul.domTree .t2 .name { color: black; font-weight: bold; }
       ul.domTree .t2 .value { color: blue; font-weight: normal; }
       ul.domTree .t3 code, .domTree .t4 code, .domTree .t5 code { color: gray; }
       ul.domTree .t7 code, .domTree .t8 code { color: green; }
       ul.domTree .t10 code { color: teal; }

       body.dfnEnabled dfn { cursor: pointer; }
       .dfnPanel {
         display: inline;
         position: absolute;
         z-index: 10;
         height: auto;
         width: auto;
         padding: 0.5em 0.75em;
         font: small sans-serif, Droid Sans Fallback;
         background: #DDDDDD;
         color: black;
         border: outset 0.2em;
       }
       .dfnPanel * { margin: 0; padding: 0; font: inherit; text-indent: 0; }
       .dfnPanel :link, .dfnPanel :visited { color: black; }
       .dfnPanel p { font-weight: bolder; }
       .dfnPanel * + p { margin-top: 0.25em; }
       .dfnPanel li { list-style-position: inside; }

       #configUI { position: absolute; z-index: 20; top: 10em; right: 1em; width: 11em; font-size: small; }
       #configUI p { margin: 0.5em 0; padding: 0.3em; background: #EEEEEE; color: black; border: inset thin; }
       #configUI p label { display: block; }
       #configUI #updateUI, #configUI .loginUI { text-align: center; }
       #configUI input[type=button] { display: block; margin: auto; }

       fieldset { margin: 1em; padding: 0.5em 1em; }
       fieldset > legend + * { margin-top: 0; }
       fieldset > :last-child { margin-bottom: 0; }
       fieldset p { margin: 0.5em 0; }
       header p.subline {color:#005A9C; font: 140% sans-serif;margin: 0.75em 0;}
       #authorButton {overflow: visible; padding: 0.1em 0.3em; position: fixed; right: 2em; top: 6em; width: auto;}

       @media print {#authorButton { display:none;}}

   .stability {
     position: fixed;
     bottom: 0;
     left: 0; right: 0;
     margin: 0 auto 0 auto;
     width: 50%;
     background: maroon; color: yellow;
     -webkit-border-radius: 1em 1em 0 0;
     -moz-border-radius: 1em 1em 0 0;
     border-radius: 1em 1em 0 0;
     -moz-box-shadow: 0 0 1em #500;
     -webkit-box-shadow: 0 0 1em #500;
     box-shadow: 0 0 1em red;
     padding: 0.5em 1em;
     text-align: center;
   }
   .stability strong {
     display: block;
   }
   .stability input {
     -moz-appearance: none; -webkit-appearance: none; margin: 0; 
     border: 0; padding: 0.25em 0.5em; background: transparent; color: black;
     position: absolute; top: -0.5em; right: 0; font: 1.25em sans-serif; text-align: center;
   }
   .stability input:hover {
     color: white;
     text-shadow: 0 0 2px black;
   }
   .stability input:active {
     padding: 0.3em 0.45em 0.2em 0.55em;
   }
   .stability :link, .stability :visited,
   .stability :link:hover, .stability :visited:hover {
     background: transparent;
     color: white;
   }

  </style><!-- style switcher script by Stommepoes  --><link href="https://www.w3.org/StyleSheets/TR/W3C-REC" rel="stylesheet" type="text/css"><link href="https://www.w3.org/TR/2018/SPSD-html5-20180327/superseded.css" rel="stylesheet" type="text/css"><link href="switcher/author-view.css" id="author-view" rel="alternate stylesheet" title="Author documentation only"><script src="switcher/authorstylesheet.js"></script><link href="forms.html" rel="prev" title="4.10 Forms">
  <link href="Overview.html#contents" rel="contents" title="目次">
  <link href="common-idioms.html" rel="next" title="4.12 Common idioms without dedicated elements">
  <body class="split chapter" onload="fixBrokenLink();"><div class="head" id="head">
<header><span id="styleSwitch"></span>
   <p><a href="http://www.w3.org/"><img alt="W3C" height="48" src="http://www.w3.org/Icons/w3c_home" width="72"></a></p>

    <h1 id="big-title">HTML5日本語訳</h1>
    <p class="no-num no-toc subline">HTMLとXHTMLのための語彙と関連API</p>
   <h2 class="no-num no-toc" id="w3c-recommendation-28-october-2014">W3C Recommendation 28 October 2014</h2>
   </header></div>
  

  <nav class="prev_next">
   <a href="forms.html">← 4.10 フォーム</a> – <a href="Overview.html#contents">目次</a> – <a href="common-idioms.html">4.12 専用要素なしの一般的語彙 →</a>
  <ol class="toc"><li><ol><li><a href="scripting-1.html#scripting-1"><span class="secno">4.11</span> スクリプティング</a>
    <ol><li><a href="scripting-1.html#the-script-element"><span class="secno">4.11.1</span> <code>script</code>要素</a>
      <ol><li><a href="scripting-1.html#scriptingLanguages"><span class="secno">4.11.1.1</span> スクリプト言語</a></li><li><a href="scripting-1.html#restrictions-for-contents-of-script-elements"><span class="secno">4.11.1.2</span> <code>script</code>要素のコンテンツの制約</a></li><li><a href="scripting-1.html#inline-documentation-for-external-scripts"><span class="secno">4.11.1.3</span> 外部スクリプトに対するインライン文書</a></li><li><a href="scripting-1.html#scriptTagXSLT"><span class="secno">4.11.1.4 </span>Interaction of <code>script</code> elements and XSLT</a></li></ol></li><li><a href="scripting-1.html#the-noscript-element"><span class="secno">4.11.2</span> <code>noscript</code>要素</a></li><li><a href="scripting-1.html#the-template-element"><span class="secno">4.11.3 </span> <code>template</code>要素</a>
      <ol><li><a href="scripting-1.html#template-XSLT-XPath"><span class="secno">4.11.3.1 </span>Interaction of <code>template</code> elements with XSLT and XPath</a></li></ol></li><li><a href="scripting-1.html#the-canvas-element"><span class="secno">4.11.4</span> <code>canvas</code>要素</a>
      <ol><li><a href="scripting-1.html#color-spaces-and-color-correction"><span class="secno">4.11.4.1 </span>Color spaces and color correction</a></li><li><a href="scripting-1.html#serializing-bitmaps-to-a-file"><span class="secno">4.11.4.2 </span>ビットマップをファイルにシリアライズする</a></li><li><a href="scripting-1.html#security-with-canvas-elements"><span class="secno">4.11.4.3 </span>Security with <code>canvas</code> elements</a></li></ol></li></ol></li></ol></li></ol></nav>
<!-- warning -->
<style>
/* Put .annoying-warning in a red box fixed at the bottom of the
viewport. Adding INPUT and LABEL as below allows the box to be clicked
away, after which it will appear inline:

   <INPUT ID=annoying-warning TYPE=CHECKBOX TITLE="hide warning">
   <LABEL FOR=annoying-warning>(hide)</LABEL> <DIV
   CLASS=annoying-warning> <P><STRONG>Warning:</STRONG> Text of the
   warning...  </DIV>

*/

.annoying-warning {
    background: #fdd;
    color: red;
    font-weight: bold;
    padding: .75em 1em;
    border: solid red;
    border-radius: 1em;
    margin-top: 1.2em;
}
.annoying-warning :last-child {margin-bottom: 0}
.annoying-warning :first-child {margin-top: 0}
#annoying-warning, #annoying-warning + * {display: none}

@media screen {
    #annoying-warning:not(:checked) + * + * {position: fixed; z-index: 3;
	bottom: 2em; left: 1em; right: 1em; text-align: center;
	box-shadow: 0 2px 8px black; border-radius: 1em}
    #annoying-warning:not(:checked), #annoying-warning:not(:checked) + * {
	display: block; position: fixed; z-index: 4}
    #annoying-warning {font-size: 1em; bottom: 2.3em; right: 1.5em;
	margin: 0}
    #annoying-warning + * {font-size: 80%; bottom: 2.5em; right: 3.3em}
    html {margin-bottom: 15em}
}
</style>
<div> <input id=annoying-warning type=checkbox title="hide note"> <label for=annoying-warning>(隠す)</label> <div class=annoying-warning> <p>訳注: この文書はSuperseded Recommendationとして<strong>廃止</strong>された仕様です。この日本語訳は歴史的な意味しか持ちません。WHATWGによる最新の<a href="https://html.spec.whatwg.org/multipage/">HTML仕様</a>を参照ください。<p><a href="https://momdo.github.io/html/">WHATWG HTML日本語訳</a>も参照することができます。</div> </div>
<!-- /warning -->

  <h3 id="scripting-1"><span class="secno">4.11</span> スクリプティング</h3>

  <p>スクリプトは著者が文書に双方向性を追加することを許可する。</p>

  <p>著者は、宣言型のメカニズムがしばしばより保守しやすく、かつ多くのユーザーがスクリプトを無効としているため、可能であれば、スクリプトに宣言型の代替を使用するよう推奨される。</p>

  <p>著者はまた、スクリプトのサポートがない状態でそれらのアプリケーションが行儀よくデグレードするよう推奨される。</p>


  <h4 id="the-script-element"><span class="secno">4.11.1</span> <dfn id="script"><code>script</code></dfn>要素</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">カテゴリ</a>：</dt>
   <dd><a href="dom.html#metadata-content-0">メタデータコンテンツ</a>。</dd>
   <dd><a href="dom.html#flow-content-1">フローコンテンツ</a>。</dd>
   <dd><a href="dom.html#phrasing-content-1">フレージングコンテンツ</a>。</dd>
   <dd><a data-anolis-xref="script-supporting elements" href="dom.html#script-supporting-elements-0">スクリプトサポート要素</a>。</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">この要素を使用できるコンテキスト</a>：</dt>
   <dd><a href="dom.html#metadata-content-0">メタデータコンテンツ</a>が期待される場所。</dd>
   <dd><a href="dom.html#phrasing-content-1">フレージングコンテンツ</a>が期待される場所。</dd>
   <dd><a href="dom.html#script-supporting-elements-0">スクリプトサポート要素</a>が期待される場所。</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">コンテンツモデル</a>：</dt>
   <dd><code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code>属性が存在しない場合、<code data-anolis-xref="attr-script-type"><a href="#attr-script-type">type</a></code>属性の値に依存するが、<a href="#restrictions-for-contents-of-script-elements">スクリプトの内容制限</a>に一致しなければならない。</dd>
   <dd><code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code>属性が存在<em>する</em>場合、要素は空または<a href="#inline-documentation-for-external-scripts">スクリプト文書</a>を含むだけでなく<a href="#restrictions-for-contents-of-script-elements">スクリプトの内容制限</a>に一致するかのいずれかでなければならない。</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">コンテンツ属性</a>：</dt>
   <dd><a href="dom.html#global-attributes">グローバル属性</a></dd>
   <dd><code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code> - リソースのアドレス</dd>
   <dd><code data-anolis-xref="attr-script-type"><a href="#attr-script-type">type</a></code> — 埋め込みリソースタイプ</dd>
   <dd><code data-anolis-xref="attr-script-charset"><a href="#attr-script-charset">charset</a></code> - 外部スクリプトリソースの文字エンコーディング</dd>
   <dd><code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code> - 非同期的にスクリプトを実行する</dd>
   <dd><code data-anolis-xref="attr-script-defer"><a href="#attr-script-defer">defer</a></code> - スクリプトの実行を延期する</dd>
   <dd><code data-anolis-xref="attr-script-crossorigin"><a href="#attr-script-crossorigin">crossorigin</a></code> — 要素がcrossorigin要求を処理する方法</dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">text/htmlにおけるタグ省略</span>：</dt>
   <dd>どちらのタグも省略不可</dd>
   <dt>許可される<a href="dom.html#aria-role-attribute">ARIAロール属性</a>値：</dt>
   <dd>なし</dd>
   <dt>許可される<a href="dom.html#state-and-property-attributes">ARIAステートおよびプロパティー</a>：</dt>
   <dd><a href="dom.html#index-aria-global">グローバルaria-* 属性</a></dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOMインターフェース</a>：</dt><!--TOPIC:DOM APIs-->
   <dd>
<pre class="idl">interface <dfn id="htmlscriptelement">HTMLScriptElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
           attribute DOMString <a data-anolis-xref="dom-script-src" href="#dom-script-src">src</a>;
           attribute DOMString <a data-anolis-xref="dom-script-type" href="#dom-script-type">type</a>;
           attribute DOMString <a data-anolis-xref="dom-script-charset" href="#dom-script-charset">charset</a>;
           attribute boolean <a data-anolis-xref="dom-script-async" href="#dom-script-async">async</a>;
           attribute boolean <a data-anolis-xref="dom-script-defer" href="#dom-script-defer">defer</a>;
           attribute DOMString <a data-anolis-xref="dom-script-crossorigin" href="#dom-script-crossorigin">crossOrigin</a>;
           attribute DOMString <a data-anolis-xref="dom-script-text" href="#dom-script-text">text</a>;
};</pre>
   </dd>
  </dl><!--TOPIC:HTML--><p><code><a href="#the-script-element">script</a></code>要素は、著者が文書に動的スクリプトおよびデータブロックを含むことを許可する。この要素は、ユーザーにコンテンツを<a data-anolis-xref="represents" href="dom.html#represents">表す</a>ものでない。</p>

  <p>動的なスクリプトを含めるために使用される場合、スクリプトはインラインに埋め込むか、<code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code>属性を用いて外部ファイルからインポートすることのいずれかができる。言語が"<code data-anolis-xref="">text/javascript</code>"によって記述されない場合、後述するように<code data-anolis-xref="attr-script-type"><a href="#attr-script-type">type</a></code>属性は存在しなければならない。どのような言語を使用しても<code><a href="#the-script-element">script</a></code>要素の内容は、その言語の仕様の要求を遵守しなければならない。</p>

  <p>（スクリプトとは対照的に）データブロックを含むために使用される場合、データはインラインで埋め込まれなければならず、データのフォーマットは<code data-anolis-xref="attr-script-type"><a href="#attr-script-type">type</a></code>属性を使用して指定されなければならず、<code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code>属性を指定してはならず、<code><a href="#the-script-element">script</a></code>要素の内容は使用されるフォーマットのために定義された要件に準拠しなければならない。</p>

  <p><dfn data-anolis-xref="attr-script-type" id="attr-script-type"><code>type</code></dfn>属性は、スクリプトの言語またはデータの形式を提供する。属性が存在する場合、その値は<a href="infrastructure.html#valid-mime-type">妥当なMIMEタイプ</a>でなければならない。<code data-anolis-xref="">charset</code>パラメータを指定してはならない。属性が存在しない場合に使用されるデフォルトは、"<code data-anolis-xref="">text/javascript</code>"である。</p>

  <p>指定される場合、<dfn data-anolis-xref="attr-script-src" id="attr-script-src"><code>src</code></dfn>属性は使用する外部スクリプトのリソースのアドレスを渡す。属性が存在する場合、属性値は、<code data-anolis-xref="attr-script-type"><a href="#attr-script-type">type</a></code>属性によって与えられる型に属するスクリプトリソースを識別する<a href="infrastructure.html#valid-non-empty-url-potentially-surrounded-by-spaces">潜在的に空白で囲まれた妥当な空でないURL</a>でなければならず、属性が存在しない場合、"<code data-anolis-xref="">text/javascript</code>"型でなければならない。スクリプト言語を識別し、かつリソースがその言語の仕様の要求に適合する場合、リソースは、指定される型のスクリプトリソースである。</p>

  <p><dfn data-anolis-xref="attr-script-charset" id="attr-script-charset"><code>charset</code></dfn>属性は、外部スクリプトリソースの文字エンコーディングを与える。<code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code>属性が存在しない場合、この属性は指定されてはならない。属性が設定される場合、その値は<a href="infrastructure.html#encoding">エンコーディング</a>の<a data-anolis-xref="encoding
  label" href="infrastructure.html#encoding-label">ラベル</a>と<a href="infrastructure.html#ascii-case-insensitive">ASCII大文字・小文字不区別</a>で一致しなければならず、かつもしあれば、外部ファイルの<a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">Content-Typeメタデータ</a>の<code data-anolis-xref="">charset</code>パラメータと同じ<a href="infrastructure.html#encoding">エンコーディング</a>を指定しなければならない。<a href="references.html#refsENCODING">[ENCODING]</a></p>

  <p><dfn data-anolis-xref="attr-script-async" id="attr-script-async"><code>async</code></dfn>および<dfn data-anolis-xref="attr-script-defer" id="attr-script-defer"><code>defer</code></dfn>属性は、どのようにスクリプトを実行すべきかを指示する<a data-anolis-xref="boolean
  attribute" href="infrastructure.html#boolean-attribute">真偽属性</a>である。<code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code>属性が存在しない場合、<code data-anolis-xref="attr-script-defer"><a href="#attr-script-defer">defer</a></code>および<code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code>属性は指定されてはならない。</p>

  <p>これらの属性を使用して選択することができる3つの考えられるモードが存在する。<code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code>属性が存在する場合、利用可能になるとすぐに、スクリプトは非同期的に実行されるだろう。<code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code>が存在しないものの<code data-anolis-xref="attr-script-defer"><a href="#attr-script-defer">defer</a></code>属性が存在する場合、ページが解析完了する際にスクリプトは実行される。どちらの属性も存在しない場合、ユーザーエージェントがページの解析を続ける前に、スクリプトは直ちにフェッチされて実行される。</p>

  <p class="note">これら属性の正確な処理の詳細は、主に歴史的な理由から、いくぶん自明でない、多くのHTMLの側面を含む。したがって、実装要求は必然的に仕様のあらゆる場所に散在している。（この節の）下記のアルゴリズムは、この処理の中核を説明するが、これらのアルゴリズムが参照する、およびHTMLにおける<code><a href="#the-script-element">script</a></code>の<a href="syntax.html#scriptTag">開始</a>タグと<a href="syntax.html#scriptEndTag">終了</a>タグに対する構文解析規則、<a href="syntax.html#scriptForeignEndTag">無関係なコンテンツで</a>、<a href="the-xhtml-syntax.html#scriptTagXML">XMLで</a>、<code data-anolis-xref="dom-document-write"><a href="webappapis.html#dom-document-write">document.write()</a></code>メソッドに対する規則、<a href="webappapis.html#scripting">スクリプト</a>の取り扱いなどによって参照される。</p>

  <p>たとえ<code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code>属性が指定されても、デフォルトである同期ブロッキング動作の代わりに<code data-anolis-xref="attr-script-defer"><a href="#attr-script-defer">defer</a></code>の動作をフォールバックするために、<code data-anolis-xref="attr-script-defer"><a href="#attr-script-defer">defer</a></code>のみをサポートする（かつ<code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code>をサポートしない）レガシーウェブブラウザをもたらすため、<code data-anolis-xref="attr-script-defer"><a href="#attr-script-defer">defer</a></code>属性は指定されてもよい。</p>

  <p><dfn data-anolis-xref="attr-script-crossorigin" id="attr-script-crossorigin"><code>crossorigin</code></dfn>属性は<a href="infrastructure.html#cors-settings-attribute">CORS設定属性</a>である。他の<a data-anolis-xref="origin" href="browsers.html#origin-0">生成元</a>から取得されたスクリプトに対して、エラー情報を公開するかどうかを制御する。</p>

  <p><code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code>、<code data-anolis-xref="attr-script-type"><a href="#attr-script-type">type</a></code>、<code data-anolis-xref="attr-script-charset"><a href="#attr-script-charset">charset</a></code>、<code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code>、<code data-anolis-xref="attr-script-defer"><a href="#attr-script-defer">defer</a></code>、および<code data-anolis-xref="attr-script-crossorigin"><a href="#attr-script-crossorigin">crossorigin</a></code>属性の動的な変更は直接何も影響しない。これらの属性は下記に説明する特定時に使用される。</p><!-- by implication, changes
  to the base URL also have no effect --> 

  <div class="impl">

  <p>A <code><a href="#the-script-element">script</a></code> element has several associated pieces of state.</p>

  <p>The first is a flag indicating whether or not the script block has been <dfn id="already-started">"already
  started"</dfn>. Initially, <code><a href="#the-script-element">script</a></code> elements must have this flag unset (script blocks,
  when created, are not "already started"). The <a data-anolis-xref="concept-node-clone-ext" href="infrastructure.html#concept-node-clone-ext">cloning
  steps</a> for <code><a href="#the-script-element">script</a></code> elements must set the "already started" flag on the copy if
  it is set on the element being cloned.</p>

  <p>The second is a flag indicating whether the element was <dfn id="parser-inserted">"parser-inserted"</dfn>.
  Initially, <code><a href="#the-script-element">script</a></code> elements must have this flag unset. It is set by the <a href="syntax.html#html-parser">HTML
  parser</a> and the <a href="the-xhtml-syntax.html#xml-parser">XML parser</a> on <code><a href="#the-script-element">script</a></code> elements they insert and
  affects the processing of those elements.</p>

  <p>The third is a flag indicating whether the element will <dfn id="force-async">"force-async"</dfn>. Initially,
  <code><a href="#the-script-element">script</a></code> elements must have this flag set. It is unset by the <a href="syntax.html#html-parser">HTML parser</a>
  and the <a href="the-xhtml-syntax.html#xml-parser">XML parser</a> on <code><a href="#the-script-element">script</a></code> elements they insert. In addition, whenever
  a <code><a href="#the-script-element">script</a></code> element whose <a href="#force-async">"force-async"</a> flag is set has a <code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code> content attribute added, the element's
  <a href="#force-async">"force-async"</a> flag must be unset.</p><!-- there's no need to unset it when the
  attribute is removed since you can't have the attribute and the flag set at once. --> 

  <p>The fourth is a flag indicating whether or not the script block is <dfn id="ready-to-be-parser-executed">"ready to be
  parser-executed"</dfn>. Initially, <code><a href="#the-script-element">script</a></code> elements must have this flag unset (script
  blocks, when created, are not "ready to be parser-executed"). This flag is used only for elements
  that are also <a href="#parser-inserted">"parser-inserted"</a>, to let the parser know when to execute the
  script.</p>

  <p>The last few pieces of state are <dfn id="the-script-block's-type"><var>the script block's type</var></dfn>, <dfn id="the-script-block's-character-encoding"><var>the
  script block's character encoding</var></dfn>, and <dfn id="the-script-block's-fallback-character-encoding"><var>the script block's fallback character
  encoding</var></dfn>. They are determined when the script is prepared, based on the attributes on
  the element at that time, and the <code><a href="dom.html#document">Document</a></code> of the <code><a href="#the-script-element">script</a></code> element.</p>

  <p>When a <code><a href="#the-script-element">script</a></code> element that is not marked as being <a href="#parser-inserted">"parser-inserted"</a>
  experiences one of the events listed in the following list, the user agent must synchronously
  <a data-anolis-xref="prepare a script" href="#prepare-a-script">prepare</a> the <code><a href="#the-script-element">script</a></code> element:</p>

  <ul><li>The <code><a href="#the-script-element">script</a></code> element gets <a data-anolis-xref="insert an element into a document" href="infrastructure.html#insert-an-element-into-a-document">inserted
   into a document</a>, at the time the <a data-anolis-xref="nodes are inserted" href="infrastructure.html#nodes-are-inserted">node is inserted</a>
   according to the DOM, after any other <code><a href="#the-script-element">script</a></code> elements inserted at the same time that
   are earlier in the <code><a href="dom.html#document">Document</a></code> in <a href="infrastructure.html#tree-order">tree order</a>.</li>

   <li>The <code><a href="#the-script-element">script</a></code> element is <a href="infrastructure.html#in-a-document">in a <code>Document</code></a> and a node or
   document fragment is <a data-anolis-xref="nodes are inserted" href="infrastructure.html#nodes-are-inserted">inserted</a> into the
   <code><a href="#the-script-element">script</a></code> element, after any <code><a href="#the-script-element">script</a></code> elements <a data-anolis-xref="nodes are
   inserted" href="infrastructure.html#nodes-are-inserted">inserted</a> at that time.</li>

   <li>The <code><a href="#the-script-element">script</a></code> element is <a href="infrastructure.html#in-a-document">in a <code>Document</code></a> and has a <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code> attribute set where previously the element had no such
   attribute.</li>

  </ul><p>To <dfn data-anolis-xref="prepare a script" id="prepare-a-script">prepare a script</dfn>, the user agent must act as
  follows:</p>

  <ol><li>

    <p>If the <code><a href="#the-script-element">script</a></code> element is marked as having <a href="#already-started">"already started"</a>, then
    the user agent must abort these steps at this point. The script is not executed.</p>

   </li>

   <li>

    <p>If the element has its <a href="#parser-inserted">"parser-inserted"</a> flag set, then set <var data-anolis-xref="">was-parser-inserted</var> to true and unset the element's
    <a href="#parser-inserted">"parser-inserted"</a> flag. Otherwise, set <var data-anolis-xref="">was-parser-inserted</var> to
    false.</p>

    <p class="note">This is done so that if parser-inserted <code><a href="#the-script-element">script</a></code> elements fail to run
    when the parser tries to run them, e.g. because they are empty or specify an unsupported
    scripting language, another script can later mutate them and cause them to run again.</p><!-- q.v. http://hsivonen.iki.fi/test/moz/script-setting-src-on-parser-inserted-script.html -->

    

   </li>

   <li>

    <p>If <var data-anolis-xref="">was-parser-inserted</var> is true and the element does not have an <code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code> attribute, then set the element's
    <a href="#force-async">"force-async"</a> flag to true.</p>

    <p class="note">This is done so that if a parser-inserted <code><a href="#the-script-element">script</a></code> element fails to
    run when the parser tries to run it, but it is later executed after a script dynamically updates
    it, it will execute asynchronously even if the <code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code>
    attribute isn't set.</p>

   </li>

   <li id="script-processing-empty">

    <p>If the element has no <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code> attribute, and its child
    nodes, if any, consist only of comment nodes and empty <code><a href="infrastructure.html#text-0">Text</a></code> nodes, then the user
    agent must abort these steps at this point. The script is not executed.</p>

   </li>

   <li>

    <p>If the element is not <a href="infrastructure.html#in-a-document">in a <code>Document</code></a>, then the user agent must abort
    these steps at this point. The script is not executed.</p>

   </li>

   <li id="script-processing-prepare">

    <p>If either:</p>

    <ul class="brief"><li>the <code><a href="#the-script-element">script</a></code> element has a <code data-anolis-xref="attr-script-type"><a href="#attr-script-type">type</a></code> attribute
     and its value is the empty string, or</li>

     <li>the <code><a href="#the-script-element">script</a></code> element has no <code data-anolis-xref="attr-script-type"><a href="#attr-script-type">type</a></code> attribute
     but it has a <code data-anolis-xref="attr-script-language"><a href="obsolete.html#attr-script-language">language</a></code> attribute and <em>that</em>
     attribute's value is the empty string, or</li>

     <li>the <code><a href="#the-script-element">script</a></code> element has neither a <code data-anolis-xref="attr-script-type"><a href="#attr-script-type">type</a></code>
     attribute nor a <code data-anolis-xref="attr-script-language"><a href="obsolete.html#attr-script-language">language</a></code> attribute, then</li>

    </ul><p>...let <var><a href="#the-script-block's-type">the script block's type</a></var> for this <code><a href="#the-script-element">script</a></code> element be "<code data-anolis-xref="">text/javascript</code>".</p>

    <p>Otherwise, if the <code><a href="#the-script-element">script</a></code> element has a <code data-anolis-xref="attr-script-type"><a href="#attr-script-type">type</a></code> attribute, let <var><a href="#the-script-block's-type">the script block's type</a></var> for this
    <code><a href="#the-script-element">script</a></code> element be the value of that attribute with any leading or trailing
    sequences of <a data-anolis-xref="space character" href="infrastructure.html#space-character">space characters</a> removed.</p><!-- <span>Strip
    leading and trailing whitespace</span> from... --> 

    <p>Otherwise, the element has a non-empty <code data-anolis-xref="attr-script-language"><a href="obsolete.html#attr-script-language">language</a></code>
    attribute; let <var><a href="#the-script-block's-type">the script block's type</a></var> for this <code><a href="#the-script-element">script</a></code> element be the
    concatenation of the string "<code data-anolis-xref="">text/</code>" followed by the value of the <code data-anolis-xref="attr-script-language"><a href="obsolete.html#attr-script-language">language</a></code> attribute.</p><!-- user agents already support,
    e.g., type="text/javascript1.3", so we don't have to support that separately. --> 

    <p class="note">The <code data-anolis-xref="attr-script-language"><a href="obsolete.html#attr-script-language">language</a></code> attribute is never
    conforming, and is always ignored if there is a <code data-anolis-xref="attr-script-type"><a href="#attr-script-type">type</a></code>
    attribute present.</p>

   </li>

   <li>

    <p>If the user agent does not <a href="#support-the-scripting-language">support the scripting language</a> given by <var><a href="#the-script-block's-type">the
    script block's type</a></var> for this <code><a href="#the-script-element">script</a></code> element, then the user agent must abort
    these steps at this point. The script is not executed.</p>

   </li>

   <li>

    <p>If <var data-anolis-xref="">was-parser-inserted</var> is true, then flag the element as
    <a href="#parser-inserted">"parser-inserted"</a> again, and set the element's <a href="#force-async">"force-async"</a> flag to
    false.</p>

   </li>

   <li id="script-processing-start">

    <p>The user agent must set the element's <a href="#already-started">"already started"</a> flag.</p>

    <p class="note">The state of the element at this moment <a href="#establish-script-block-source">is later used</a> to determine the script source.</p>

   </li>

   <li>

    <p>If the element is flagged as <a href="#parser-inserted">"parser-inserted"</a>, but the element's
    <code><a href="dom.html#document">Document</a></code> is not the <code><a href="dom.html#document">Document</a></code> of the parser that created the element,
    then abort these steps.</p>

   </li>

   <li id="script-processing-noscript">

    <p>If <a data-anolis-xref="concept-n-noscript" href="webappapis.html#concept-n-noscript">scripting is disabled</a> for the <code><a href="#the-script-element">script</a></code>
    element, then the user agent must abort these steps at this point. The script is not
    executed.</p>

    <p class="note">The definition of <a data-anolis-xref="concept-n-noscript" href="webappapis.html#concept-n-noscript">scripting is disabled</a>
    means that, amongst others, the following scripts will not execute: scripts in
    <code><a href="infrastructure.html#xmlhttprequest">XMLHttpRequest</a></code>'s <code data-anolis-xref="dom-XMLHttpRequest-responseXML">responseXML</code>
    documents, scripts in <code>DOMParser</code>-created documents, scripts in documents created by
    <code>XSLTProcessor</code>'s <code data-anolis-xref="dom-XSLTProcessor-transformToDocument">transformToDocument</code> feature, and scripts
    that are first inserted by a script into a <code><a href="dom.html#document">Document</a></code> that was created using the
    <code data-anolis-xref="dom-DOMImplementation-createDocument"><a href="infrastructure.html#dom-domimplementation-createdocument">createDocument()</a></code> API. <a href="references.html#refsXHR">[XHR]</a> <a href="references.html#refsDOMPARSING">[DOMPARSING]</a> <!--<a
    href="#refsXSLTP">[XSLTP]</a>--> <a href="references.html#refsDOM">[DOM]</a></p>


   </li>

   <li id="script-processing-for">

    <p>If the <code><a href="#the-script-element">script</a></code> element has an <code data-anolis-xref="attr-script-event"><a href="obsolete.html#attr-script-event">event</a></code>
    attribute and a <code data-anolis-xref="attr-script-for"><a href="obsolete.html#attr-script-for">for</a></code> attribute, then run these substeps:</p>

    <ol><li><p>Let <var data-anolis-xref="">for</var> be the value of the <code data-anolis-xref="attr-script-for"><a href="obsolete.html#attr-script-for">for</a></code>
     attribute.</li>

     <li><p>Let <var data-anolis-xref="">event</var> be the value of the <code data-anolis-xref="attr-script-event"><a href="obsolete.html#attr-script-event">event</a></code> attribute.</li>

     <li><p><a href="infrastructure.html#strip-leading-and-trailing-whitespace">Strip leading and trailing whitespace</a> from <var data-anolis-xref="">event</var> and
     <var data-anolis-xref="">for</var>.</li>

     <li><p>If <var data-anolis-xref="">for</var> is not an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match for the
     string "<code data-anolis-xref="">window</code>", then the user agent must abort these steps at this
     point. The script is not executed.</li>

     <li><p>If <var data-anolis-xref="">event</var> is not an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match for
     either the string "<code data-anolis-xref="">onload</code>" or the string "<code data-anolis-xref="">onload()</code>", then the user agent must abort these steps at this point. The script
     is not executed.</li>

    </ol></li>

   <li id="script-processing-encoding">

    <p>If the <code><a href="#the-script-element">script</a></code> element has a <code data-anolis-xref="attr-script-charset"><a href="#attr-script-charset">charset</a></code>
    attribute, then let <var><a href="#the-script-block's-character-encoding">the script block's character encoding</a></var> for this
    <code><a href="#the-script-element">script</a></code> element be the result of <a href="infrastructure.html#getting-an-encoding">getting an encoding</a> from the value of
    the <code data-anolis-xref="attr-script-charset"><a href="#attr-script-charset">charset</a></code> attribute.</p>

    <p>Otherwise, let <var><a href="#the-script-block's-fallback-character-encoding">the script block's fallback character encoding</a></var> for this
    <code><a href="#the-script-element">script</a></code> element be the same as <a data-anolis-xref="document's character encoding" href="infrastructure.html#document's-character-encoding">the
    encoding of the document itself</a>.</p>

    <p class="note">Only one of these two pieces of state is set.</p>

   </li>

   <li id="script-processing-src-prepare">

    <p>If the element has a <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code> content attribute, run these
    substeps:</p>

    <ol><li><p>Let <var data-anolis-xref="">src</var> be the value of the element's <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code> attribute.</li>

     <li><p>If <var data-anolis-xref="">src</var> is the empty string, <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire
     a simple event</a> named <code data-anolis-xref="event-error">error</code> at the element, and abort
     these steps.</li>

     <li><p><a data-anolis-xref="resolve a url" href="infrastructure.html#resolve-a-url">Resolve</a> <var data-anolis-xref="">src</var> relative to the
     element.</li>

     <li><p>If the previous step failed, <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple
     event</a> named <code data-anolis-xref="event-error">error</code> at the element, and abort these
     steps.</li>

     <li><!--CLEANUP-->


      <p>Do a <a href="infrastructure.html#potentially-cors-enabled-fetch">potentially CORS-enabled fetch</a><!--FETCH-->  of the resulting
      <a href="infrastructure.html#absolute-url">absolute URL</a>, with the <i>mode</i> being the current state of the element's <code data-anolis-xref="attr-script-crossorigin"><a href="#attr-script-crossorigin">crossorigin</a></code> content attribute, the <i data-anolis-xref="">origin</i> being the <a href="browsers.html#origin-0">origin</a> of the <code><a href="#the-script-element">script</a></code> element's
      <code><a href="dom.html#document">Document</a></code>, and the <i>default origin behaviour</i> set to <i>taint</i>.</p>

      <p>The resource obtained in this fashion can be either <a href="infrastructure.html#cors-same-origin">CORS-same-origin</a> or
      <a href="infrastructure.html#cors-cross-origin">CORS-cross-origin</a>. This only affects how error reporting happens.</p>

      <p>For performance reasons, user agents may start fetching the script (as defined above) as
      soon as the <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code> attribute is set, instead, in the hope
      that the element will be inserted into the document (and that the <code data-anolis-xref="attr-script-crossorigin"><a href="#attr-script-crossorigin">crossorigin</a></code> attribute won't change value in the
      meantime). Either way, once the element is <a data-anolis-xref="insert an element into a
      document" href="infrastructure.html#insert-an-element-into-a-document">inserted into the document</a>, the load must have started as described in this
      step. If the UA performs such prefetching, but the element is never inserted in the document,
      or the <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code> attribute is dynamically changed,<!-- or the
      base URL is dynamically changed,-->  or the <code data-anolis-xref="attr-script-crossorigin"><a href="#attr-script-crossorigin">crossorigin</a></code> attribute is dynamically changed, then the
      user agent will not execute the script so obtained, and the fetching process will have been
      effectively wasted.</p>

     </li>

    </ol></li><!-- at this point if the element is "parser-inserted" then we know it is not "force-async". -->

   

   <li>

    <p>Then, the first of the following options that describes the situation must be followed:</p>

    <dl class="switch"><dt id="script-processing-defer">If the element has a <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code>
     attribute, and the element has a <code data-anolis-xref="attr-script-defer"><a href="#attr-script-defer">defer</a></code> attribute, and
     the element has been flagged as <a href="#parser-inserted">"parser-inserted"</a>, and the element does not have
     an <code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code> attribute</dt>

     <dd>

      <p>The element must be added to the end of the <dfn id="list-of-scripts-that-will-execute-when-the-document-has-finished-parsing">list of scripts that will execute when the
      document has finished parsing</dfn> associated with the <code><a href="dom.html#document">Document</a></code> of the parser
      that created the element.</p>

      <p>The <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that the <a href="webappapis.html#networking-task-source">networking task source</a>
      places on the <a href="webappapis.html#task-queue">task queue</a> once the <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching algorithm</a>
      has completed must set the element's <a href="#ready-to-be-parser-executed">"ready to be parser-executed"</a> flag. The
      parser will handle executing the script.</p>

     </dd>


     <dt id="script-processing-parser-inserted">If the element has a <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code> attribute, and the element has been flagged as
     <a href="#parser-inserted">"parser-inserted"</a>, and the element does not have an <code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code> attribute</dt>

     <dd>

      <p>The element is the <a href="#pending-parsing-blocking-script">pending parsing-blocking script</a> of the
      <code><a href="dom.html#document">Document</a></code> of the parser that created the element. (There can only be one such
      script per <code><a href="dom.html#document">Document</a></code> at a time.)</p>

      <p>The <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that the <a href="webappapis.html#networking-task-source">networking task source</a>
      places on the <a href="webappapis.html#task-queue">task queue</a> once the <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching algorithm</a>
      has completed must set the element's <a href="#ready-to-be-parser-executed">"ready to be parser-executed"</a> flag. The
      parser will handle executing the script.</p>

     </dd>


     <dt id="script-processing-style-delayed">If the element does not have a <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code> attribute, and the element has been flagged as
     <a href="#parser-inserted">"parser-inserted"</a>, and either the parser that created the <code><a href="#the-script-element">script</a></code> is
     an <a href="the-xhtml-syntax.html#xml-parser">XML parser</a> or it's an <a href="syntax.html#html-parser">HTML parser</a> whose <a href="syntax.html#script-nesting-level">script nesting
     level</a> is not greater than one, and the <code><a href="dom.html#document">Document</a></code> of the <a href="syntax.html#html-parser">HTML
     parser</a> or <a href="the-xhtml-syntax.html#xml-parser">XML parser</a> that created the <code><a href="#the-script-element">script</a></code> element <a href="document-metadata.html#has-a-style-sheet-that-is-blocking-scripts">has
     a style sheet that is blocking scripts</a></dt>

     <dd>

      <p>The element is the <a href="#pending-parsing-blocking-script">pending parsing-blocking script</a> of the
      <code><a href="dom.html#document">Document</a></code> of the parser that created the element. (There can only be one such
      script per <code><a href="dom.html#document">Document</a></code> at a time.)</p>

      <p>Set the element's <a href="#ready-to-be-parser-executed">"ready to be parser-executed"</a> flag. The parser will handle
      executing the script.</p>

     </dd>


     <dt id="script-processing-src-sync">If the element has a <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code> attribute, does not have an <code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code> attribute, and does not have the
     <a href="#force-async">"force-async"</a> flag set</dt>

     <dd>

      <p>The element must be added to the end of the <dfn id="list-of-scripts-that-will-execute-in-order-as-soon-as-possible">list of scripts that will execute in order
      as soon as possible</dfn> associated with the <code><a href="dom.html#document">Document</a></code> of the <code><a href="#the-script-element">script</a></code>
      element at the time the <a href="#prepare-a-script">prepare a script</a> algorithm started.</p>

      <p>The <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that the <a href="webappapis.html#networking-task-source">networking task source</a>
      places on the <a href="webappapis.html#task-queue">task queue</a> once the <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching algorithm</a>
      has completed must run the following steps:</p>

      <ol><li><p>If the element is not now the first element in the <a href="#list-of-scripts-that-will-execute-in-order-as-soon-as-possible">list of scripts that will
       execute in order as soon as possible</a> to which it was added above, then mark the
       element as ready but abort these steps without executing the script yet.</li>

       <li><p><i>Execution</i>: <a href="#execute-the-script-block">Execute the script block</a> corresponding to the first
       script element in this <a href="#list-of-scripts-that-will-execute-in-order-as-soon-as-possible">list of scripts that will execute in order as soon as
       possible</a>.</li>

       <li><p>Remove the first element from this <a href="#list-of-scripts-that-will-execute-in-order-as-soon-as-possible">list of scripts that will execute in order as
       soon as possible</a>.</li>

       <li><p>If this <a href="#list-of-scripts-that-will-execute-in-order-as-soon-as-possible">list of scripts that will execute in order as soon as possible</a> is
       still not empty and the first entry has already been marked as ready, then jump back to the
       step labeled <i>execution</i>.</li>

      </ol></dd>


     <dt id="script-processing-src">If the element has a <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code>
     attribute</dt>

     <dd>

      <p>The element must be added to the <dfn id="set-of-scripts-that-will-execute-as-soon-as-possible">set of scripts that will execute as soon as
      possible</dfn> of the <code><a href="dom.html#document">Document</a></code> of the <code><a href="#the-script-element">script</a></code> element at the time the
      <a href="#prepare-a-script">prepare a script</a> algorithm started.</p>

      <p>The <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that the <a href="webappapis.html#networking-task-source">networking task source</a>
      places on the <a href="webappapis.html#task-queue">task queue</a> once the <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching algorithm</a>
      has completed must <a href="#execute-the-script-block">execute the script block</a> and then remove the element from the
      <a href="#set-of-scripts-that-will-execute-as-soon-as-possible">set of scripts that will execute as soon as possible</a>.</p>

     </dd>


     <dt id="script-processing-inline">そうでなければ</dt>

     <dd>The user agent must immediately <a href="#execute-the-script-block">execute the script block</a>, even if other
     scripts are already executing.</dd>

    </dl></li>

  </ol><!-- similar text in various places --><p>Fetching an external script must <a href="syntax.html#delay-the-load-event">delay the load event</a> of the element's document
  until the <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that is <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a>
  by the <a href="webappapis.html#networking-task-source">networking task source</a> once the resource has been <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> (defined above) has been run.</p>

  <p>The <dfn id="pending-parsing-blocking-script">pending parsing-blocking script</dfn> of a <code><a href="dom.html#document">Document</a></code> is used by the
  <code><a href="dom.html#document">Document</a></code>'s parser(s).</p>

  <p class="note">If a <code><a href="#the-script-element">script</a></code> element that blocks a parser gets moved to another
  <code><a href="dom.html#document">Document</a></code> before it would normally have stopped blocking that parser, it nonetheless
  continues blocking that parser until the condition that causes it to be blocking the parser no
  longer applies (e.g. if the script is a <a href="#pending-parsing-blocking-script">pending parsing-blocking script</a> because there
  was <a href="document-metadata.html#a-style-sheet-that-is-blocking-scripts">a style sheet that is blocking scripts</a> when it was parsed, but then the script is
  moved to another <code><a href="dom.html#document">Document</a></code> before the style sheet loads, the script still blocks the
  parser until the style sheets are all loaded, at which time the script executes and the parser is
  unblocked).</p><!-- also (and this would be worth testing): the way the spec is written, if you do not have a
  style sheet that is blocking scripts, then you parse a <script src>, then while waiting for the
  script to load you insert an external style sheet, the script will delay until the sheet is
  loaded, because there's just a binary "are style sheets blocking scripts" state, things aren't
  defined in terms of which style sheets are blocking which scripts -->

  

  <p>When the user agent is required to <dfn data-anolis-xref="execute the script block" id="execute-the-script-block">execute a script
  block</dfn>, it must run the following steps:</p>

  <ol><li>

    <p>If the element is flagged as <a href="#parser-inserted">"parser-inserted"</a>, but the element's
    <code><a href="dom.html#document">Document</a></code> is not the <code><a href="dom.html#document">Document</a></code> of the parser that created the element,
    then abort these steps.</p>

   </li>

   <li>

    <p>Jump to the appropriate set of steps from the list below:</p>

    <dl class="switch"><dt>If the load resulted in an error (for example a DNS error, or an HTTP 404 error)</dt>

     <dd><p>Executing the script block must just consist of <a data-anolis-xref="fire a simple event" href="webappapis.html#fire-a-simple-event">firing
     a simple event</a> named <code data-anolis-xref="event-error">error</code> at the element.</dd>

     <dt>If the load was successful</dt><!-- SCRIPT EXEC -->

     
     <dd>

      <p>Executing the script block must consist of running the following steps. For the purposes of
      these steps, the script is considered to be from an <i>external file</i> if, while the
      <a href="#prepare-a-script">prepare a script</a> algorithm above was running for this script, the
      <code><a href="#the-script-element">script</a></code> element had a <code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code> attribute
      specified.</p>

      <ol><li id="establish-script-block-source">

        <p>Initialize <dfn id="the-script-block's-source"><var>the script block's source</var></dfn> as follows:</p>

        <dl class="switch"><dt>If the script is from an external file and <var><a href="#the-script-block's-type">the script block's type</a></var> is a
         text-based language</dt>

         <dd>

          <p>The contents of that file, interpreted as a Unicode string, are the script source.</p>

          <p>To obtain the Unicode string, the user agent run the following steps:</p>

          <ol><li><p>If the resource's <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">Content Type metadata</a>, if any,
           specifies a character encoding, and the user agent supports that encoding, then let <var data-anolis-xref="">character encoding</var> be that encoding, and jump to the bottom step in this
           series of steps.</li>

           <li><p>If the algorithm above set <var><a href="#the-script-block's-character-encoding">the script block's character encoding</a></var>, then
           let <var data-anolis-xref="">character encoding</var> be that encoding, and jump to the bottom step
           in this series of steps.</li>

           <li><p>Let <var data-anolis-xref="">character encoding</var> be <var><a href="#the-script-block's-fallback-character-encoding">the script block's fallback
           character encoding</a></var>.</li>

           <li>

            <p>If the specification for <var><a href="#the-script-block's-type">the script block's type</a></var> gives specific rules for
            decoding files in that format to Unicode, follow them, using <var>character
            encoding</var> as the character encoding specified by higher-level protocols, if
            necessary.</p><!-- e.g. XML --> 

            <p>Otherwise, <a href="infrastructure.html#decode">decode</a> the file to Unicode, using <var>character
            encoding</var> as the fallback encoding.</p>

            <p class="note">The <a href="infrastructure.html#decode">decode</a> algorithm overrides <var>character
            encoding</var> if the file contains a BOM.</p>

           </li>

          </ol></dd>

         <dt>If the script is from an external file and <var><a href="#the-script-block's-type">the script block's type</a></var> is an
         XML-based language</dt>

         <dd>

          <p>The external file is the script source. When it is later executed, it must be
          interpreted in a manner consistent with the specification defining the language given by
          <var><a href="#the-script-block's-type">the script block's type</a></var>.</p>

         </dd>

         <dt>If the script is inline and <var><a href="#the-script-block's-type">the script block's type</a></var> is a text-based
         language</dt>

         <dd>

          <p>The value of the <code data-anolis-xref="dom-script-text"><a href="#dom-script-text">text</a></code> IDL attribute at the time
          the element's <a href="#already-started">"already started"</a> flag was last set is the script source.</p>

         </dd>

         <dt>If the script is inline and <var><a href="#the-script-block's-type">the script block's type</a></var> is an XML-based
         language</dt>

         <dd>

          <p>The child nodes of the <code><a href="#the-script-element">script</a></code> element at the time the element's
          <a href="#already-started">"already started"</a> flag was last set are the script source.</p>

         </dd>

        </dl></li>

       <li>

        <p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> named <code data-anolis-xref="event-beforescriptexecute">beforescriptexecute</code> that bubbles and is cancelable
        at the <code><a href="#the-script-element">script</a></code> element.</p>

        <p>If the event is canceled, then abort these steps.</p>

       </li>

       <li>

        <p>If the script is from an external file, then increment the
        <a href="webappapis.html#ignore-destructive-writes-counter">ignore-destructive-writes counter</a> of the <code><a href="#the-script-element">script</a></code> element's
        <code><a href="dom.html#document">Document</a></code>. Let <var data-anolis-xref="">neutralized doc</var> be that
        <code><a href="dom.html#document">Document</a></code>.</p>

       </li>

       <li><!--CLEANUP-->


        <p><a href="webappapis.html#create-a-script">Create a script</a>, using <var><a href="#the-script-block's-source">the script block's source</a></var>, the
        <span>URL</span> from which the script was obtained, <var><a href="#the-script-block's-type">the script block's
        type</a></var> as the scripting language, and the <a href="webappapis.html#script-settings-object">script settings object</a> of the <code><a href="#the-script-element">script</a></code> element's
        <code><a href="dom.html#document">Document</a></code>'s <code><a href="browsers.html#window">Window</a></code> object.</p><!--CLEANUP-->


        <p>If the script came from a resource that was <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> in the
        steps above, and the resource was <a href="infrastructure.html#cors-cross-origin">CORS-cross-origin</a>, then pass the <var data-anolis-xref="">muted errors</var> flag to the <a href="webappapis.html#create-a-script">create a script</a>
        algorithm as well.</p>

        <p class="note">This is where the script is compiled and actually executed.</p>

       </li>

       <li>

        <p>Decrement the <a href="webappapis.html#ignore-destructive-writes-counter">ignore-destructive-writes counter</a> of <var data-anolis-xref="">neutralized
        doc</var>, if it was incremented in the earlier step.</p>

       </li>

       <li>

        <p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> named <code data-anolis-xref="event-afterscriptexecute">afterscriptexecute</code> that bubbles (but is not
        cancelable) at the <code><a href="#the-script-element">script</a></code> element.</p>

       </li>

       <li>

        <p>If the script is from an external file, <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-load">load</code> at the <code><a href="#the-script-element">script</a></code> element.</p>

        <p>Otherwise, the script is internal; <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple
        event</a> named <code data-anolis-xref="event-load">load</code> at the <code><a href="#the-script-element">script</a></code>
        element.</p>

       </li>

      </ol></dd>

    </dl></li>

  </ol><p>The IDL attributes <dfn data-anolis-xref="dom-script-src" id="dom-script-src"><code>src</code></dfn>, <dfn data-anolis-xref="dom-script-type" id="dom-script-type"><code>type</code></dfn>, <dfn data-anolis-xref="dom-script-charset" id="dom-script-charset"><code>charset</code></dfn>, <dfn data-anolis-xref="dom-script-defer" id="dom-script-defer"><code>defer</code></dfn>, each must <a href="infrastructure.html#reflect">reflect</a> the respective
  content attributes of the same name.</p>

  <p>The <dfn data-anolis-xref="dom-script-crossOrigin" id="dom-script-crossorigin"><code>crossOrigin</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-script-crossorigin"><a href="#attr-script-crossorigin">crossorigin</a></code> content
  attribute, <a href="infrastructure.html#limited-to-only-known-values">limited to only known values</a>.</p>

  <p>The <dfn data-anolis-xref="dom-script-async" id="dom-script-async"><code>async</code></dfn> IDL attribute controls whether the
  element will execute asynchronously or not. If the element's <a href="#force-async">"force-async"</a> flag is
  set, then, on getting, the <code data-anolis-xref="dom-script-async"><a href="#dom-script-async">async</a></code> IDL attribute must return
  true, and on setting, the <a href="#force-async">"force-async"</a> flag must first be unset, and then the
  content attribute must be removed if the IDL attribute's new value is false, and must be set to
  the empty string if the IDL attribute's new value is true. If the element's
  <a href="#force-async">"force-async"</a> flag is <em>not</em> set, the IDL attribute must <a href="infrastructure.html#reflect">reflect</a>
  the <code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code> content attribute.</p>

  </div><!--TOPIC:DOM APIs-->


  <dl class="domintro"><dt><var data-anolis-xref="">script</var> . <code data-anolis-xref="dom-script-text"><a href="#dom-script-text">text</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p><code><a href="infrastructure.html#text-0">Text</a></code>ノードでない子ノードを無視して、要素の内容を返す。</p>

    <p>与えられた値を持つ要素の子を置換するために、設定できる。</p>

   </dd>

  </dl><div class="impl">

  <p>The IDL attribute <dfn data-anolis-xref="dom-script-text" id="dom-script-text"><code>text</code></dfn> must return a
  concatenation of the contents of all the <code><a href="infrastructure.html#text-0">Text</a></code> nodes that are children of the
  <code><a href="#the-script-element">script</a></code> element (ignoring any other nodes such as comments or elements), in tree
  order. On setting, it must act the same way as the <code><a href="infrastructure.html#textcontent">textContent</a></code> IDL attribute.</p>

  </div><!--TOPIC:HTML-->


  <p class="note"><code data-anolis-xref="dom-document-write"><a href="webappapis.html#dom-document-write">document.write()</a></code>メソッドを用いて挿入される場合、<code><a href="#the-script-element">script</a></code>要素は（一般に同期して）実行するが、<code data-anolis-xref="dom-innerHTML"><a href="infrastructure.html#dom-innerhtml">innerHTML</a></code>および<code data-anolis-xref="dom-outerHTML"><a href="infrastructure.html#dom-outerhtml">outerHTML</a></code>属性を用いて挿入される場合、これらは一切実行しない。</p>

  <div class="example">

   <p>次の例において、2つの<code><a href="#the-script-element">script</a></code>要素が使用される。1つは外部スクリプトに埋め込み、もう1つはデータを含む。</p>

   <pre>&lt;script src="game-engine.js"&gt;&lt;/script&gt;
&lt;script type="text/x-game-map"&gt;
........U.........e
o............A....e
.....A.....AAA....e
.A..AAA...AAAAA...e
&lt;/script&gt;</pre>

   <p>この場合のデータは、ビデオゲームのマップを生成するスクリプトによって使用されるかもしれない。しかし、データはそのように使用する必要はない。おそらく実際にマップデータは、ページのマークアップの他の部分に埋め込まれており、ここでデータブロックは、ゲームマップで特定の機能を探しているユーザーを支援するサイトの検索エンジンによって単に使用される。</p>

  </div>

  <div class="example">

   <p>次のサンプルは、どのようにスクリプト要素が文書の他の部分で使用される関数を定義するために使用することができるかを示す。また、フォームの出力を初期化する場合に、文書が解析されている間に<code><a href="#the-script-element">script</a></code>要素がスクリプトを呼び出すために使用されうる方法を示す。</p>

   <pre>&lt;script&gt;
 function calculate(form) {
   var price = 52000;
   if (form.elements.brakes.checked)
     price += 1000;
   if (form.elements.radio.checked)
     price += 2500;
   if (form.elements.turbo.checked)
     price += 5000;
   if (form.elements.sticker.checked)
     price += 250;
   form.elements.result.value = price;
 }
&lt;/script&gt;
&lt;form name="pricecalc" onsubmit="return false" onchange="calculate(this)"&gt;
 &lt;fieldset&gt;
  &lt;legend&gt;Work out the price of your car&lt;/legend&gt;
  &lt;p&gt;Base cost: £52000.&lt;/p&gt;
  &lt;p&gt;Select additional options:&lt;/p&gt;
  &lt;ul&gt;
   &lt;li&gt;&lt;label&gt;&lt;input type=checkbox name=brakes&gt; Ceramic brakes (£1000)&lt;/label&gt;&lt;/li&gt;
   &lt;li&gt;&lt;label&gt;&lt;input type=checkbox name=radio&gt; Satellite radio (£2500)&lt;/label&gt;&lt;/li&gt;
   &lt;li&gt;&lt;label&gt;&lt;input type=checkbox name=turbo&gt; Turbo charger (£5000)&lt;/label&gt;&lt;/li&gt;
   &lt;li&gt;&lt;label&gt;&lt;input type=checkbox name=sticker&gt; "XZ" sticker (£250)&lt;/label&gt;&lt;/li&gt;
  &lt;/ul&gt;
  &lt;p&gt;Total: £&lt;output name=result&gt;&lt;/output&gt;&lt;/p&gt;
 &lt;/fieldset&gt;
 &lt;script&gt;
  calculate(document.forms.pricecalc);
 &lt;/script&gt;
&lt;/form&gt;</pre>

  </div>



  <h5 id="scriptingLanguages"><span class="secno">4.11.1.1</span> スクリプト言語</h5>

  <div class="impl">

  <p>A user agent is said to <dfn id="support-the-scripting-language">support the scripting language</dfn> if each component of <var><a href="#the-script-block's-type">the
  script block's type</a></var> is an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match for the corresponding
  component in the <a href="infrastructure.html#mime-type">MIME type</a> string of a scripting language that the user agent
  implements.</p>

  </div>

  <p>以下の表は、ユーザーエージェントが認識しなければならない<a href="infrastructure.html#mime-type">MIMEタイプ</a>文字列および参照する言語である：</p>

  <dl><dt>"<code>application/ecmascript</code>"</dt>
   <dt>"<code>application/javascript</code>"</dt>
   <dt>"<code>application/x-ecmascript</code>"</dt>
   <dt>"<code>application/x-javascript</code>"</dt>
   <dt>"<code>text/ecmascript</code>"</dt>
   <dt>"<code>text/javascript</code>"</dt>
   <dt>"<code>text/javascript1.0</code>"</dt>
   <dt>"<code>text/javascript1.1</code>"</dt>
   <dt>"<code>text/javascript1.2</code>"</dt>
   <dt>"<code>text/javascript1.3</code>"</dt>
   <dt>"<code>text/javascript1.4</code>"</dt>
   <dt>"<code>text/javascript1.5</code>"</dt>
   <dt>"<code>text/jscript</code>"</dt>
   <dt>"<code>text/livescript</code>"</dt>
   <dt>"<code>text/x-ecmascript</code>"</dt>
   <dt>"<code>text/x-javascript</code>"</dt>
   <dd>JavaScript。<a href="references.html#refsECMA262">[ECMA262]</a></dd><!--(historical footnote)
   <dt>"<code>text/javascript;e4x=1</code>"</dt>
   <dd>JavaScript with ECMAScript for XML. <a href="#refsECMA357">[ECMA357]</a></dd>
-->



  </dl><div class="impl">

  <p>User agents may support other <a data-anolis-xref="MIME type" href="infrastructure.html#mime-type">MIME types</a> for other languages,
  but must not support other <a data-anolis-xref="MIME type" href="infrastructure.html#mime-type">MIME types</a> for the languages in the list
  above. User agents are not required to support the languages listed above.</p>

  <p>The following <a data-anolis-xref="MIME type" href="infrastructure.html#mime-type">MIME types</a> (with or without parameters) must not
  be interpreted as scripting languages:</p>

  <ul class="brief"><li>"<code>text/plain</code>"
   
   </li><li>"<code>text/xml</code>"
   
   <!--<li>"<code>text/html</code>"-->
   </li><li>"<code>application/octet-stream</code>"
   
   </li><li>"<code>application/xml</code>"
   
   <!--<li>"<code>application/xhtml+xml</code>"--><!--<li>"<code>image/svg+xml</code>"--><!-- the commented-out ones aren't listed here because they couldn't sanely be interpreted as a
   scripting language anyway: they're defined to be something else. I just don't want this to
   devolve into a list of every non-scripting type in existence. -->
   

   

  </li></ul><p class="note">These types are explicitly listed here because they are poorly-defined types that
  are nonetheless likely to be used as formats for data blocks, and it would be problematic if they
  were suddenly to be interpreted as script by a user agent.</p><!-- a similar paragraph is also present in the <style> section -->

  

  <p>When examining types to determine if they represent supported languages, user agents must not
  ignore MIME parameters. Types are to be compared including all parameters.</p><!-- whether the
  order of parameters matters is left undefined until such time as it matters; so far the only
  relevant parameter was 'e4x', and it's gone for now --> 

  <p class="note">For example, types that include the <code data-anolis-xref="">charset</code> parameter will
  not be recognized as referencing any of the scripting languages listed above.</p>

  </div>


  <h5 id="restrictions-for-contents-of-script-elements"><span class="secno">4.11.1.2</span> <dfn data-anolis-xref="script content restrictions" id="script-content-restrictions"><code>script</code>要素のコンテンツの制約</dfn></h5><!--CLEANUP-->


  <p class="note">この節で説明される多少奇妙な制約を回避する最も簡単で安全な方法は、以下のシーケンスが（たとえば文字列、正規表現、またはコメントなど）スクリプト内でリテラルに表示され、かつ式の中でこのような構造体を使用してコードを記述を避けるようにする際に、"<code data-anolis-xref="">&lt;!--</code>"を"<code data-anolis-xref="">&lt;\!--</code>"として、"<code data-anolis-xref="">&lt;script</code>"を"<code data-anolis-xref="">&lt;\script</code>"として、および"<code data-anolis-xref="">&lt;/script</code>"を"<code data-anolis-xref="">&lt;\/script</code>"として常にエスケープすることである。この節の制限がトリガーになりやすい落とし穴を回避する：すなわち、歴史的な理由のために、HTMLにおける<code><a href="#the-script-element">script</a></code>ブロックの解析は、これらのシーケンスを考えた場合に直観的でない働きをする奇妙で風変わりな慣習である。</p>

  <p><code><a href="#the-script-element">script</a></code>要素の<code><a href="infrastructure.html#textcontent">textContent</a></code>は、Unicodeである文字セットである、以下のABNFで<code data-anolis-xref="">script</code>生成物と対等でなければならない。<a href="references.html#refsABNF">[ABNF]</a></p>

  <pre>script        = outer *( comment-open inner comment-close outer )

outer         = &lt; any string that doesn't contain a substring that matches not-in-outer &gt;
not-in-outer  = comment-open
inner         = &lt; any string that doesn't contain a substring that matches not-in-inner &gt;
not-in-inner  = comment-close / script-open

comment-open  = "&lt;!--"
comment-close = "--&gt;"
script-open   = "&lt;" s c r i p t tag-end

s             =  %x0053 ; U+0053 LATIN CAPITAL LETTER S
s             =/ %x0073 ; U+0073 LATIN SMALL LETTER S
c             =  %x0043 ; U+0043 LATIN CAPITAL LETTER C
c             =/ %x0063 ; U+0063 LATIN SMALL LETTER C
r             =  %x0052 ; U+0052 LATIN CAPITAL LETTER R
r             =/ %x0072 ; U+0072 LATIN SMALL LETTER R
i             =  %x0049 ; U+0049 LATIN CAPITAL LETTER I
i             =/ %x0069 ; U+0069 LATIN SMALL LETTER I
p             =  %x0050 ; U+0050 LATIN CAPITAL LETTER P
p             =/ %x0070 ; U+0070 LATIN SMALL LETTER P
t             =  %x0054 ; U+0054 LATIN CAPITAL LETTER T
t             =/ %x0074 ; U+0074 LATIN SMALL LETTER T

tag-end       =  %x0009 ; "tab" (U+0009)
tag-end       =/ %x000A ; "LF" (U+000A)
tag-end       =/ %x000C ; "FF" (U+000C)
tag-end       =/ %x0020 ; U+0020 SPACE
tag-end       =/ %x002F ; "/" (U+002F)
tag-end       =/ %x003E ; "&gt;" (U+003E)</pre>

  <p><code><a href="#the-script-element">script</a></code>要素が<a href="#inline-documentation-for-external-scripts">スクリプト文書</a>を含む場合、以下の節で記述されるように、要素のコンテンツのさらなる制約がある。</p>

  <div class="example">

   <p>以下のスクリプトは、この問題を示している。このように、文字列が含まれているスクリプトがあるとする：</p>

   <pre>var example = 'Consider this string: &lt;!-- &lt;script&gt;';
console.log(example);</pre>

   <p>これが<code><a href="#the-script-element">script</a></code>ブロックで直接この文字列を入れていた場合、上記の制限に違反しない。</p>

   <pre>&lt;script&gt;
  var example = 'Consider this string: &lt;!-- &lt;script&gt;';
  console.log(example);
&lt;/script&gt;</pre>

   <p>しかし、より大きな問題かつ、スクリプトがそれらの制限に違反しない理由は、実際にスクリプトが奇妙に解析されるだろうということである。<em>上記のスクリプトブロックは終了していない</em>。それは、実際には依然として<code><a href="#the-script-element">script</a></code>ブロックの一部であるこのスニペットにおいて"<code data-anolis-xref="">&lt;/script&gt;</code>"終了タグのように見えるものである。（スクリプトが終了していないため）スクリプトは実行しない。スクリプトが何らかの形で実行した場合、以下のようにマークアップが見えた場合、（ここで強調される）スクリプトが妥当なJavaScriptでないので、スクリプトは失敗するだろう：</p>

   <pre>&lt;script&gt;<mark>
  var example = 'Consider this string: &lt;!-- &lt;script&gt;';
  console.log(example);
&lt;/script&gt;
&lt;!-- despite appearances, this is actually part of the script still! --&gt;
&lt;script&gt;
 ... // this is the same script block still...
</mark>&lt;/script&gt;</pre>

   <p>ここで起こっていることはレガシーな理由のために、HTMLにおける<code><a href="#the-script-element">script</a></code>要素で"<code data-anolis-xref="">&lt;!--</code>"および "<code data-anolis-xref="">&lt;script</code>"文字列は、パーサがブロックを閉じる検討するためにバランスをとる必要がある。</p>

   <p>この節の最初に述べたように、問題の文字列をエスケープすることによって、問題は完全に回避されている： </p>

   <pre>&lt;script&gt;<mark>
  var example = 'Consider this string: &lt;\!-- &lt;\script&gt;';
  console.log(example);
</mark>&lt;/script&gt;
&lt;!-- this is just a comment between script blocks --&gt;
&lt;script&gt;<mark>
 ... // this is a new script block
</mark>&lt;/script&gt;</pre>

   <p>次の例のように、これらのシーケンスは自然にスクリプト式で出現可能である：</p>

   <pre>if (x&lt;!--y) { ... }
if ( player&lt;script ) { ... }</pre>

   <p>このような場合、文字はエスケープすることはできないが、シーケンスが発生しないように式は次のように書き換えることができる：</p>

   <pre>if (x &lt; !--y) { ... }
if (!--y &gt; x) { ... }
if (!(--y) &gt; x) { ... }
if (player &lt; script) { ... }
if (script &gt; player) { ... }</pre>

   <p>これを行うとはまた、同様に様々な落とし穴を回避する：関連する歴史的な理由のために、JavaScriptで文字列"&lt;!--"は、"//"のように、実際には行コメントの開始として扱われる。</p>

  </div>


  <h5 id="inline-documentation-for-external-scripts"><span class="secno">4.11.1.3</span> <dfn data-anolis-xref="script documentation" id="script-documentation">外部スクリプトに対するインライン文書</dfn></h5>

  <p><code><a href="#the-script-element">script</a></code>要素の<code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code>属性が指定される場合、もしあれば、<code><a href="#the-script-element">script</a></code>要素のコンテンツは、要素のコンテンツから分割されるような<code data-anolis-xref="dom-script-text"><a href="#dom-script-text">text</a></code>IDL属性値でなければならず、文字セットがUnicodeである下記のABNFで<code data-anolis-xref="">documentation</code>生成物と一致しなければならない。<a href="references.html#refsABNF">[ABNF]</a></p>

  <pre>documentation = *( *( space / tab / comment ) [ line-comment ] newline )
comment       = slash star *( not-star / star not-slash ) 1*star slash
line-comment  = slash slash *not-newline

; characters
tab           = %x0009 ; "tab" (U+0009)
newline       = %x000A ; "LF" (U+000A)
space         = %x0020 ; U+0020 SPACE
star          = %x002A ; "*" (U+002A)
slash         = %x002F ; "/" (U+002F)
not-newline   = %x0000-0009 / %x000B-10FFFF
                ; a <a href="infrastructure.html#unicode-character">Unicode character</a> other than "LF" (U+000A)
not-star      = %x0000-0029 / %x002B-10FFFF
                ; a <a href="infrastructure.html#unicode-character">Unicode character</a> other than "*" (U+002A)
not-slash     = %x0000-002E / %x0030-10FFFF
                ; a <a href="infrastructure.html#unicode-character">Unicode character</a> other than "/" (U+002F)</pre>

  <p class="note">これは、JavaScriptのコメントで要素のコンテンツを設置するものと一致する。</p>

  <p class="note">この要求は、<code><a href="#the-script-element">script</a></code>要素のコンテンツの構文上に先の制約に加えて存在する。</p>

  <div class="example">

   <p>以下は、依然として外部スクリプトファイルを参照する間に文書内で、著者がライセンス情報やAPI情報のような文書を含むことを許可する。<code data-anolis-xref="attr-script-src"><a href="#attr-script-src">src</a></code>属性を提供する一方で、偶然にも著者が有効なスクリプトのように見えるものが含まないように、構文は制約される。</p>

   <pre>&lt;script src="cool-effects.js"&gt;
 // create new instances using:
 //    var e = new Effect();
 // start the effect using .play, stop using .stop:
 //    e.play();
 //    e.stop();
&lt;/script&gt;</pre>

  </div>


  <div class="impl">

  <h5 id="scriptTagXSLT"><span class="secno">4.11.1.4 </span>Interaction of <code><a href="#the-script-element">script</a></code> elements and XSLT</h5>

  <p><i>この節は非規範的である。</i></p>
  <p>This specification does not define how XSLT interacts with the <code><a href="#the-script-element">script</a></code> element.
  However, in the absence of another specification actually defining this, here are some guidelines
  for implementors, based on existing implementations:</p>

  <ul><li><p>When an XSLT transformation program is triggered by an <code data-anolis-xref=""><?xml-stylesheet?></code> processing instruction and the browser implements a
   direct-to-DOM transformation, <code><a href="#the-script-element">script</a></code> elements created by the XSLT processor need to
   be marked <a href="#parser-inserted">"parser-inserted"</a> and run in document order (modulo scripts marked <code data-anolis-xref="attr-script-defer"><a href="#attr-script-defer">defer</a></code> or <code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code>),
   asynchronously while the transformation is occurring.</li>

   <li><p>The <code data-anolis-xref="dom-XSLTProcessor-transformToDocument">XSLTProcessor.transformToDocument()</code> method
   adds elements to a <code><a href="dom.html#document">Document</a></code> that is not in a <a href="browsers.html#browsing-context">browsing context</a>, and,
   accordingly, any <code><a href="#the-script-element">script</a></code> elements they create need to have their <a href="#already-started">"already
   started"</a> flag set in the <a href="#prepare-a-script">prepare a script</a> algorithm and never get executed
   (<a data-anolis-xref="concept-bc-noscript" href="webappapis.html#concept-bc-noscript">scripting is disabled</a>). Such <code><a href="#the-script-element">script</a></code>
   elements still need to be marked <a href="#parser-inserted">"parser-inserted"</a>, though, such that their <code data-anolis-xref="dom-script-async"><a href="#dom-script-async">async</a></code> IDL attribute will return false in the absence of an <code data-anolis-xref="attr-script-async"><a href="#attr-script-async">async</a></code> content attribute.</li>

   <li><p>The <code data-anolis-xref="dom-XSLTProcessor-transformToFragment">XSLTProcessor.transformToFragment()</code> method
   needs to create a fragment that is equivalent to one built manually by creating the elements
   using <code data-anolis-xref="dom-document-createElementNS"><a href="infrastructure.html#dom-document-createelementns">document.createElementNS()</a></code>. For instance,
   it needs to create <code><a href="#the-script-element">script</a></code> elements that aren't <a href="#parser-inserted">"parser-inserted"</a> and
   that don't have their <a href="#already-started">"already started"</a> flag set, so that they will execute when the
   fragment is inserted into a document.</li>

  </ul><p>The main distinction between the first two cases and the last case is that the first two
  operate on <code><a href="dom.html#document">Document</a></code>s and the last operates on a fragment.</p>

  </div>



  <h4 id="the-noscript-element"><span class="secno">4.11.2</span> <dfn><code>noscript</code></dfn>要素</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">カテゴリ</a>：</dt>
   <dd><a href="dom.html#metadata-content-0">メタデータコンテンツ</a>。</dd>
   <dd><a href="dom.html#flow-content-1">フローコンテンツ</a>。</dd>
   <dd><a href="dom.html#phrasing-content-1">フレージングコンテンツ</a>。</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">この要素を使用できるコンテキスト</a>：</dt>
   <dd>先祖<code><a href="#the-noscript-element">noscript</a></code>要素が存在しない場合、<a data-anolis-xref="HTML documents" href="infrastructure.html#html-documents">HTML文書</a>の<code><a href="document-metadata.html#the-head-element">head</a></code>要素内。</dd>
   <dd>先祖<code><a href="#the-noscript-element">noscript</a></code>要素が存在しない場合、<a href="infrastructure.html#html-documents">HTML文書</a>で<a href="dom.html#phrasing-content-1">フレージングコンテンツ</a>が期待される場所。</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">コンテンツモデル</a>：</dt>
   <dd><a data-anolis-xref="concept-n-noscript" href="webappapis.html#concept-n-noscript">スクリプトが無効</a>の場合、<code><a href="document-metadata.html#the-head-element">head</a></code>要素内で：任意の順で、0個以上の<code><a href="document-metadata.html#the-link-element">link</a></code>要素、ゼロ個以上の<code><a href="document-metadata.html#the-style-element">style</a></code>要素、0個以上の<code><a href="document-metadata.html#the-meta-element">meta</a></code>要素。</dd>
   <dd><a data-anolis-xref="concept-n-noscript" href="webappapis.html#concept-n-noscript">スクリプトが無効</a>の場合、<code><a href="document-metadata.html#the-head-element">head</a></code>要素外で：<a href="dom.html#transparent">透過的</a>。ただし、<code><a href="#the-noscript-element">noscript</a></code>要素の子孫を持ってはならない。</dd>
   <dd>そうでなければ：文で与えられる要件に適合するテキスト。</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">コンテンツ属性</a>：</dt>
   <dd><a href="dom.html#global-attributes">グローバル属性</a></dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">text/htmlにおけるタグ省略</span>：</dt>
   <dd>どちらのタグも省略不可</dd>
   <dt>許可される<a href="dom.html#aria-role-attribute">ARIAロール属性</a>値：</dt>
   <dd>なし</dd>
   <dt>許可される<a href="dom.html#state-and-property-attributes">ARIAステートおよびプロパティー</a>：</dt>
   <dd><a href="dom.html#index-aria-global">グローバルaria-* 属性</a></dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOMインターフェース</a>：</dt><!--TOPIC:DOM APIs-->
   <dd><code><a href="dom.html#htmlelement">HTMLElement</a></code>を使用する。</dd>
  </dl><!--TOPIC:HTML--><p><code><a href="#the-noscript-element">noscript</a></code>要素は、<a data-anolis-xref="concept-n-script" href="webappapis.html#concept-n-script">スクリプトが有効である</a>場合は何も<a href="dom.html#represents">表さ</a>ず、<a data-anolis-xref="concept-n-noscript" href="webappapis.html#concept-n-noscript">スクリプトが無効である</a>場合は要素の子を<a href="dom.html#represents">表す</a>。これは、文書が解析される方法に影響を与えることによって、スクリプトをサポートするユーザーエージェントとサポートしないユーザーエージェントに異なるマークアップを提示するために使用される。</p>

  <p><a href="infrastructure.html#html-documents">HTML文書</a>で使用する場合、許可されるコンテンツモデルは次のとおり：</p>

  <dl class="auth"><dt><a data-anolis-xref="concept-n-noscript" href="webappapis.html#concept-n-noscript">スクリプトが無効である</a>場合、<code><a href="document-metadata.html#the-head-element">head</a></code>要素内の<code><a href="#the-noscript-element">noscript</a></code>要素に対して</dt>

   <dd><p><code><a href="#the-noscript-element">noscript</a></code>要素は、<code><a href="document-metadata.html#the-link-element">link</a></code>、<code><a href="document-metadata.html#the-style-element">style</a></code>、および<code><a href="document-metadata.html#the-meta-element">meta</a></code>要素のみを含まなければならない。</dd>

   <dt><a data-anolis-xref="concept-n-script" href="webappapis.html#concept-n-script">スクリプトが有効である</a>場合、<code><a href="document-metadata.html#the-head-element">head</a></code>要素内の<code><a href="#the-noscript-element">noscript</a></code>要素に対して</dt>

   <dd><p><code><a href="#the-noscript-element">noscript</a></code>要素がテキストのみを含まなければならない。ただし<a href="syntax.html#html-fragment-parsing-algorithm">HTML断片解析アルゴリズム</a>を発動する場合を除く <!-- (which disables <script> execution) -->  with
   the <code><a href="#the-noscript-element">noscript</a></code> element as the <var data-anolis-xref="concept-frag-parse-context"><a href="syntax.html#concept-frag-parse-context">context</a></var>
   element and the text contents as the <var data-anolis-xref="">input</var> must result in a list of nodes
   that consists only of <code><a href="document-metadata.html#the-link-element">link</a></code>, <code><a href="document-metadata.html#the-style-element">style</a></code>, and <code><a href="document-metadata.html#the-meta-element">meta</a></code> elements that
   would be conforming if they were children of the <code><a href="#the-noscript-element">noscript</a></code> element, and no <a data-anolis-xref="parse error" href="syntax.html#parse-error">parse errors</a>.</dd>

   <dt><a data-anolis-xref="concept-n-noscript" href="webappapis.html#concept-n-noscript">スクリプトが無効である</a>場合、<code><a href="document-metadata.html#the-head-element">head</a></code>要素外の<code><a href="#the-noscript-element">noscript</a></code>要素に対して</dt>

   <dd><p><code><a href="#the-noscript-element">noscript</a></code>要素のコンテンツモデルは<a href="dom.html#transparent">透過的</a>であり、同時に<code><a href="#the-noscript-element">noscript</a></code>要素が<code><a href="#the-noscript-element">noscript</a></code>要素を持ってはならない（<code><a href="#the-noscript-element">noscript</a></code>要素を入れ子にできない）追加制限がある。</dd>

   <dt><a data-anolis-xref="concept-n-script" href="webappapis.html#concept-n-script">スクリプトが有効である</a>場合、<code><a href="document-metadata.html#the-head-element">head</a></code>要素外の<code><a href="#the-noscript-element">noscript</a></code>要素に対して</dt>

   <dd>

    <p><code><a href="#the-noscript-element">noscript</a></code>要素はテキストのみを含まなければならない。ただしテキストは、以下のアルゴリズムが<code><a href="#the-noscript-element">noscript</a></code>要素および<code><a href="#the-script-element">script</a></code>要素をもたない適合文書をもたらすものでなければならず、アルゴリズムでステップは<a href="syntax.html#html-parser">HTMLパーサ</a>に<a href="syntax.html#parse-error">解析エラー</a>を起こさないようにしなければならない：</p>

    <ol><li>文書からすべての<code><a href="#the-script-element">script</a></code>要素を取り除く。</li>

     <li>文書においてすべての<code><a href="#the-noscript-element">noscript</a></code>要素のリストを作る。そのリストの各<code><a href="#the-noscript-element">noscript</a></code>要素に対して、以下のステップを実行する：

      <ol><li><code><a href="#the-noscript-element">noscript</a></code>要素の親要素を<var data-anolis-xref="">parent element</var>とする</li>

       <li><code><a href="#the-noscript-element">noscript</a></code>要素の前に来る<var data-anolis-xref="">parent element</var>のすべての子を取得し、これらの要素を<var data-anolis-xref="">the before children</var>と呼ぶ。</li>

       <li><code><a href="#the-noscript-element">noscript</a></code>要素の<em>後</em>に来る<var data-anolis-xref="">parent element</var>のすべての子を取得し、これらの要素を<var data-anolis-xref="">the after children</var>と呼ぶ。</li>

       <li><code><a href="#the-noscript-element">noscript</a></code>要素に属する全<code><a href="infrastructure.html#text-0">Text</a></code>子ノードの連鎖を<var data-anolis-xref="">s</var>とする。</li>

       <li><var data-anolis-xref="">parent element</var>の<code data-anolis-xref="dom-innerHTML"><a href="infrastructure.html#dom-innerhtml">innerHTML</a></code>属性を<var data-anolis-xref="">s</var>の値に設定する。（これは、副作用として<code><a href="#the-noscript-element">noscript</a></code>要素を文書から除去させる）</li>

       <li>オリジナルの関係順序を保持したまま、<var data-anolis-xref="">parent element</var>のはじめに<var data-anolis-xref="">the before children</var>を挿入する。</li>

       <li>オリジナルの関係順序を保持したまま、<var data-anolis-xref="">parent element</var>のおわりに<var data-anolis-xref="">the after children</var>を挿入する。</li>

      </ol></li>

    </ol></dd>

  </dl><p class="note">歴史的な理由により、パーサが呼び出されたときに<a data-anolis-xref="scripting flag" href="syntax.html#scripting-flag">スクリプトが有効にされたかどうか</a>に基づく<a href="syntax.html#html-parser">HTMLパーサ</a>によって<code><a href="#the-noscript-element">noscript</a></code>要素が異なる方法で処理されるので、これらのすべてのこじつけが必要とされる。</p>

  <p><code><a href="#the-noscript-element">noscript</a></code>は<a href="infrastructure.html#xml-documents">XML文書</a>で使用してはならない。</p>

  <p class="note"><code><a href="#the-noscript-element">noscript</a></code>要素は<a href="syntax.html#syntax">HTML構文</a>でのみ有効だが、<a href="the-xhtml-syntax.html#the-xhtml-syntax">XHTML構文</a>では効果がない。スクリプトが有効である場合、この要素が動作する方法は、基本的にパーサを"オフ"にすることであり、要素の内容は、実際の要素としてではなく純粋にテキストとして扱われているのである。XMLは、これを実行するためのメカニズムを定義しない。</p>

  <div class="impl">

  <p>The <code><a href="#the-noscript-element">noscript</a></code> element has no other requirements. In particular, children of the
  <code><a href="#the-noscript-element">noscript</a></code> element are not exempt from <a href="forms.html#form-submission-0">form submission</a>, scripting, and so
  forth, even when <a data-anolis-xref="concept-n-script" href="webappapis.html#concept-n-script">scripting is enabled</a> for the element.</p>

  </div>

  <div class="example">

   <p>次の例において、<code><a href="#the-noscript-element">noscript</a></code>要素は、スクリプトのフォールバックを提供するために使用される。</p>

   <pre>&lt;form action="calcSquare.php"&gt;
 &lt;p&gt;
  &lt;label for=x&gt;Number&lt;/label&gt;:
  &lt;input id="x" name="x" type="number"&gt;
 &lt;/p&gt;
 &lt;script&gt;
  var x = document.getElementById('x');
  var output = document.createElement('p');
  output.textContent = 'Type a number; it will be squared right then!';
  x.form.appendChild(output);
  x.form.onsubmit = function () { return false; }
  x.oninput = function () {
    var v = x.valueAsNumber;
    output.textContent = v + ' squared is ' + v * v;
  };
 &lt;/script&gt;
 &lt;noscript&gt;
  &lt;input type=submit value="Calculate Square"&gt;
 &lt;/noscript&gt;
&lt;/form&gt;</pre>

   <p>スクリプトが無効である場合、ボタンは、サーバー側で計算を行うために表示される。スクリプトが有効である場合、代わりに値がその場で計算される。</p>

   <p><code><a href="#the-noscript-element">noscript</a></code>要素は鈍器である。時には、スクリプトを有効にするかもしれないが、何らかの理由でページのスクリプトが失敗するかもしれない。このような理由から、次の例のように、<code><a href="#the-noscript-element">noscript</a></code>要素の使用を避ける代わりに、その場でスクリプトのないページからスクリプト化されたページにページを変更するスクリプトを設計することが一般により良い：</p>

   <pre>&lt;form action="calcSquare.php"&gt;
 &lt;p&gt;
  &lt;label for=x&gt;Number&lt;/label&gt;:
  &lt;input id="x" name="x" type="number"&gt;
 &lt;/p&gt;
 <strong>&lt;input id="submit" type=submit value="Calculate Square"&gt;</strong>
 &lt;script&gt;
  var x = document.getElementById('x');
  var output = document.createElement('p');
  output.textContent = 'Type a number; it will be squared right then!';
  x.form.appendChild(output);
  x.form.onsubmit = function () { return false; }
  x.oninput = function () {
    var v = x.valueAsNumber;
    output.textContent = v + ' squared is ' + v * v;
  };
<strong>  var submit = document.getElementById('submit');
  submit.parentNode.removeChild(submit);</strong>
 &lt;/script&gt;
&lt;/form&gt;</pre>

   <p><code><a href="#the-noscript-element">noscript</a></code>要素は<a href="the-xhtml-syntax.html#the-xhtml-syntax">XHTML構文</a>でサポートされないため、上記のテクニックはXHTMLでも役立つ。</p>

  </div>


  <h4 id="the-template-element"><span class="secno">4.11.3</span> <dfn><code>template</code></dfn>要素</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">カテゴリ</a>：</dt>
   <dd><a href="dom.html#metadata-content-0">メタデータコンテンツ</a>。</dd>
   <dd><a href="dom.html#flow-content-1">フローコンテンツ</a>。</dd>
   <dd><a href="dom.html#phrasing-content-1">フレージングコンテンツ</a>。</dd>
   <dd><a data-anolis-xref="script-supporting elements" href="dom.html#script-supporting-elements-0">スクリプトサポート要素</a>。</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">この要素を使用できるコンテキスト</a>：</dt>
   <dd><a href="dom.html#metadata-content-0">メタデータコンテンツ</a>が期待される場所。</dd>
   <dd><a href="dom.html#phrasing-content-1">フレージングコンテンツ</a>が期待される場所。</dd>
   <dd><a href="dom.html#script-supporting-elements-0">スクリプトサポート要素</a>が期待される場所。</dd>
   <dd><code data-anolis-xref="attr-colgroup-span"><a href="tabular-data.html#attr-colgroup-span">span</a></code>属性を持たない<code><a href="tabular-data.html#the-colgroup-element">colgroup</a></code>要素の子として。</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">コンテンツモデル</a>：</dt>
   <dd>以下のいずれか：<a href="dom.html#metadata-content-0">メタデータコンテンツ</a>。</dd>
   <dd>または：<a href="dom.html#flow-content-1">フローコンテンツ</a>。</dd>
   <dd>または：<code><a href="grouping-content.html#the-ol-element">ol</a></code>および<code><a href="grouping-content.html#the-ul-element">ul</a></code>要素のコンテンツモデル。</dd>
   <dd>または：<code><a href="grouping-content.html#the-dl-element">dl</a></code>要素のコンテンツモデル。</dd>
   <dd>または：<code><a href="grouping-content.html#the-figure-element">figure</a></code>要素のコンテンツモデル。</dd>
   <dd>または：<code><a href="text-level-semantics.html#the-ruby-element">ruby</a></code>要素のコンテンツモデル。</dd>
   <dd>または：<code><a href="embedded-content-0.html#the-object-element">object</a></code>要素のコンテンツモデル。</dd>
   <dd>または：<code><a href="embedded-content-0.html#the-video-element">video</a></code>および<code><a href="embedded-content-0.html#the-audio-element">audio</a></code>要素のコンテンツモデル。</dd>
   <dd>または：<code><a href="tabular-data.html#the-table-element">table</a></code>要素のコンテンツモデル。</dd>
   <dd>または：<code><a href="tabular-data.html#the-colgroup-element">colgroup</a></code>要素のコンテンツモデル。</dd>
   <dd>または：<code><a href="tabular-data.html#the-thead-element">thead</a></code>、<code><a href="tabular-data.html#the-tbody-element">tbody</a></code>および<code><a href="tabular-data.html#the-tfoot-element">tfoot</a></code>要素のコンテンツモデル。</dd>
   <dd>または：<code><a href="tabular-data.html#the-tr-element">tr</a></code>要素のコンテンツモデル。</dd>
   <dd>または：<code><a href="forms.html#the-fieldset-element">fieldset</a></code>要素のコンテンツモデル。</dd>
   <dd>または：<code><a href="forms.html#the-select-element">select</a></code>要素のコンテンツモデル。</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">コンテンツ属性</a>：</dt>
   <dd><a href="dom.html#global-attributes">グローバル属性</a></dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">text/htmlにおけるタグ省略</span>：</dt>
   <dd>どちらのタグも省略不可</dd>
   <dt>許可される<a href="dom.html#aria-role-attribute">ARIAロール属性</a>値：</dt>
   <dd>なし</dd>
   <dt>許可される<a href="dom.html#state-and-property-attributes">ARIAステートおよびプロパティー</a>：</dt>
   <dd><a href="dom.html#index-aria-global">グローバルaria-* 属性</a></dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOMインターフェース</a>：</dt><!--TOPIC:DOM APIs-->
   <dd>
<pre class="idl">interface <dfn id="htmltemplateelement">HTMLTemplateElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
  readonly attribute <a href="infrastructure.html#documentfragment">DocumentFragment</a> <a data-anolis-xref="dom-template-content" href="#dom-template-content">content</a>;
};</pre>
</dd>
  </dl><!--TOPIC:HTML--><p><code><a href="#the-template-element">template</a></code>要素は、複製され、スクリプトによって文書に挿入できるHTMLの断片を宣言するために使用される。</p><!--START FORK -->

  
  <p class="note">テンプレートは、不活性DOMサブツリーを宣言し、サブツリーを同一の内容で文書断片をインスタンス化するために操作する方法を提供する。</p>
  
  <p class="note">ウェブページを動的に（たとえば、ユーザーとの対話またはサーバーから到着する新しいデータに応答して）文書の内容を変更する場合、使用コンテキストに適切な値を挿入するように、使用する前にさらなる変更を必要とするかもしれないHTMLの断片を要求することが一般的である。</p>
  
  <p class="note"><code><a href="#the-template-element">template</a></code>要素は、読み込み時に文書で使用されない文書断片の宣言を許可するが、HTMLとして解析され、ウェブページで使用するために実行時に利用可能である。</p><!--END FORK -->
  

  <p>レンダリングにおいて、<code><a href="#the-template-element">template</a></code>要素は何も<a href="dom.html#represents">表さ</a>ない。</p>

  <dl class="domintro"><dt><var data-anolis-xref="">template</var> . <code data-anolis-xref="dom-template-content"><a href="#dom-template-content">content</a></code></dt>

   <dd>

    <p>主<code><a href="dom.html#document">Document</a></code>に干渉する<code><a href="#the-template-element">template</a></code>のコンテンツを避けるために別の<code><a href="dom.html#document">Document</a></code>に関連付けられた<code><a href="infrastructure.html#documentfragment">DocumentFragment</a></code>に格納されている<code><a href="#the-template-element">template</a></code>のコンテンツを返す。（たとえば、これはフォームコントロールから送信されていくことを回避し、スクリプト実行から回避するなど。）</p>

   </dd>

  </dl><div class="impl">

  <p>Each <code><a href="#the-template-element">template</a></code> element has an associated <code><a href="infrastructure.html#documentfragment">DocumentFragment</a></code> object that
  is its <dfn id="template-contents">template contents</dfn>. When a <code><a href="#the-template-element">template</a></code> element is created, the user
  agent must run the following steps to establish the <a href="#template-contents">template contents</a>:</p>

  <ol><li><p>Let <var data-anolis-xref="">doc</var> be the <code><a href="#the-template-element">template</a></code> element's <code data-anolis-xref="dom-Node-ownerDocument"><a href="infrastructure.html#dom-node-ownerdocument">ownerDocument</a></code>'s <a href="#appropriate-template-contents-owner-document">appropriate template contents owner
   document</a>.</li>

   <li><p>Create a <code><a href="infrastructure.html#documentfragment">DocumentFragment</a></code> object whose <code data-anolis-xref="dom-Node-ownerDocument"><a href="infrastructure.html#dom-node-ownerdocument">ownerDocument</a></code> is <var data-anolis-xref="">doc</var>.</li>

   <li><p>Set the <code><a href="#the-template-element">template</a></code> element's <a href="#template-contents">template contents</a> to the newly
   created <code><a href="infrastructure.html#documentfragment">DocumentFragment</a></code> object.</li>

  </ol><p>A <code><a href="dom.html#document">Document</a></code> <var data-anolis-xref="">doc</var>'s <dfn id="appropriate-template-contents-owner-document">appropriate template contents owner
  document</dfn> is the <code><a href="dom.html#document">Document</a></code> returned by the following algorithm:</p>

  <ol><li>

    <p>If <var data-anolis-xref="">doc</var> is not a <code><a href="dom.html#document">Document</a></code> created by this algorithm, run
    these substeps:</p>

    <ol><li>

      <p>If <var data-anolis-xref="">doc</var> does not yet have an <dfn id="associated-inert-template-document">associated inert template
      document</dfn> then run these substeps:</p>

      <ol><li><p>Let <var data-anolis-xref="">new doc</var> be a new <code><a href="dom.html#document">Document</a></code> (that does not have a
       <a href="browsers.html#browsing-context">browsing context</a>). This is "a <code><a href="dom.html#document">Document</a></code> created by this algorithm"
       for the purposes of the step above.</li>

       <li><p>If <var data-anolis-xref="">doc</var> is an <a data-anolis-xref="HTML documents" href="infrastructure.html#html-documents">HTML document</a>, mark
       <var data-anolis-xref="">new doc</var> as an <a data-anolis-xref="HTML documents" href="infrastructure.html#html-documents">HTML document</a>
       also.</li>

       <li><p>Let <var data-anolis-xref="">doc</var>'s <a href="#associated-inert-template-document">associated inert template document</a> be <var data-anolis-xref="">new doc</var>.</li>

      </ol></li>

     <li><p>Set <var data-anolis-xref="">doc</var> to <var data-anolis-xref="">doc</var>'s <a href="#associated-inert-template-document">associated inert
     template document</a>.</li>

    </ol><p class="note">Each <code><a href="dom.html#document">Document</a></code> not created by this algorithm thus gets a single
    <code><a href="dom.html#document">Document</a></code> to act as its proxy for owning the <a href="#template-contents">template contents</a> of all
    its <code><a href="#the-template-element">template</a></code> elements, so that they aren't in a <a href="browsers.html#browsing-context">browsing context</a> and
    thus remain inert (e.g. scripts do not run). Meanwhile, <code><a href="#the-template-element">template</a></code> elements inside
    <code><a href="dom.html#document">Document</a></code> objects that <em>are</em> created by this algorithm just reuse the same
    <code><a href="dom.html#document">Document</a></code> owner for their contents.</p>

   </li>

   <li><p>Return <var data-anolis-xref="">doc</var>.</li>

  </ol><p>When a <code><a href="#the-template-element">template</a></code> element changes <code data-anolis-xref="dom-Node-ownerDocument"><a href="infrastructure.html#dom-node-ownerdocument">ownerDocument</a></code>, the user agent must run the following
  steps:</p>

  <ol><li><p>Let <var data-anolis-xref="">doc</var> be the <code><a href="#the-template-element">template</a></code> element's new <code data-anolis-xref="dom-Node-ownerDocument"><a href="infrastructure.html#dom-node-ownerdocument">ownerDocument</a></code>'s <a href="#appropriate-template-contents-owner-document">appropriate template contents owner
   document</a>.</li>

   <li><p><a data-anolis-xref="concept-node-adopt" href="infrastructure.html#concept-node-adopt">Adopt</a> the <code><a href="#the-template-element">template</a></code> element's
   <a href="#template-contents">template contents</a> (a <code><a href="infrastructure.html#documentfragment">DocumentFragment</a></code> object) into <var data-anolis-xref="">doc</var>.</li>

  </ol><p>The <dfn data-anolis-xref="dom-template-content" id="dom-template-content"><code>content</code></dfn> IDL attribute must return the
  <code><a href="#the-template-element">template</a></code> element's <a href="#template-contents">template contents</a>.</p>

  <hr><p>The <a data-anolis-xref="concept-node-clone-ext" href="infrastructure.html#concept-node-clone-ext">cloning steps</a> for a <code><a href="#the-template-element">template</a></code>
  element <var data-anolis-xref="">node</var> being cloned to a copy <var data-anolis-xref="">copy</var> must run the
  following steps:</p>

  <ol><li><p>If the <var data-anolis-xref="">clone children flag</var> is not set in the calling <a data-anolis-xref="concept-node-clone" href="infrastructure.html#concept-node-clone">clone</a> algorithm, abort these steps.</li>

   <li><p>Let <var data-anolis-xref="">copied contents</var> be the result of <a data-anolis-xref="concept-node-clone" href="infrastructure.html#concept-node-clone">cloning</a> all the children of <var data-anolis-xref="">node</var>'s
   <a href="#template-contents">template contents</a>, with <var data-anolis-xref="">ownerDocument</var> set to <var data-anolis-xref="">copy</var>'s <a href="#template-contents">template contents</a>'s <code data-anolis-xref="dom-Node-ownerDocument"><a href="infrastructure.html#dom-node-ownerdocument">ownerDocument</a></code>, and with the <var data-anolis-xref="">clone children
   flag</var> set.</li>

   <li><p>Append <var data-anolis-xref="">copied contents</var> to <var data-anolis-xref="">copy</var>'s <a href="#template-contents">template
   contents</a>.</li>

  </ol></div>

  <div class="example">

   <p>この例において、手動でマークアップから構造体を生成する代わりに要素構造を提供する<code><a href="#the-template-element">template</a></code>を使用して、スクリプトがデータ構造由来のデータをもつ表を事前設定する。</p>

   <pre>&lt;!DOCTYPE html&gt;
&lt;title&gt;Cat data&lt;/title&gt;
&lt;script&gt;
 // Data is hard-coded here, but could come from the server
 var data = [
   { name: 'Pillar', color: 'Ticked Tabby', sex: 'Female (neutered)', legs: 3 },
   { name: 'Hedral', color: 'Tuxedo', sex: 'Male (neutered)', legs: 4 },
 ];
&lt;/script&gt;
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th&gt;Name &lt;th&gt;Color &lt;th&gt;Sex &lt;th&gt;Legs
 &lt;tbody&gt;
  &lt;template id="row"&gt;
   &lt;tr&gt;&lt;td&gt;&lt;td&gt;&lt;td&gt;&lt;td&gt;
  &lt;/template&gt;
&lt;/table&gt;
&lt;script&gt;
 var template = document.querySelector('#row');
 for (var i = 0; i &lt; data.length; i += 1) {
   var cat = data[i];
   var clone = template.content.cloneNode(true);
   var cells = clone.querySelectorAll('td');
   cells[0].textContent = cat.name;
   cells[1].textContent = cat.color;
   cells[2].textContent = cat.sex;
   cells[3].textContent = cat.legs;
   template.parentNode.appendChild(clone);
 }
&lt;/script&gt;</pre>

  </div>

  <div class="impl">

  <h5 id="template-XSLT-XPath"><span class="secno">4.11.3.1 </span>Interaction of <code><a href="#the-template-element">template</a></code> elements with XSLT and XPath</h5>

  <p><i>この節は非規範的である。</i></p>
  <p>This specification does not define how XSLT and XPath interact with the <code><a href="#the-template-element">template</a></code>
  element. However, in the absence of another specification actually defining this, here are some
  guidelines for implementors, which are intended to be consistent with other processing described
  in this specification:</p>

  <ul><li><p>An XSLT processor based on an XML parser that acts <a data-anolis-xref="xml parser" href="the-xhtml-syntax.html#xml-parser">as described
   in this specification</a> needs to act as if <code><a href="#the-template-element">template</a></code> elements contain as
   descendants their <a href="#template-contents">template contents</a> for the purposes of the transform.</li>

   <li><p>An XSLT processor that outputs a DOM needs to ensure that nodes that would go into a
   <code><a href="#the-template-element">template</a></code> element are instead placed into the element's <a href="#template-contents">template
   contents</a>.</li>

   <li><p>XPath evaluation using the XPath DOM API when applied to a <code><a href="dom.html#document">Document</a></code> parsed
   using the <a href="syntax.html#html-parser">HTML parser</a> or the <a href="the-xhtml-syntax.html#xml-parser">XML parser</a> described in this specification
   needs to ignore <a href="#template-contents">template contents</a>.</p>

  </li></ul></div><!--TOPIC:Canvas-->



  <h4 id="the-canvas-element"><span class="secno">4.11.4</span> <dfn id="canvas"><code>canvas</code></dfn>要素</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">カテゴリ</a>：</dt>
   <dd><a href="dom.html#flow-content-1">フローコンテンツ</a>。</dd>
   <dd><a href="dom.html#phrasing-content-1">フレージングコンテンツ</a>。</dd>
   <dd><a href="dom.html#embedded-content-2">エンベディッドコンテンツ</a>。</dd>
   <dd><a href="dom.html#palpable-content-0">パルパブルコンテンツ</a>。</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">この要素を使用できるコンテキスト</a>：</dt>
   <dd><a href="dom.html#embedded-content-2">エンベディッドコンテンツ</a>が期待される場所。</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">コンテンツモデル</a>：</dt>
   <dd><a href="dom.html#transparent">透過的</a><!--
--><!--
--></dd><!-- and maybe <select>, I guess? I've left it our for now, since I guess authors might make accessible selects if they're simple enough, and it's not obvious how to distinguish the simple ones from the complex ones... --> 
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">コンテンツ属性</a>：</dt>
   <dd><a href="dom.html#global-attributes">グローバル属性</a></dd>
   <dd><code data-anolis-xref="attr-canvas-width"><a href="#attr-canvas-width">width</a></code> - 横の次元</dd>
   <dd><code data-anolis-xref="attr-canvas-height"><a href="#attr-canvas-height">height</a></code> - 縦の次元</dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">text/htmlにおけるタグ省略</span>：</dt>
   <dd>どちらのタグも省略不可</dd>
   <dt>許可される<a href="dom.html#aria-role-attribute">ARIAロール属性</a>値：</dt>
   <dd><a href="dom.html#allowed-aria-roles,-states-and-properties">任意のrole値</a>。</dd>
   <dt>許可される<a href="dom.html#state-and-property-attributes">ARIAステートおよびプロパティー</a>：</dt>
   <dd><a href="dom.html#index-aria-global">グローバルaria-* 属性</a></dd>
   <dd><a href="dom.html#allowed-aria-roles,-states-and-properties">許可されるロールで受け入れ可能な</a>任意の<code title="">aria-*</code>属性。</dd>
   <dd><code data-anolis-xref="attr-canvas-width"><a href="#attr-canvas-width">width</a></code></dd>
   <dd><code data-anolis-xref="attr-canvas-height"><a href="#attr-canvas-height">height</a></code></dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOMインターフェース</a>：</dt><!--ADD-TOPIC:DOM APIs-->
   <dd>
    <pre class="idl">typedef (<span>CanvasRenderingContext2D</span> or <a href="infrastructure.html#webglrenderingcontext">WebGLRenderingContext</a>) <dfn id="renderingcontext">RenderingContext</dfn>;

interface <dfn id="htmlcanvaselement">HTMLCanvasElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
           attribute unsigned long <a data-anolis-xref="dom-canvas-width" href="#dom-canvas-width">width</a>;
           attribute unsigned long <a data-anolis-xref="dom-canvas-height" href="#dom-canvas-height">height</a>;

  <a href="#renderingcontext">RenderingContext</a>? <a data-anolis-xref="dom-canvas-getContext" href="#dom-canvas-getcontext">getContext</a>(DOMString contextId, any... arguments);

  DOMString <a data-anolis-xref="dom-canvas-toDataURL" href="#dom-canvas-todataurl">toDataURL</a>(optional DOMString type, any... arguments);
  void <a data-anolis-xref="dom-canvas-toBlob" href="#dom-canvas-toblob">toBlob</a>(<a href="infrastructure.html#filecallback">FileCallback</a>? _callback, optional DOMString type, any... arguments);
};</pre>
   </dd>
  </dl><!--REMOVE-TOPIC:DOM APIs--><p><code><a href="#the-canvas-element">canvas</a></code>要素は、グラフ、ゲームグラフィック、芸術、またはその他の視覚的な画像をその場でレンダリングするために使用できる、解像度に依存するビットマップキャンバスを伴うスクリプトを提供する。</p>

  <p class="auth">より適切な要素が利用可能である場合、著者は文書で<code><a href="#the-canvas-element">canvas</a></code>要素を使うべきでない。たとえば、見出し、ページを描画する<code><a href="#the-canvas-element">canvas</a></code>要素を使用することは不適当である：見出しの望ましいプレゼンテーショングラフィカルに強烈であれば、それは適切な要素（典型的には<code><a href="sections.html#the-h1,-h2,-h3,-h4,-h5,-and-h6-elements"> h1</a></code>）を使用してマークアップし、CSSを使用していて、そのような技術をサポートするスタイリングする必要がありXBL。</p>

  <p class="auth">著者が<code><a href="#the-canvas-element">canvas</a></code>要素を使用する場合、著者はまた、ユーザーに提示する際、<code><a href="#the-canvas-element">canvas</a></code>のビットマップとして同じ機能や目的を基本的に伝えるコンテンツを提供しなければならない。このコンテンツは<code><a href="#the-canvas-element">canvas</a></code>要素のコンテンツとして置かれてもよい。<code><a href="#the-canvas-element">canvas</a></code>要素のコンテンツは、もしあれば、その要素の<a href="dom.html#fallback-content">フォールバックコンテンツ</a>である。</p>

  <hr><p>対話的な視覚メディアにおいて、<code><a href="#the-canvas-element">canvas</a></code>要素に対して<a data-anolis-xref="concept-n-script" href="webappapis.html#concept-n-script">スクリプティングが有効である</a>場合、かつ<code><a href="#the-canvas-element">canvas</a></code>要素に対するサポートが有効である場合、<code><a href="#the-canvas-element">canvas</a></code>要素は、動的に作成された画像ジから成る<a href="dom.html#embedded-content-2">エンベディッドコンテンツ</a>を<a href="dom.html#represents">表す</a>。
</p>

  <p>静的で、非対話的な視覚メディアにおいて、<code><a href="#the-canvas-element">canvas</a></code>要素が以前に描かれている場合（たとえば、ページがインタラクティブな視覚媒体で表示され、現在描かれている場合、またはページレイアウトプロセス中に実行された一部のスクリプトが要素で描かれた場合）、<code><a href="#the-canvas-element">canvas</a></code>要素は、現在のビットマップとサイズをもつ<a href="dom.html#embedded-content-2">エンベディッドコンテンツ</a>を<a href="dom.html#represents">表す</a>。そうでなければ、要素は代わりにその<a href="dom.html#fallback-content">フォールバックコンテンツ</a>を表す。</p>

  <p>非視覚系メディアにおいて、かつ視覚メディアで<code><a href="#the-canvas-element">canvas</a></code>要素に対して<a data-anolis-xref="concept-n-noscript" href="webappapis.html#concept-n-noscript">スクリプトが無効である</a>場合、または<code><a href="#the-canvas-element">canvas</a></code>要素のサポートが無効である場合、<code><a href="#the-canvas-element">canvas</a></code>要素は代わりに<a href="dom.html#fallback-content">フォールバックコンテンツ</a>を<a href="dom.html#represents">表す</a>。</p><!-- CANVAS-FOCUS-FALLBACK -->

  
  <p class="auth"><code><a href="#the-canvas-element">canvas</a></code>要素が<a href="dom.html#embedded-content-2">エンベディッドコンテンツ</a>を<a href="dom.html#represents">表す</a>場合、ユーザーは<code><a href="#the-canvas-element">canvas</a></code>要素の子孫（<a href="dom.html#fallback-content">フォールバックコンテンツ</a>内）にフォーカスできる。要素がフォーカスされている場合、（要素自体が表示されていなくても）キーボード操作イベントの対象となる。これは、著者がインタラクティブキャンバスをキーボードアクセシブルにできる：著者は、<a href="dom.html#fallback-content">フォールバックコンテンツ</a>内のフォーカス可能な要素にインタラクティブな領域の1対1対応を持つべきである。（フォーカスは、マウス操作のイベントに影響しない。）<a href="references.html#refsDOMEVENTS">[DOMEVENTS]</a></p><!-- user interaction spec integration point --> 

  <hr><p><code><a href="#the-canvas-element">canvas</a></code>要素は、要素ビットマップの大きさを制御する<dfn data-anolis-xref="attr-canvas-width" id="attr-canvas-width"><code>width</code></dfn>と<dfn data-anolis-xref="attr-canvas-height" id="attr-canvas-height"><code>height</code></dfn>の2つの属性を持つ。指定される場合、これらの属性は<a data-anolis-xref="valid non-negative integer" href="infrastructure.html#valid-non-negative-integer">妥当な非負の整数</a>である値を持たなければならない。<span class="impl">The <a href="infrastructure.html#rules-for-parsing-non-negative-integers">rules for parsing non-negative integers</a> must be used to obtain their numeric values. If an attribute is missing, or if parsing its value returns an error, then the default value must be used instead.</span> The <code data-anolis-xref="attr-canvas-width"><a href="#attr-canvas-width">width</a></code> attribute defaults to 300, and the <code data-anolis-xref="attr-canvas-height"><a href="#attr-canvas-height">height</a></code> attribute defaults to 150.</p>

  <p>要素が<a href="dom.html#embedded-content-2">エンベディッドコンテンツ</a>を<a href="dom.html#represents">表す</a>場合、<code><a href="#the-canvas-element">canvas</a></code>要素の内在寸法は、要素のビットマップの内在寸法に等しい。</p>

  <p class="note"><code><a href="#the-canvas-element">canvas</a></code>要素は、スタイルシートによって任意のサイズにでき、そのビットマップは'object-fit' CSSプロパティーの対象となる。<a href="references.html#refsCSSIMAGES">[CSSIMAGES]</a></p>

  <div class="impl">

  <hr><!--ADD-TOPIC:Security--><!--FORK canvas is a separate spec--><p>The bitmaps of <code><a href="#the-canvas-element">canvas</a></code> elements, as well as some of the bitmaps of rendering
  contexts, such as those described in the HTML Canvas 2D Context specification 
  <a href="references.html#refsCANVAS2D">[CANVAS2D]</a>,
  have an <dfn data-anolis-xref="concept-canvas-origin-clean" id="concept-canvas-origin-clean">origin-clean</dfn> flag, which can
  be set to true or false. Initially, when the <code><a href="#the-canvas-element">canvas</a></code> element is created, its bitmap's
  <a data-anolis-xref="concept-canvas-origin-clean" href="#concept-canvas-origin-clean">origin-clean</a> flag must be set to true.</p><!--REMOVE-TOPIC:Security-->


  <p>A <code><a href="#the-canvas-element">canvas</a></code> bitmap can also have a <span>hit region list</span>, as described in the
  <code>CanvasRenderingContext2D</code> section below.</p>

  <p>A <code><a href="#the-canvas-element">canvas</a></code> element can have a rendering context bound to it. Initially, it does not
  have a bound rendering context. To keep track of whether it has a rendering context or not, and
  what kind of rendering context it is, a <code><a href="#the-canvas-element">canvas</a></code> also has a <dfn data-anolis-xref="concept-canvas-context-mode" id="concept-canvas-context-mode">canvas context mode</dfn>, which is initially <dfn data-anolis-xref="concept-canvas-none" id="concept-canvas-none">none</dfn> but can be changed to either <dfn data-anolis-xref="concept-canvas-direct-2d" id="concept-canvas-direct-2d">direct-2d</dfn>, <dfn data-anolis-xref="concept-canvas-direct-webgl" id="concept-canvas-direct-webgl">direct-webgl</dfn>, <dfn data-anolis-xref="concept-canvas-indirect" id="concept-canvas-indirect">indirect</dfn>, or <dfn data-anolis-xref="concept-canvas-proxied" id="concept-canvas-proxied">proxied</dfn> by algorithms defined in this specification.</p>

  <p>When its <a data-anolis-xref="concept-canvas-context-mode" href="#concept-canvas-context-mode">canvas context mode</a> is <a data-anolis-xref="concept-canvas-none" href="#concept-canvas-none">none</a>, a <code><a href="#the-canvas-element">canvas</a></code> element has no rendering context,
  and its bitmap must be fully transparent black with an intrinsic width equal to the numeric value
  of the element's <code data-anolis-xref="attr-canvas-width"><a href="#attr-canvas-width">width</a></code> attribute and an intrinsic height
  equal to the numeric value of the element's <code data-anolis-xref="attr-canvas-height"><a href="#attr-canvas-height">height</a></code>
  attribute, those values being interpreted in CSS pixels, and being updated as the attributes are
  set, changed, or removed.</p>

  <p>When a <code><a href="#the-canvas-element">canvas</a></code> element represents <a href="dom.html#embedded-content-2">embedded content</a>, it <a href="infrastructure.html#provides-a-paint-source">provides
  a paint source</a> whose width is the element's intrinsic width, whose height is the element's
  intrinsic height, and whose appearance is the element's bitmap.</p>

  <p>Whenever the <code data-anolis-xref="attr-canvas-width"><a href="#attr-canvas-width">width</a></code> and <code data-anolis-xref="attr-canvas-height"><a href="#attr-canvas-height">height</a></code> content attributes are set, removed, changed, or
  redundantly set to the value they already have, if the <a data-anolis-xref="concept-canvas-context-mode" href="#concept-canvas-context-mode">canvas context mode</a> is <a data-anolis-xref="concept-canvas-direct-2d" href="#concept-canvas-direct-2d">direct-2d</a><!-- (and the rendering context's <span
  data-x="concept-canvas-context-bitmap-mode">context bitmap mode</span>, therefore, is <span
  data-x="concept-canvas-fixed">fixed</span>)-->, the user agent must <a data-anolis-xref="concept-canvas-set-bitmap-dimensions" href="infrastructure.html#concept-canvas-set-bitmap-dimensions">set bitmap dimensions</a> to the numeric values of
  the <code data-anolis-xref="attr-canvas-width"><a href="#attr-canvas-width">width</a></code> and <code data-anolis-xref="attr-canvas-height"><a href="#attr-canvas-height">height</a></code> content attributes.</p>

  <p>The <dfn data-anolis-xref="dom-canvas-width" id="dom-canvas-width"><code>width</code></dfn> and <dfn data-anolis-xref="dom-canvas-height" id="dom-canvas-height"><code>height</code></dfn> IDL attributes must <a href="infrastructure.html#reflect">reflect</a> the
  respective content attributes of the same name, with the same defaults.</p>

  </div>

  <p class="note"><code><a href="#the-canvas-element">canvas</a></code>要素で使用されるビットマップは、任意の画素密度を持つことができる。一般に、密度はユーザーの画面のものと一致する。</p>

  <hr><!--ADD-TOPIC:DOM APIs--><dl class="domintro"><dt><var data-anolis-xref="">context</var> = <var data-anolis-xref="">canvas</var> . <code data-anolis-xref="dom-canvas-getContext"><a href="#dom-canvas-getcontext">getContext</a></code>(<var data-anolis-xref="">contextId</var> [, ... ])</dt>

   <dd>

    <p>キャンバス上に描画するためのAPIを公開するオブジェクトを返す。最初の引数は目的のAPIを指定する、"<code data-anolis-xref="canvas-context-2d"><a href="#canvas-context-2d">2d</a></code>"または"<code data-anolis-xref="canvas-context-webgl"><a href="#canvas-context-webgl">webgl</a></code>"のいずれかである。後続の引数は、そのAPIによって処理される。</p><!--2DCONTEXT-->



    <p>定義されたコンテキストのリストは、<a href="http://wiki.whatwg.org/wiki/CanvasContexts">WHATWG Wiki CanvasContexts page</a>に記載されている。<a href="references.html#refsWHATWGWIKI">[WHATWGWIKI]</a>

    <p>例のコンテキストは、"<code data-anolis-xref="canvas-context-2d"><a href="#canvas-context-2d">2d</a></code>" <a href="references.html#refsCANVAS2D">[CANVAS2D]</a>および"<code data-anolis-xref="canvas-context-webgl"><a href="#canvas-context-webgl">webgl</a></code>"コンテキスト<a href="references.html#refsWEBGL">[WEBGL]</a>である。</p>

    <p>与えられたコンテキストIDがサポートされない場合、またはキャンバスがすでに他の（非互換の）コンテキストタイプ（たとえば、"<code data-anolis-xref="canvas-context-webgl"><a href="#canvas-context-webgl">webgl</a></code>"コンテキストを取得した後、"<code data-anolis-xref="canvas-context-2d"><a href="#canvas-context-2d">2d</a></code>"コンテキストを取得しようとしている）で初期化されている場合、nullを返す。</p>

   </dd>

  </dl><div class="impl">

  <p>Each rendering context has a <dfn data-anolis-xref="concept-canvas-context-bitmap-mode" id="concept-canvas-context-bitmap-mode">context bitmap
  mode</dfn>, which is one of <dfn data-anolis-xref="concept-canvas-fixed" id="concept-canvas-fixed">fixed</dfn>, <dfn data-anolis-xref="concept-canvas-unbound" id="concept-canvas-unbound">unbound</dfn>, or <dfn data-anolis-xref="concept-canvas-bound" id="concept-canvas-bound">bound</dfn>.
  Initially, rendering contexts must be in the <a data-anolis-xref="concept-canvas-bound" href="#concept-canvas-bound">unbound</a>
  mode.</p>

  <hr><p>The <dfn data-anolis-xref="dom-canvas-getContext" id="dom-canvas-getcontext"><code>getContext(<var data-anolis-xref="">contextId</var>, <var data-anolis-xref="">arguments...</var>)</code></dfn> method of the <code><a href="#the-canvas-element">canvas</a></code> element, when invoked,
  must run the steps in the cell of the following table whose column header describes the
  <code><a href="#the-canvas-element">canvas</a></code> element's <a data-anolis-xref="concept-canvas-context-mode" href="#concept-canvas-context-mode">canvas context mode</a>
  and whose row header describes the method's first argument.</p>

  <table><thead><tr><td>
     <th><a data-anolis-xref="concept-canvas-none" href="#concept-canvas-none">なし</a>
     </th><th><a data-anolis-xref="concept-canvas-direct-2d" href="#concept-canvas-direct-2d">direct-2d</a>
     </th><th><a data-anolis-xref="concept-canvas-direct-webgl" href="#concept-canvas-direct-webgl">direct-webgl</a>
     </th><th><a data-anolis-xref="concept-canvas-indirect" href="#concept-canvas-indirect">indirect</a>
     </th><th><a data-anolis-xref="concept-canvas-proxied" href="#concept-canvas-proxied">proxied</a>
   <tbody></th></td></tr><tr><th>"<dfn data-anolis-xref="canvas-context-2d" id="canvas-context-2d"><code>2d</code></dfn>"
     
     <td><!--FORK canvas is a separate spec-->
      
      
      Set the <code><a href="#the-canvas-element">canvas</a></code> element's <a data-anolis-xref="concept-canvas-context-mode" href="#concept-canvas-context-mode">context
      mode</a> to <a data-anolis-xref="concept-canvas-direct-2d" href="#concept-canvas-direct-2d">direct-2d</a>, obtain a
      <code>CanvasRenderingContext2D</code> object as defined in the HTML Canvas 2D Context 
      specification <a href="references.html#refsCANVAS2D">[CANVAS2D]</a>, set the obtained 
      <code>CanvasRenderingContext2D</code> object's 
      <a data-anolis-xref="concept-canvas-context-bitmap-mode" href="#concept-canvas-context-bitmap-mode">context bitmap mode</a> to
      <a data-anolis-xref="concept-canvas-fixed" href="#concept-canvas-fixed">fixed</a>, and return the
      <code>CanvasRenderingContext2D</code> object
     
     </td><td>
      
      Return the same object as was return the last time the method was invoked with this same
      argument.
     
     </td><td>
      
      Return null.
     
     </td><td>
      
      Throw an <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception.
     
     </td><td>
      
      Throw an <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception.

    

    </td></th></tr><tr><th>"<dfn data-anolis-xref="canvas-context-webgl" id="canvas-context-webgl"><code>webgl</code></dfn>", if the user agent supports the WebGL feature in its current configuration
     
     <td>
      
      Follow the instructions given in the WebGL specification's <i>Context Creation</i> section to
      obtain either a <code><a href="infrastructure.html#webglrenderingcontext">WebGLRenderingContext</a></code> or null; if the returned value is null,
      then return null and abort these steps, otherwise, set the <code><a href="#the-canvas-element">canvas</a></code> element's <a data-anolis-xref="concept-canvas-context-mode" href="#concept-canvas-context-mode">context mode</a> to <a data-anolis-xref="concept-canvas-direct-webgl" href="#concept-canvas-direct-webgl">direct-webgl</a>, set the new
      <code><a href="infrastructure.html#webglrenderingcontext">WebGLRenderingContext</a></code> object's <a data-anolis-xref="concept-canvas-context-bitmap-mode" href="#concept-canvas-context-bitmap-mode">context bitmap mode</a> to <a data-anolis-xref="concept-canvas-fixed" href="#concept-canvas-fixed">fixed</a>, and return the <code><a href="infrastructure.html#webglrenderingcontext">WebGLRenderingContext</a></code>
      object‡ <a href="references.html#refsWEBGL">[WEBGL]</a>
     </td><td>
      
      Return null.
     
     </td><td>
      
      Return the same object as was return the last time the method was invoked with this same
      argument.
     
     </td><td>
      
      Throw an <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception.
     
     </td><td>
      
      Throw an <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception.

    

    </td></th></tr><tr><th>A vendor-specific extension*
     
     <td>
      
      Behave as defined for the extension.
     
     </td><td>
      
      Behave as defined for the extension.
     
     </td><td>
      
      Behave as defined for the extension.
     
     </td><td>
      
      Throw an <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception.
     
     </td><td>
      
      Throw an <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception.

    

    </td></th></tr><tr><th>An unsupported value†
     
     <td>
      
      Return null.
     
     </td><td>
      
      Return null.
     
     </td><td>
      
      Return null.
     
     </td><td>
      
      Throw an <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception.
     
     </td><td>
      
      Throw an <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception.
    
  
    
  </td></th></tr></table><p class="tablenote"><small>* Vendors may define experimental contexts using the syntax <code><var data-anolis-xref="">vendorname</var>-<var data-anolis-xref="">context</var></code>, for example,
  <code>moz-3d</code>.</small></p>

  <p class="tablenote"><small>† For example, the "<code data-anolis-xref="canvas-context-webgl"><a href="#canvas-context-webgl">webgl</a></code>" value in the case of a user agent having exhausted the
  graphics hardware's abilities and having no software fallback implementation.</small></p>

  <p class="tablenote"><small>‡ The second (and subsequent) argument(s) to the method, if
  any, are ignored in all cases except this one. See the WebGL specification for
  details.</small></p>

  </div>

  <dl class="domintro"><dt><var data-anolis-xref="">url</var> = <var data-anolis-xref="">canvas</var> . <code data-anolis-xref="dom-canvas-toDataURL"><a href="#dom-canvas-todataurl">toDataURL</a></code>( [ <var data-anolis-xref="">type</var>, ... ] )</dt>

   <dd>

    <p>キャンバスで画像に対する<a data-anolis-xref="data protocol" href="infrastructure.html#data-protocol"><code data-anolis-xref="">data:</code> URL</a>を返す。</p>

    <p>最初の引数が与えられた場合、返される画像の型（たとえば、PNGまたはJPEG）を制御する。デフォルトは<code data-anolis-xref="">image/png</code>である。指定された型がサポートされない場合、そのタイプも使用される。他の引数は型に固有のものであり、<a href="#canvas-serialization-arguments">以下の表</a>に示すような画像が生成される方法を制御する。</p>

    <p>"<code>image/png</code>"以外の型を使用しようとする際、著者は、実際に返された文字列が正確に<code data-anolis-xref="">data:image/png,</code>"または"<code data-anolis-xref="">data:image/png;</code>"のいずれかの文字列で始まるかどうかをチェックすることで、画像が要求された形式で返されたかどうかを確認できる。その場合、画像はPNGであり、したがって要求された型はサポートされない。（キャンバスが高さや幅のいずれかを持たない場合、このような例外の一つであり、結果は単に"<code data-anolis-xref="">data:,</code>"であるかもしれない）。</p>

    <p><code data-anolis-xref="dom-canvas-toDataURL"><a href="#dom-canvas-todataurl">toDataURL()</a></code>メソッドは96dpiの解像度でのデータを返す。</p>

   </dd>

   <dt><var data-anolis-xref="">canvas</var> . <code data-anolis-xref="dom-canvas-toBlob"><a href="#dom-canvas-toblob">toBlob</a></code>(<var data-anolis-xref="">callback</var> [, <var data-anolis-xref="">type</var>, ... ])</dt>

   <dd>

    <p>キャンバス内の画像を含むファイルを表す<code><a href="infrastructure.html#blob">Blob</a></code>オブジェクトを作成し、そのオブジェクトへのハンドルとともにコールバックを呼び出す。</p>

    <p>2つ目の引数が与えられた場合、返される画像の型（たとえば、PNGまたはJPEG）を制御する。デフォルトは<code data-anolis-xref="">image/png</code>である。指定された型がサポートされない場合、そのタイプも使用される。他の引数は型に固有のものであり、<a href="#canvas-serialization-arguments">以下の表</a>に示すような画像が生成される方法を制御する。</p>

    <p><code data-anolis-xref="dom-canvas-toBlob"><a href="#dom-canvas-toblob">toBlob()</a></code>メソッドは96dpiの解像度でのデータを提供する。</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-canvas-toDataURL" id="dom-canvas-todataurl"><code>toDataURL()</code></dfn> method must run the following
  steps:</p>

  <ol><!--ADD-TOPIC:Security--><li><p>If the <code><a href="#the-canvas-element">canvas</a></code> element's bitmap's <a data-anolis-xref="concept-canvas-origin-clean" href="#concept-canvas-origin-clean">origin-clean</a> flag is set to false, throw a
   <code><a href="infrastructure.html#securityerror">SecurityError</a></code> exception and abort these steps.</p><!--REMOVE-TOPIC:Security-->


   </li><li><p>If the <code><a href="#the-canvas-element">canvas</a></code> element's bitmap has no pixels (i.e. either its horizontal
   dimension or its vertical dimension is zero) then return the string "<code data-anolis-xref="">data:,</code>" and abort these steps. (This is the shortest <a data-anolis-xref="data
   protocol" href="infrastructure.html#data-protocol"><code data-anolis-xref="">data:</code> URL</a>; it represents the empty string in a <code data-anolis-xref="">text/plain</code> resource.)</li>

   <li><p>Let <var data-anolis-xref="">file</var> be <a data-anolis-xref="a serialization of the bitmap as a file" href="#a-serialization-of-the-bitmap-as-a-file">a
   serialization of the <code>canvas</code> element's bitmap as a file</a>, using the method's
   arguments (if any) as the <var data-anolis-xref="">arguments</var>.</li>

   <li><p>Return a <a data-anolis-xref="data protocol" href="infrastructure.html#data-protocol"><code data-anolis-xref="">data:</code> URL</a> representing
   <var data-anolis-xref="">file</var>. <a href="references.html#refsRFC2397">[RFC2397]</a></p><!-- should we explicitly require the URL to be base64-encoded and not have any parameters, to
   ensure the same exact URL is generated in each browser? -->

   

  </li></ol><p>The <dfn data-anolis-xref="dom-canvas-toBlob" id="dom-canvas-toblob"><code>toBlob()</code></dfn> method must run the following
  steps:</p>

  <ol><!--ADD-TOPIC:Security--><li><p>If the <code><a href="#the-canvas-element">canvas</a></code> element's bitmap's <a data-anolis-xref="concept-canvas-origin-clean" href="#concept-canvas-origin-clean">origin-clean</a> flag is set to false, throw a
   <code><a href="infrastructure.html#securityerror">SecurityError</a></code> exception and abort these steps.</p><!--REMOVE-TOPIC:Security-->


   </li><li><p>Let <var data-anolis-xref="">callback</var> be the first argument.</li>

   <li><p>Let <var data-anolis-xref="">arguments</var> be the second and subsequent arguments to the method, if
   any.</li>

   <li>

    <p>If the <code><a href="#the-canvas-element">canvas</a></code> element's bitmap has no pixels (i.e. either its horizontal
    dimension or its vertical dimension is zero) then let <var data-anolis-xref="">result</var> be null.</p>

    <p>Otherwise, let <var data-anolis-xref="">result</var> be a <code><a href="infrastructure.html#blob">Blob</a></code> object representing <a data-anolis-xref="a serialization of the bitmap as a file" href="#a-serialization-of-the-bitmap-as-a-file">a serialization of the <code>canvas</code>
    element's bitmap as a file</a>, using <var data-anolis-xref="">arguments</var>. <a href="references.html#refsFILEAPI">[FILEAPI]</a> </p>

   </li>

   <li><p>Return, but continue running these steps asynchronously.</li>

   <li><p>If <var data-anolis-xref="">callback</var> is null, abort these steps.</li>

   <li><p><a href="webappapis.html#queue-a-task">Queue a task</a> to invoke the <code><a href="infrastructure.html#filecallback">FileCallback</a></code> <var data-anolis-xref="">callback</var> with <var data-anolis-xref="">result</var> as its argument. The <a href="webappapis.html#task-source">task
   source</a> for this task is the <dfn id="canvas-blob-serialization-task-source">canvas blob serialization task source</dfn>.</li>

  </ol></div><!--REMOVE-TOPIC:DOM APIs--><!--2DCONTEXT-->
  

  

  <div class="impl">

  <h5 id="color-spaces-and-color-correction"><span class="secno">4.11.4.1 </span>Color spaces and color correction</h5>

  <p>The <code><a href="#the-canvas-element">canvas</a></code> APIs must perform color correction at only two points: when rendering
  images with their own gamma correction and color space information onto a bitmap, to convert the
  image to the color space used by the bitmaps (e.g. using the 2D Context's <code data-anolis-xref="dom-context-2d-drawImage">drawImage()</code> method with an <code><a href="embedded-content-0.html#htmlimageelement">HTMLImageElement</a></code>
  object), and when rendering the actual canvas bitmap to the output device.</p>

  <p class="note">Thus, in the 2D context, colors used to draw shapes onto the canvas will exactly
  match colors obtained through the <code data-anolis-xref="dom-context-2d-getImageDataHD">getImageDataHD()</code> method.</p>

  <p>The <code data-anolis-xref="dom-canvas-toDataURL"><a href="#dom-canvas-todataurl">toDataURL()</a></code> method must not include color space
  information in the resources it returns. Where the output format allows it, the color of pixels
  in resources created by <code data-anolis-xref="dom-canvas-toDataURL"><a href="#dom-canvas-todataurl">toDataURL()</a></code> must match those
  returned by the <code data-anolis-xref="dom-context-2d-getImageData">getImageData()</code> method.</p>

  <p>In user agents that support CSS, the color space used by a <code><a href="#the-canvas-element">canvas</a></code> element must
  match the color space used for processing any colors for that element in CSS.</p>

  <p>The gamma correction and color space information of images must be handled in such a way that
  an image rendered directly using an <code><a href="embedded-content-0.html#the-img-element">img</a></code> element would use the same colors as one
  painted on a <code><a href="#the-canvas-element">canvas</a></code> element that is then itself rendered. Furthermore, the rendering
  of images that have no color correction information (such as those returned by the <code data-anolis-xref="dom-canvas-toDataURL"><a href="#dom-canvas-todataurl">toDataURL()</a></code> method) must be rendered with no color
  correction.</p>

  </div>


  <h5 id="serializing-bitmaps-to-a-file"><span class="secno">4.11.4.2 </span>ビットマップをファイルにシリアライズする</h5>

  <div class="impl">

  <p>When a user agent is to create <dfn id="a-serialization-of-the-bitmap-as-a-file">a serialization of the bitmap as a file</dfn>, optionally
  with some given <var data-anolis-xref="">arguments</var>,
  it must create an image file in the format given by the first value of <var data-anolis-xref="">arguments</var>, or, if there are no <var data-anolis-xref="">arguments</var>, in the PNG format. <a href="references.html#refsPNG">[PNG]</a></p>

  <p>If if the bitmap has one pixel per coordinate
  space unit then the image file must have the same pixel data (before compression, if applicable)
  as the bitmap, and if the file format used supports encoding resolution metadata, the resolution
  of that bitmap (device pixels per coordinate space units being interpreted as image pixels per CSS
  pixel) must be given as well.</p>

  <p>Otherwise, the image file's pixel data must be the bitmap's pixel data scaled to one image
  pixel per coordinate space unit, and if the file format used supports encoding resolution
  metadata, the resolution must be given as 96dpi (one image pixel per CSS pixel).</p>

  <p>If <var data-anolis-xref="">arguments</var> is not empty, the first value must be interpreted as a <a data-anolis-xref="MIME type" href="infrastructure.html#mime-type">MIME type</a> giving the format to use. If the type has any parameters, it
  must be treated as not supported.</p>

  <p class="example">For example, the value "<code>image/png</code>" would mean to generate a PNG
  image, the value "<code>image/jpeg</code>" would mean to generate a JPEG image, and the value
  "<code>image/svg+xml</code>" would mean to generate an SVG image (which would require that the
  user agent track how the bitmap was generated, an unlikely, though potentially awesome,
  feature).</p>

  <p>User agents must support PNG ("<code>image/png</code>"). User agents may support other types.
  If the user agent does not support the requested type, it must create the file using the PNG
  format. <a href="references.html#refsPNG">[PNG]</a></p>

  <p>User agents must <a data-anolis-xref="converted to ASCII lowercase" href="infrastructure.html#converted-to-ascii-lowercase">convert the provided type to ASCII
  lowercase</a> before establishing if they support that type.</p>

  <p>For image types that do not support an alpha channel, the serialized image must be the bitmap
  image composited onto a solid black background using the source-over operator.</p>

  <p>If the first argument in <var data-anolis-xref="">arguments</var> gives a type corresponding to one of the
  types given in the first column of the following table, and the user agent supports that type,
  then the subsequent arguments, if any, must be treated as described in the second cell of that
  row.</p>

  </div>

  <table id="canvas-serialization-arguments"><caption>シリアル化メソッドの引数</caption>
   <thead><tr><th> 型 </th><th> 他の引数 </th><th> 参照
   <tbody></th></tr><tr><td> <code>image/jpeg</code>
     </td><td>  The second argument<span class="impl">, if it</span> is a number in the range 0.0 to 1.0
     inclusive<span class="impl">, must be</span> treated as the desired quality level. <span class="impl">If it is not a number or is outside that range, the user agent must use its
     default value, as if the argument had been omitted.</span>
     </td><td> <a href="references.html#refsJPEG">[JPEG]</a>
  </td></tr></table><div class="impl">

  <p>For the purposes of these rules, an argument is considered to be a number if it is converted to
  an IDL double value by the rules for handling arguments of type <code data-anolis-xref="">any</code> in the
  Web IDL specification. <a href="references.html#refsWEBIDL">[WEBIDL]</a></p>

  <p>Other arguments must be ignored and must not cause the user agent to throw an exception. A
  future version of this specification will probably define other parameters to be passed to these
  methods to allow authors to more carefully control compression settings, image metadata, etc.</p>

  </div><!--ADD-TOPIC:Security-->



  <div class="impl">

  <h5 id="security-with-canvas-elements"><span class="secno">4.11.4.3 </span>Security with <code><a href="#the-canvas-element">canvas</a></code> elements</h5>

  <p><i>この節は非規範的である。</i></p>
  <p><strong>Information leakage</strong> can occur if scripts from one <a href="browsers.html#origin-0">origin</a> can
  access information (e.g. read pixels) from images from another origin (one that isn't the <a data-anolis-xref="same origin" href="browsers.html#same-origin">same</a>).</p>

  <p>To mitigate this, bitmaps used with <code><a href="#the-canvas-element">canvas</a></code> elements are defined to have a flag
  indicating whether they are <a data-anolis-xref="concept-canvas-origin-clean" href="#concept-canvas-origin-clean">origin-clean</a>. All
  bitmaps start with their <a data-anolis-xref="concept-canvas-origin-clean" href="#concept-canvas-origin-clean">origin-clean</a> set to
  true. The flag is set to false when cross-origin images or fonts are used.</p>

  <p>The <code data-anolis-xref="dom-canvas-toDataURL"><a href="#dom-canvas-todataurl">toDataURL()</a></code>, <code data-anolis-xref="dom-canvas-toBlob"><a href="#dom-canvas-toblob">toBlob()</a></code>, <code data-anolis-xref="dom-context-2d-getImageData">getImageData()</code>, and <code data-anolis-xref="dom-context-2d-getImageDataHD">getImageDataHD()</code> methods check the flag and will
  throw a <code><a href="infrastructure.html#securityerror">SecurityError</a></code> exception rather than leak cross-origin data.</p>

  <p>The flag can be reset in certain situations; for example, when a
  <code>CanvasRenderingContext2D</code> is bound to a new <code><a href="#the-canvas-element">canvas</a></code>, the bitmap is cleared
  and its flag reset.</p>

  </div><!--REMOVE-TOPIC:Security-->



  </body></html>