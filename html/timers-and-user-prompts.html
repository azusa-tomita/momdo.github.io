<!DOCTYPE html><html class=split lang=ja>
<script src=/link-fixup.js defer=""></script><meta charset=utf-8><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name=viewport>
<title>HTML Standard 日本語訳</title><meta content=#3c790a name=theme-color><link rel=stylesheet href=https://resources.whatwg.org/spec.css><link rel=stylesheet href=https://resources.whatwg.org/standard.css><link href=https://resources.whatwg.org/logo.svg rel=icon>
<script>
   function toggleStatus(div) {
     div.parentNode.classList.toggle('wrapped');
   }
  </script>
<style>
   .status { min-height: 0.6em; font: 1em sans-serif; width: 9em; padding: 0.3em; position: absolute; z-index: 8; right: 0.3em; background: #EEE; color: black; box-shadow: 0 0 3px #999; overflow: hidden; margin: -2em 0 0 0; border-collapse: initial; border-spacing: initial; }
   .status:hover { z-index: 9; }
   .status:focus-within { z-index: 9; }
   .status.wrapped > :not(input) { display: none; }
   .status > input { position: absolute; left: 0; top: 0; width: 1em; height: 1em; border: none; background: transparent; padding: 0; margin: 0; }
   .status > p { font-size: 0.6em; margin: 0; padding: 0; }
   .status > p + p { padding-top: 0.5em; }
   .status > p > strong { margin-left: 1.5em; }
   .status > .support { display: block; }
   .status > .support > span { padding: 0.2em 0; display: block; display: table; }
   .status > .support > span.partial { color: #666666; filter: grayscale(50%); }
   .status > .support > span.no { color: #CCCCCC; filter: grayscale(100%); }
   .status > .support > span.no::before { opacity: 0.5; }
   .status > .support > span:first-of-type { padding-top: 0.5em; }
   .status > .support > span > span { padding: 0 0.5em; display: table-cell; vertical-align: top; }
   .status > .support > span > span:first-child { width: 100%; }
   .status > .support > span > span:last-child { width: 100%; white-space: pre; padding: 0; }
   .status > .support > span::before { content: ' '; display: table-cell; min-width: 1.5em; height: 1.5em; background: no-repeat center center; background-size: contain; text-align: right; font-size: 0.75em; font-weight: bold; }
   .status > .support > .and_chr::before { background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg); }
   .status > .support > .and_ff::before { background-image: url(https://resources.whatwg.org/browser-logos/firefox.png); }
   .status > .support > .and_uc::before { background-image: url(https://resources.whatwg.org/browser-logos/uc.png); } /* UC Browser for Android */
   .status > .support > .android::before { background-image: url(https://resources.whatwg.org/browser-logos/android.svg); }
   .status > .support > .bb::before { background-image: url(https://resources.whatwg.org/browser-logos/bb.jpg); } /* Blackberry Browser */
   .status > .support > .chrome::before { background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg); }
   .status > .support > .edge::before { background-image: url(https://resources.whatwg.org/browser-logos/edge.svg); }
   .status > .support > .firefox::before { background-image: url(https://resources.whatwg.org/browser-logos/firefox.png); }
   .status > .support > .ie::before { background-image: url(https://resources.whatwg.org/browser-logos/ie.png); }
   .status > .support > .ie_mob::before { background-image: url(https://resources.whatwg.org/browser-logos/ie-mobile.svg); }
   .status > .support > .ios_saf::before { background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg); }
   .status > .support > .op_mini::before { background-image: url(https://resources.whatwg.org/browser-logos/opera-mini.png); }
   .status > .support > .op_mob::before { background-image: url(https://resources.whatwg.org/browser-logos/opera.png); }
   .status > .support > .opera::before { background-image: url(https://resources.whatwg.org/browser-logos/opera.png); }
   .status > .support > .safari::before { background-image: url(https://resources.whatwg.org/browser-logos/safari.png); }
   .status > .support > .samsung::before { background-image: url(https://resources.whatwg.org/browser-logos/samsung.png); }
   .status > .caniuse { text-align: right; font-style: italic; width: 100%; }
   .status > .caniuse + p { margin-top: 0.5em; border-top: 1px solid silver; }

   @media (max-width: 767px) {
     .status { right: -9em; }
   }
  </style>
<style>
   .bad, .bad *:not(.X\58X) { color: gray; }

   .fingerprint { position: absolute; right: 0; z-index: 5; }
   @media (max-width: 767px) {
     .fingerprint { max-width: 35px; }
   }

   .applies .yes, .yesno .yes { background: yellow; }
   .yesno .yes, .yesno .no { text-align: center; }

   .applies thead th > * { display: block; }
   .applies thead code { display: block; }
   .applies td { text-align: center; }

   .matrix, .matrix td { border: hidden; text-align: right; }
   .matrix { margin-left: 2em; }

   .vertical-summary-table tr > th[rowspan="2"]:first-child + th,
   .vertical-summary-table tr > td[rowspan="2"]:first-child + td { border-bottom: hidden; }

   .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
   .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
   .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

   td.eg { border-width: thin; text-align: center; }

   #table-example-1 { border: solid thin; border-collapse: collapse; margin-left: 3em; }
   #table-example-1 caption { padding-bottom: 0.5em; }
   #table-example-1 thead, #table-example-1 tbody { border: none; }
   #table-example-1 th, #table-example-1 td { border: solid thin; }
   #table-example-1 th { font-weight: normal; }
   #table-example-1 td { border-style: none solid; vertical-align: top; }
   #table-example-1 th { padding: 0.5em; vertical-align: middle; text-align: center; }
   #table-example-1 tbody tr:first-child td { padding-top: 0.5em; }
   #table-example-1 tbody tr:last-child td { padding-bottom: 1.5em; }
   #table-example-1 tbody td:first-child { padding-left: 2.5em; padding-right: 0; width: 9em; }
   #table-example-1 tbody td:first-child::after { content: leader(". "); }
   #table-example-1 tbody td { padding-left: 2em; padding-right: 2em; }
   #table-example-1 tbody td:first-child + td { width: 10em; }
   #table-example-1 tbody td:first-child + td ~ td { width: 2.5em; }
   #table-example-1 tbody td:first-child + td + td + td ~ td { width: 1.25em; }

   .apple-table-examples { border: none; border-collapse: separate; border-spacing: 1.5em 0em; width: 40em; margin-left: 3em; }
   .apple-table-examples * { font-family: "Times", serif; }
   .apple-table-examples td, .apple-table-examples th { border: none; white-space: nowrap; padding-top: 0; padding-bottom: 0; }
   .apple-table-examples tbody th:first-child { border-left: none; width: 100%; }
   .apple-table-examples thead th:first-child ~ th { font-size: smaller; font-weight: bolder; border-bottom: solid 2px; text-align: center; }
   .apple-table-examples tbody th::after, .apple-table-examples tfoot th::after { content: leader(". ") }
   .apple-table-examples tbody th, .apple-table-examples tfoot th { font: inherit; text-align: left; }
   .apple-table-examples td { text-align: right; vertical-align: top; }
   .apple-table-examples.e1 tbody tr:last-child td { border-bottom: solid 1px; }
   .apple-table-examples.e1 tbody + tbody tr:last-child td { border-bottom: double 3px; }
   .apple-table-examples.e2 th[scope=row] { padding-left: 1em; }
   .apple-table-examples sup { line-height: 0; }

   .three-column-nowrap tr > td:first-child,
   .three-column-nowrap tr > td:first-child + td,
   .three-column-nowrap tr > td:first-child + td + td { white-space: nowrap; }

   .details-example img { vertical-align: top; }

   .parse-error-table td > p:first-child { margin-top: 0; }

   #named-character-references-table {
     white-space: nowrap;
     font-size: 0.6em;
     column-width: 30em;
     column-gap: 1em;
     -moz-column-width: 30em;
     -moz-column-gap: 1em;
     -webkit-column-width: 30em;
     -webkit-column-gap: 1em;
   }
   #named-character-references-table > table > tbody > tr > td:first-child + td,
   #named-character-references-table > table > tbody > tr > td:last-child { text-align: center; }
   #named-character-references-table > table > tbody > tr > td:last-child:hover > span { position: absolute; top: auto; left: auto; margin-left: 0.5em; line-height: 1.2; font-size: 5em; border: outset; padding: 0.25em 0.5em; background: white; width: 1.25em; height: auto; text-align: center; }
   #named-character-references-table > table > tbody > tr#entity-CounterClockwiseContourIntegral > td:first-child { font-size: 0.5em; }

   .glyph.control { color: red; }

   #table-example-1 * { font-family: "Essays1743", serif; line-height: 1.01em; }
   @font-face {
     font-family: 'Essays1743';
     src: url('/fonts/Essays1743.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-weight: bold;
     src: url('/fonts/Essays1743-Bold.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-style: italic;
     src: url('/fonts/Essays1743-Italic.ttf');
   }
   @font-face {
     font-family: 'Essays1743';
     font-style: italic;
     font-weight: bold;
     src: url('/fonts/Essays1743-BoldItalic.ttf');
   }

   @media (max-width: 767px) {
     #abstractimg { width: 100%; }
   }
   #abstractimg, #abstractimg text { font: inherit; }
   #abstractimg rect { fill: #424242; }
   #abstractimg text { fill: #ffffff; font-size: 18px }
   #abstractimg .top { word-spacing: 50px; text-anchor: middle; }
   #abstractimg .left, #abstractimg .bottom { word-spacing: 12px; }
   #abstractimg .right { font-size: 25px; }
  </style>
<body>
  
  <script src=/html-dfn.js async=""></script>
  <script data-file-issue-url=https://github.com/whatwg/html/issues/new async="" src=https://resources.whatwg.org/file-issue.js></script>
  <header id=head class="head with-buttons">
   <a href=https://whatwg.org/ class=logo><img alt=WHATWG src=https://resources.whatwg.org/logo.svg width=100 height=100></a>
   <hgroup><h1 class=allcaps>HTML</h1><h2 id=living-standard class="no-num no-toc">Living Standard — Last Updated <span class=pubdate>19 September 2018</span></h2></hgroup>
   
   

   
  </header>

  

  

  

  
  

  
  

  

  <nav><a href=dynamic-markup-insertion.html>← 8.4 Dynamic markup insertion</a> — <a href=./>Table of Contents</a> — <a href=system-state.html>8.8 System state and capabilities →</a></nav><ol class=toc><li id=toc-webappapis><ol><li><a href=timers-and-user-prompts.html#timers><span class=secno>8.5</span> タイマー</a></li><li><a href=timers-and-user-prompts.html#microtask-queuing><span class=secno>8.6</span> Microtask queuing</a></li><li><a href=timers-and-user-prompts.html#user-prompts><span class=secno>8.7</span> User prompts</a><ol><li><a href=timers-and-user-prompts.html#simple-dialogs><span class=secno>8.7.1</span> Simple dialogs</a></li><li><a href=timers-and-user-prompts.html#printing><span class=secno>8.7.2</span> Printing</a></li></ol></li></ol></li></ol><h3 id=timers><span class=secno>8.5</span> タイマー<a href=#timers class=self-link></a></h3>

  <p><code id=timers:dom-settimeout><a href=#dom-settimeout>setTimeout()</a></code>と<code id=timers:dom-setinterval><a href=#dom-setinterval>setInterval()</a></code>メソッドは、著者がタイマーベースのコールバックをスケジュールできるようにする。</p>

  <dl class=domintro><dt><var>handle</var> = self . <code id=dom-settimeout-dev><a href=#dom-settimeout>setTimeout</a></code>( <var>handler</var> [, <var>timeout</var> [, <var>arguments</var>... ] ] )<dd>

    <p><var>timeout</var>ミリ秒後に<var>handler</var>を実行するためにタイムアウトをスケジュールする。すべての<var>arguments</var>は直接<var>handler</var>に渡される。</p>

   <dt><var>handle</var> = self . <code id=timers:dom-settimeout-2><a href=#dom-settimeout>setTimeout</a></code>( <var>code</var> [, <var>timeout</var> ] )<dd>

    <p><var>timeout</var>ミリ秒後に<var>code</var>を実行するためにタイムアウトをスケジュールする。</p>

   <dt>self . <code id=dom-cleartimeout-dev><a href=#dom-cleartimeout>clearTimeout</a></code>( <var>handle</var> )<dd>

    <p>Cancels the timeout set with <code id=timers:dom-settimeout-3><a href=#dom-settimeout>setTimeout()</a></code> or <code id=timers:dom-setinterval-2><a href=#dom-setinterval>setInterval()</a></code> identified by <var>handle</var>.</p>

   <dt><var>handle</var> = self . <code id=dom-setinterval-dev><a href=#dom-setinterval>setInterval</a></code>( <var>handler</var> [, <var>timeout</var> [, <var>arguments</var>... ] ] )<dd>

    <p><var>timeout</var>ミリ秒ごとに<var>handler</var>を実行するためにタイムアウトをスケジュールする。すべての<var>arguments</var>は直接<var>handler</var>に渡される。</p>

   <dt><var>handle</var> = self . <code id=timers:dom-setinterval-3><a href=#dom-setinterval>setInterval</a></code>( <var>code</var> [, <var>timeout</var> ] )<dd>

    <p><var>timeout</var>ミリ秒ごとに<var>code</var>を実行するためにタイムアウトをスケジュールする。</p>

   <dt>self . <code id=dom-clearinterval-dev><a href=#dom-clearinterval>clearInterval</a></code>( <var>handle</var> )<dd>

    <p>Cancels the timeout set with <code id=timers:dom-setinterval-4><a href=#dom-setinterval>setInterval()</a></code> or <code id=timers:dom-settimeout-4><a href=#dom-settimeout>setTimeout()</a></code> identified by <var>handle</var>.</p>

   </dl>

  <p class=note>タイマーは入れ子にすることができる。しかし、5つのそのようなネストされたタイマー後に、間隔は少なくとも4ミリ秒であることが強制される。</p>

  <p class=note>このAPIは、タイマーがスケジュールどおり正確に動作することを保証しない。CPU負荷やその他のタスクなどによる遅延が予想される。</p>

  

  <p>Objects that implement the <code id=timers:windoworworkerglobalscope><a href=webappapis.html#windoworworkerglobalscope>WindowOrWorkerGlobalScope</a></code> mixin have a <dfn id=list-of-active-timers data-export="">list of active timers</dfn>. Each entry in this lists is identified by a number,
  which must be unique within the list for the lifetime of the object that implements the
  <code id=timers:windoworworkerglobalscope-2><a href=webappapis.html#windoworworkerglobalscope>WindowOrWorkerGlobalScope</a></code> mixin.</p>

  <hr>

  <p>The <dfn id=dom-settimeout><code id=dom-windowtimers-setTimeout>setTimeout()</code></dfn> method must return the value returned
  by the <a href=#timer-initialisation-steps id=timers:timer-initialisation-steps>timer initialization steps</a>, passing them the method's arguments, the object on
  which the method for which the algorithm is running is implemented (a <code id=timers:window><a href=window-object.html#window>Window</a></code> or
  <code id=timers:workerglobalscope><a href=workers.html#workerglobalscope>WorkerGlobalScope</a></code> object) as the <var>method context</var>, and the <var>repeat</var>
  flag set to false.</p>

  <p>The <dfn id=dom-setinterval><code id=dom-windowtimers-setInterval>setInterval()</code></dfn> method must return the value returned
  by the <a href=#timer-initialisation-steps id=timers:timer-initialisation-steps-2>timer initialization steps</a>, passing them the method's arguments, the object on
  which the method for which the algorithm is running is implemented (a <code id=timers:window-2><a href=window-object.html#window>Window</a></code> or
  <code id=timers:workerglobalscope-2><a href=workers.html#workerglobalscope>WorkerGlobalScope</a></code> object) as the <var>method context</var>, and the <var>repeat</var>
  flag set to true.</p>

  <p>The <dfn id=dom-cleartimeout><code id=dom-windowtimers-clearTimeout>clearTimeout()</code></dfn> and <dfn id=dom-clearinterval><code id=dom-windowtimers-clearInterval>clearInterval()</code></dfn>
  methods must clear the entry identified as <var>handle</var> from the <a href=#list-of-active-timers id=timers:list-of-active-timers>list of active
  timers</a> of the <code id=timers:windoworworkerglobalscope-3><a href=webappapis.html#windoworworkerglobalscope>WindowOrWorkerGlobalScope</a></code> object on which the method was
  invoked, if any, where <var>handle</var> is the argument passed to the method. (If
  <var>handle</var> does not identify an entry in the <a href=#list-of-active-timers id=timers:list-of-active-timers-2>list of active timers</a> of the
  <code id=timers:windoworworkerglobalscope-4><a href=webappapis.html#windoworworkerglobalscope>WindowOrWorkerGlobalScope</a></code> object on which the method was invoked, the method does
  nothing.)</p>

  <p class=note>Because <code id=timers:dom-cleartimeout><a href=#dom-cleartimeout>clearTimeout()</a></code> and <code id=timers:dom-clearinterval><a href=#dom-clearinterval>clearInterval()</a></code> clear entries from the same list, either method
  can be used to clear timers created by <code id=timers:dom-settimeout-5><a href=#dom-settimeout>setTimeout()</a></code> or <code id=timers:dom-setinterval-5><a href=#dom-setinterval>setInterval()</a></code>.</p>

  <hr>

  <p>The <dfn id=timer-initialisation-steps>timer initialization steps</dfn>, which
  are invoked with some method arguments, a <var>method context</var>, a <var>repeat</var> flag
  which can be true or false, and optionally (and only if the <var>repeat</var> flag is true) a
  <var>previous handle</var>, are as follows:</p>

  <ol><li><p>Let <var>method context proxy</var> be <var>method context</var> if that
   is a <code id=timers:workerglobalscope-3><a href=workers.html#workerglobalscope>WorkerGlobalScope</a></code> object, or else the <code id=timers:windowproxy><a href=window-object.html#windowproxy>WindowProxy</a></code> that corresponds
   to <var>method context</var>.</li><li><p>If <var>previous handle</var> was provided, let <var>handle</var> be
   <var>previous handle</var>; otherwise, let <var>handle</var> be a
   user-agent-defined integer that is greater than zero that will identify the timeout to be set by
   this call in the <a href=#list-of-active-timers id=timers:list-of-active-timers-3>list of active timers</a>.</li><li><p>If <var>previous handle</var> was not provided, add an entry to the <a href=#list-of-active-timers id=timers:list-of-active-timers-4>list of
   active timers</a> for <var>handle</var>.</li><li><p>Let <var>callerRealm</var> be the <a id=timers:current-realm-record href=https://tc39.github.io/ecma262/#current-realm data-x-internal=current-realm-record>current Realm Record</a>, and
   <var>calleeRealm</var> be <var>method context</var>'s <a id=timers:javascript-realm href=https://tc39.github.io/ecma262/#sec-code-realms data-x-internal=javascript-realm>JavaScript realm</a>.</li><li><p>Let <var>initiating script</var> be the <a id=timers:active-script href=webappapis.html#active-script>active script</a>.</li><li><p>Assert: <var>initiating script</var> is not null, since this algorithm is always called
   from some script.</li><li>

    <p>Let <var>task</var> be a <a href=webappapis.html#concept-task id=timers:concept-task>task</a> that runs the
    following substeps:</p>

    <ol><li><p>If the entry for <var>handle</var> in the <a href=#list-of-active-timers id=timers:list-of-active-timers-5>list of active timers</a> has been
     cleared, then abort these steps.</li><li>

      <p>Run the appropriate set of steps from the following list:</p>

      <dl class=switch><dt>If the first method argument is a <code id=timers:idl-function><a data-x-internal=idl-function href=https://triple-underscore.github.io/WebIDL-ja.html#common-Function>Function</a></code><dd>

        <p><a href=https://heycam.github.io/webidl/#invoke-a-callback-function id=timers:es-invoking-callback-functions data-x-internal=es-invoking-callback-functions>Invoke</a> the <code id=timers:idl-function-2><a data-x-internal=idl-function href=https://triple-underscore.github.io/WebIDL-ja.html#common-Function>Function</a></code>. Use the third and subsequent method
        arguments (if any) as the arguments for invoking the <code id=timers:idl-function-3><a data-x-internal=idl-function href=https://triple-underscore.github.io/WebIDL-ja.html#common-Function>Function</a></code>. Use <var>method context proxy</var> as the
        <a href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-callback-this-value id=timers:dfn-callback-this-value data-x-internal=dfn-callback-this-value>callback this value</a>.</p>

       <dt>そうでなければ<dd>

        <ol><li><p>Perform <a href=webappapis.html#hostensurecancompilestrings(callerrealm,-calleerealm) id=timers:hostensurecancompilestrings(callerrealm,-calleerealm)>HostEnsureCanCompileStrings</a>(<var>callerRealm</var>,
         <var>calleeRealm</var>). If this throws an exception, catch it, <a id=timers:report-the-exception href=webappapis.html#report-the-exception>report the
         exception</a>, and abort these steps.</li><li><p>Let <var>script source</var> be the first method argument.</li><li><p>Let <var>settings object</var> be <var>method context</var>'s <a id=timers:environment-settings-object href=webappapis.html#environment-settings-object>environment
         settings object</a>.</li><li><p>Let <var>base URL</var> be <var>initiating script</var>'s <a href=webappapis.html#concept-script-base-url id=timers:concept-script-base-url>base URL</a>.</li><li>
          <p>Let <var>fetch options</var> be a <a id=timers:script-fetch-options href=webappapis.html#script-fetch-options>script fetch options</a> whose <a href=webappapis.html#concept-script-fetch-options-nonce id=timers:concept-script-fetch-options-nonce>cryptographic nonce</a> is <var>initiating
          script</var>'s <a href=webappapis.html#concept-script-script-fetch-options id=timers:concept-script-script-fetch-options>fetch options</a>'s
          <a href=webappapis.html#concept-script-fetch-options-nonce id=timers:concept-script-fetch-options-nonce-2>cryptographic nonce</a>, <a href=webappapis.html#concept-script-fetch-options-integrity id=timers:concept-script-fetch-options-integrity>integrity metadata</a> is the empty
          string, <a href=webappapis.html#concept-script-fetch-options-parser id=timers:concept-script-fetch-options-parser>parser metadata</a> is
          "<code>not-parser-inserted</code>", <a href=webappapis.html#concept-script-fetch-options-credentials id=timers:concept-script-fetch-options-credentials>credentials mode</a> is
          <var>initiating script</var>'s <a href=webappapis.html#concept-script-script-fetch-options id=timers:concept-script-script-fetch-options-2>fetch
          options</a>'s <a href=webappapis.html#concept-script-fetch-options-credentials id=timers:concept-script-fetch-options-credentials-2>credentials
          mode</a>, and <a href=webappapis.html#concept-script-fetch-options-referrer-policy id=timers:concept-script-fetch-options-referrer-policy>referrer
          policy</a> is <var>initiating script</var>'s <a href=webappapis.html#concept-script-script-fetch-options id=timers:concept-script-script-fetch-options-3>fetch options</a>'s <a href=webappapis.html#concept-script-fetch-options-referrer-policy id=timers:concept-script-fetch-options-referrer-policy-2>referrer policy</a>.</p>

          <p class=note>The effect of these options ensures that the string compilation done by
          <code id=timers:dom-settimeout-6><a href=#dom-settimeout>setTimeout()</a></code> and <code id=timers:dom-setinterval-6><a href=#dom-setinterval>setInterval()</a></code> behaves equivalently to that done by
          <code id=timers:eval()><a data-x-internal=eval() href=https://tc39.github.io/ecma262/#sec-eval-x>eval()</a></code>. That is, <a id=timers:module-script href=webappapis.html#module-script>module script</a> fetches via <code id=timers:import()><a data-x-internal=import() href=https://tc39.github.io/proposal-dynamic-import/#sec-import-calls>import()</a></code>
          will behave the same in both contexts.</p>
         </li><li><p>Let <var>script</var> be the result of <a id=timers:creating-a-classic-script href=webappapis.html#creating-a-classic-script>creating a classic script</a> given
         <var>script source</var>, <var>settings object</var>, <var>base URL</var>, and <var>fetch
         options</var>.</li><li><p><a href=webappapis.html#run-a-classic-script id=timers:run-a-classic-script>Run the classic script</a>
         <var>script</var>.</li></ol>

       </dl>

     </li><li><p>If the <var>repeat</var> flag is true, then call <a href=#timer-initialisation-steps id=timers:timer-initialisation-steps-3>timer initialization
     steps</a> again, passing them the same method arguments, the same <var>method
     context</var>, with the <var>repeat</var> flag still set to true, and with the <var>previous handle</var> set to <var>handler</var>.</li></ol>

   </li><li><p>Let <var>timeout</var> be the second method argument.</li><li>
    <p>If the currently running <a href=webappapis.html#concept-task id=timers:concept-task-2>task</a> is a task that was created
    by this algorithm, then let <var>nesting level</var> be the <a href=webappapis.html#concept-task id=timers:concept-task-3>task</a>'s <a href=#timer-nesting-level id=timers:timer-nesting-level>timer nesting level</a>. Otherwise, let
    <var>nesting level</var> be zero.</p>

    <p class=note>The task's <a href=#timer-nesting-level id=timers:timer-nesting-level-2>timer nesting level</a> is used both for nested calls to
    <code id=timers:dom-settimeout-7><a href=#dom-settimeout>setTimeout()</a></code>, and for the repeating timers created by <code id=timers:dom-setinterval-7><a href=#dom-setinterval>setInterval()</a></code>. (Or, indeed, for any combination of the two.) In
    other words, it represents nested invocations of this algorithm, not of a particular method.</p>
   </li><li><p>If <var>timeout</var> is less than 0, then set <var>timeout</var> to 0.</li><li><p>If <var>nesting level</var> is greater than 5, and <var>timeout</var> is less than 4, then
   set <var>timeout</var> to 4.</li><li><p>Increment <var>nesting level</var> by one.</li><li><p>Let <var>task</var>'s <dfn id=timer-nesting-level>timer nesting level</dfn> be <var>nesting
   level</var>.</li><li><p>Return <var>handle</var>, and then continue running this algorithm
   <a id=timers:in-parallel href=infrastructure.html#in-parallel>in parallel</a>.</li><li>

    <p>If <var>method context</var> is a <code id=timers:window-3><a href=window-object.html#window>Window</a></code> object, wait until the
    <code id=timers:document><a href=dom.html#document>Document</a></code> associated with <var>method context</var> has been <a id=timers:fully-active href=browsers.html#fully-active>fully
    active</a> for a further <var>timeout</var> milliseconds (not necessarily
    consecutively).</p>

    <p>Otherwise, <var>method context</var> is a <code id=timers:workerglobalscope-4><a href=workers.html#workerglobalscope>WorkerGlobalScope</a></code> object;
    wait until <var>timeout</var> milliseconds have passed with the worker not suspended
    (not necessarily consecutively).</p>

   </li><li>

    <p>Wait until any invocations of this algorithm that had the same <var>method
    context</var>, that started before this one, and whose <var>timeout</var> is equal to
    or less than this one's, have completed.</p>

    <p class=note>Argument conversion as defined by Web IDL (for example, invoking <code>toString()</code> methods on objects passed as the first argument) happens in the
    algorithms defined in Web IDL, before this algorithm is invoked.</p>

    <div class=example>

     <p>So for example, the following rather silly code will result in the log containing "<code>ONE&nbsp;TWO&nbsp;</code>":</p>

     <pre><code class='js'><c- a>var</c-> log <c- o>=</c-> <c- t>''</c-><c- p>;</c->
<c- a>function</c-> logger<c- p>(</c->s<c- p>)</c-> <c- p>{</c-> log <c- o>+=</c-> s <c- o>+</c-> <c- t>' '</c-><c- p>;</c-> <c- p>}</c->

setTimeout<c- p>({</c-> toString<c- o>:</c-> <c- a>function</c-> <c- p>()</c-> <c- p>{</c->
  setTimeout<c- p>(</c-><c- u>"logger('ONE')"</c-><c- p>,</c-> <c- mi>100</c-><c- p>);</c->
  <c- k>return</c-> <c- u>"logger('TWO')"</c-><c- p>;</c->
<c- p>}</c-> <c- p>},</c-> <c- mi>100</c-><c- p>);</c-></code></pre>

    </div>

   </li><li>

    <p>Optionally, wait a further user-agent defined length of time.</p>

    <p class=note>This is intended to allow user agents to pad timeouts as needed to optimize the
    power usage of the device. For example, some processors have a low-power mode where the
    granularity of timers is reduced; on such platforms, user agents can slow timers down to fit
    this schedule instead of requiring the processor to use the more accurate mode with its
    associated higher power usage.</p>

   </li><li>

    <p><a href=webappapis.html#queue-a-task id=timers:queue-a-task>Queue</a> the <a href=webappapis.html#concept-task id=timers:concept-task-4>task</a> <var>task</var>.</p>

    <p class=note>Once the task has been processed, if the <var>repeat</var> flag is
    false, it is safe to remove the entry for <var>handle</var> from the <a href=#list-of-active-timers id=timers:list-of-active-timers-6>list of
    active timers</a> (there is no way for the entry's existence to be detected past this point,
    so it does not technically matter one way or the other).</p>

   </li></ol>

  <p>The <a id=timers:task-source href=webappapis.html#task-source>task source</a> for these <a href=webappapis.html#concept-task id=timers:concept-task-5>tasks</a> is the
  <dfn id=timer-task-source>timer task source</dfn>.</p>

  

  <div class=example>

   <p>遅延なく背中合わせに数ミリ秒のタスクを実行するために、飢えたユーザーインターフェイスを避けるために（およびCPUを占有するためのスクリプトを殺すブラウザーを避けるために）ブラウザーに戻って従いつつ、作業を実行する前の簡単なキューの次のタイマー：</p>

   <pre><code class='js'><c- a>function</c-> doExpensiveWork<c- p>()</c-> <c- p>{</c->
  <c- a>var</c-> done <c- o>=</c-> <c- kc>false</c-><c- p>;</c->
  <c- c1>// ...</c->
  <c- c1>// this part of the function takes up to five milliseconds</c->
  <c- c1>// set done to true if we're done</c->
  <c- c1>// ...</c->
  <c- k>return</c-> done<c- p>;</c->
<c- p>}</c->

<c- a>function</c-> rescheduleWork<c- p>()</c-> <c- p>{</c->
  <c- a>var</c-> handle <c- o>=</c-> setTimeout<c- p>(</c->rescheduleWork<c- p>,</c-> <c- mi>0</c-><c- p>);</c-> <c- c1>// preschedule next iteration</c->
  <c- k>if</c-> <c- p>(</c->doExpensiveWork<c- p>())</c->
    clearTimeout<c- p>(</c->handle<c- p>);</c-> <c- c1>// clear the timeout if we don't need it</c->
<c- p>}</c->

<c- a>function</c-> scheduleWork<c- p>()</c-> <c- p>{</c->
  setTimeout<c- p>(</c->rescheduleWork<c- p>,</c-> <c- mi>0</c-><c- p>);</c->
<c- p>}</c->

scheduleWork<c- p>();</c-> <c- c1>// queues a task to do lots of work</c-></code></pre>

  </div>


  <h3 id=microtask-queuing><span class=secno>8.6</span> Microtask queuing<a href=#microtask-queuing class=self-link></a></h3>

  <dl class=domintro><dt><var>self</var> . <code id=dom-queuemicrotask-dev><a href=#dom-queuemicrotask>queueMicrotask</a></code>(<var>callback</var>)<dd><p><a href=webappapis.html#queue-a-microtask id=microtask-queuing:queue-a-microtask>Queues</a> a <a id=microtask-queuing:microtask href=webappapis.html#microtask>microtask</a> to run the given
   <var>callback</var>.</dl>

  <p>The <dfn id=dom-queuemicrotask><code>queueMicrotask(<var>callback</var>)</code></dfn> method must
  <a id=microtask-queuing:queue-a-microtask-2 href=webappapis.html#queue-a-microtask>queue a microtask</a> to <a href=https://heycam.github.io/webidl/#invoke-a-callback-function id=microtask-queuing:es-invoking-callback-functions data-x-internal=es-invoking-callback-functions>invoke</a>
  <var>callback</var>, and if <var>callback</var> throws an exception, <a id=microtask-queuing:report-the-exception href=webappapis.html#report-the-exception>report the
  exception</a>.</p>

  <p>The <code id=microtask-queuing:dom-queuemicrotask><a href=#dom-queuemicrotask>queueMicrotask()</a></code> method allows authors to schedule
  a callback on the <a id=microtask-queuing:microtask-queue href=webappapis.html#microtask-queue>microtask queue</a>. This allows their code to run after the
  currently-executing <a href=webappapis.html#concept-task id=microtask-queuing:concept-task>task</a> has run to completion and the
  <a id=microtask-queuing:javascript-execution-context-stack href=https://tc39.github.io/ecma262/#execution-context-stack data-x-internal=javascript-execution-context-stack>JavaScript execution context stack</a> is empty, but without yielding control back to the
  browser's <a id=microtask-queuing:event-loop href=webappapis.html#event-loop>event loop</a>, as would be the case when using, for example, <code id=microtask-queuing:dom-settimeout><a href=#dom-settimeout>setTimeout(<var>f</var>,&nbsp;0)</a></code>.</p>

  <p>Authors ought to be aware that scheduling a lot of microtasks has the same performance
  downsides as running a lot of synchronous code. Both will prevent the browser from doing its own
  work, such as rendering or scrolling. In many cases, <code id=microtask-queuing:dom-animationframeprovider-requestanimationframe><a href=imagebitmap-and-animations.html#dom-animationframeprovider-requestanimationframe>requestAnimationFrame()</a></code> or
  <code id=microtask-queuing:requestidlecallback()><a data-x-internal=requestidlecallback() href=https://w3c.github.io/requestidlecallback/#the-requestidlecallback-method>requestIdleCallback()</a></code> is a better choice. In particular, if the goal is to run code
  before the next rendering cycle, that is the purpose of <code id=microtask-queuing:dom-animationframeprovider-requestanimationframe-2><a href=imagebitmap-and-animations.html#dom-animationframeprovider-requestanimationframe>requestAnimationFrame()</a></code>.</p>

  <p>As can be seen from the following examples, the best way of thinking about <code id=microtask-queuing:dom-queuemicrotask-2><a href=#dom-queuemicrotask>queueMicrotask()</a></code> is as a mechanism for rearranging synchronous
  code, effectively placing the queued code immediately after the current task's worth of non-queued
  JavaScript.</p>

  <div class=example>
   <p>The most common reason for using <code id=microtask-queuing:dom-queuemicrotask-3><a href=#dom-queuemicrotask>queueMicrotask()</a></code> is
   to create consistent ordering, even in the cases where information is available synchronously,
   without introducing undue delay.</p>

   <p>For example, consider a custom element firing a <code>load</code> event, that also
   maintains an internal cache of previously-loaded data. A naïve implementation might look
   like:</p>

   <pre><code class='js'>MyElement<c- p>.</c->prototype<c- p>.</c->loadData <c- o>=</c-> <c- a>function</c-> <c- p>(</c->url<c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c-><c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>])</c-> <c- p>{</c->
    <c- k>this</c-><c- p>.</c->_setData<c- p>(</c-><c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>]);</c->
    <c- k>this</c-><c- p>.</c->dispatchEvent<c- p>(</c-><c- k>new</c-> Event<c- p>(</c-><c- u>"load"</c-><c- p>));</c->
  <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
    fetch<c- p>(</c->url<c- p>).</c->then<c- p>(</c->res <c- p>=&gt;</c-> res<c- p>.</c->arrayBuffer<c- p>()).</c->then<c- p>(</c->data <c- p>=&gt;</c-> <c- p>{</c->
      <c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>]</c-> <c- o>=</c-> data<c- p>;</c->
      <c- k>this</c-><c- p>.</c->_setData<c- p>(</c->data<c- p>);</c->
      <c- k>this</c-><c- p>.</c->dispatchEvent<c- p>(</c-><c- k>new</c-> Event<c- p>(</c-><c- u>"load"</c-><c- p>));</c->
    <c- p>});</c->
  <c- p>}</c->
<c- p>};</c-></code></pre>

   <p>This naïve implementation is problematic, however, in that it causes its users to
   experience inconsistent behavior. For example, code such as</p>

   <pre><code class='js'>element<c- p>.</c->addEventListener<c- p>(</c-><c- u>"load"</c-><c- p>,</c-> <c- p>()</c-> <c- p>=&gt;</c-> console<c- p>.</c->log<c- p>(</c-><c- u>"loaded"</c-><c- p>));</c->
console<c- p>.</c->log<c- p>(</c-><c- u>"1"</c-><c- p>);</c->
element<c- p>.</c->loadData<c- p>();</c->
console<c- p>.</c->log<c- p>(</c-><c- u>"2"</c-><c- p>);</c-></code></pre>

   <p>will sometimes log "1, 2, loaded" (if the data needs to be fetched), and sometimes log "1,
   loaded, 2" (if the data is already cached). Similarly, after the call to <code>loadData()</code>, it will be inconsistent whether or not the data is set on the
   element.</p>

   <p>To get a consistent ordering, <code id=microtask-queuing:dom-queuemicrotask-4><a href=#dom-queuemicrotask>queueMicrotask()</a></code> can be
   used:</p>

   <pre><code class='js'>MyElement<c- p>.</c->prototype<c- p>.</c->loadData <c- o>=</c-> <c- a>function</c-> <c- p>(</c->url<c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c-><c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>])</c-> <c- p>{</c-><strong>
    queueMicrotask<c- p>(()</c-> <c- p>=&gt;</c-> <c- p>{</c->
      <c- k>this</c-><c- p>.</c->_setData<c- p>(</c-><c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>]);</c->
      <c- k>this</c-><c- p>.</c->dispatchEvent<c- p>(</c-><c- k>new</c-> Event<c- p>(</c-><c- u>"load"</c-><c- p>));</c->
    <c- p>});</c-></strong>
  <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
    fetch<c- p>(</c->url<c- p>).</c->then<c- p>(</c->res <c- p>=&gt;</c-> res<c- p>.</c->arrayBuffer<c- p>()).</c->then<c- p>(</c->data <c- p>=&gt;</c-> <c- p>{</c->
      <c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>]</c-> <c- o>=</c-> data<c- p>;</c->
      <c- k>this</c-><c- p>.</c->_setData<c- p>(</c->data<c- p>);</c->
      <c- k>this</c-><c- p>.</c->dispatchEvent<c- p>(</c-><c- k>new</c-> Event<c- p>(</c-><c- u>"load"</c-><c- p>));</c->
    <c- p>});</c->
  <c- p>}</c->
<c- p>};</c-></code></pre>

   <p>By essentially rearranging the queued code to be after the currently-executing task, this
   ensures a consistent ordering and update of the element's state.</p>
  </div>

  <div class=example>
   <p>Another interesting use of <code id=microtask-queuing:dom-queuemicrotask-5><a href=#dom-queuemicrotask>queueMicrotask()</a></code> is to
   allow uncoordinated "batching" of work by multiple callers. For example, consider a library
   function that wants to send data somewhere as soon as possible, but doesn't want to make multiple
   network requests if doing so is easily avoidable. One way to balance this would be like so:</p>

   <pre><code class='js'><c- kr>const</c-> queuedToSend <c- o>=</c-> <c- p>[];</c->

<c- a>function</c-> sendData<c- p>(</c->data<c- p>)</c-> <c- p>{</c->
  queuedToSend<c- p>.</c->push<c- p>(</c->data<c- p>);</c->

  <c- k>if</c-> <c- p>(</c->queuedToSend<c- p>.</c->length <c- o>===</c-> <c- mi>1</c-><c- p>)</c-> <c- p>{</c->
    queueMicrotask<c- p>(()</c-> <c- p>=&gt;</c-> <c- p>{</c->
      <c- kr>const</c-> stringToSend <c- o>=</c-> JSON<c- p>.</c->stringify<c- p>(</c->queuedToSend<c- p>);</c->
      queuedToSend<c- p>.</c->length <c- o>=</c-> <c- mi>0</c-><c- p>;</c->

      fetch<c- p>(</c-><c- u>"/endpoint"</c-><c- p>,</c-> stringToSend<c- p>);</c->
    <c- p>});</c->
  <c- p>}</c->
<c- p>}</c-></code></pre>

   <p>With this architecture, multiple subsequent calls to <code>sendData()</code> within
   the same turn of the event loop will be batched together into one <code id=microtask-queuing:fetch()><a data-x-internal=fetch() href=https://fetch.spec.whatwg.org/#dom-global-fetch>fetch()</a></code> call, but
   with no intervening event loop tasks preempting the fetch (as would have happened with similar
   code that instead used <code id=microtask-queuing:dom-settimeout-2><a href=#dom-settimeout>setTimeout()</a></code>).</p>
  </div>


  <h3 id=user-prompts><span class=secno>8.7</span> User prompts<a href=#user-prompts class=self-link></a></h3>

  

  <h4 id=simple-dialogs><span class=secno>8.7.1</span> Simple dialogs<a href=#simple-dialogs class=self-link></a></h4>

  <dl class=domintro><dt><var>window</var> . <code id=dom-alert-dev><a href=#dom-alert>alert</a></code>(<var>message</var>)<dd>

    <p>指定されたメッセージを持つモーダルアラートを表示し、それを命令するユーザーに対して待機する。</p>

   <dt><var>result</var> = <var>window</var> . <code id=dom-confirm-dev><a href=#dom-confirm>confirm</a></code>(<var>message</var>)<dd>

    <p>与えられたメッセージとともにモーダルOK/Cancelプロンプトを表示し、それを命令するユーザーに対して待機し、ユーザーがOKをクリックした場合はtrueを返し、ユーザーがCancelをクリックする場合はfalseを返す。</p>

   <dt><var>result</var> = <var>window</var> . <code id=dom-prompt-dev><a href=#dom-prompt>prompt</a></code>(<var>message</var> [, <var>default</var>] )<dd>

    <p>Displays a modal text control prompt with the given message, waits for the user to dismiss it, and returns the value that the user entered. ユーザーがプロンプトをキャンセルした場合、代わりにnullを返す。2番目の引数が存在する場合、指定された値がデフォルトとして使用される。</p>

   </dl>

  <p class=note><a id=simple-dialogs:media-data href=media.html#media-data>メディアデータ</a>を読み込む<a href=media.html#media-element id=simple-dialogs:media-element>メディア要素</a>のような、<a href=webappapis.html#concept-task id=simple-dialogs:concept-task>タスク</a>または<a href=webappapis.html#microtask id=simple-dialogs:microtask>マイクロタスク</a>に依存するロジックは、このメソッドが発動される際に延期される。</p>

  

  <p>To <dfn id=optionally-truncate-a-simple-dialog-string>optionally truncate a simple dialog string</dfn> <var>s</var>, return either
  <var>s</var> itself or some string derived from <var>s</var> that is shorter. User agents should
  not provide UI for displaying the elided portion of <var>s</var>, as this makes it too easy for
  abusers to create dialogs of the form "Important security alert! Click 'Show More' for full
  details!".</p>

  <p class=note>For example, a user agent might want to only display the first 100 characters of a
  message. Or, a user agent might replace the middle of the string with "…". These types of
  modifications can be useful in limiting the abuse potential of unnaturally large,
  trustworthy-looking system dialogs.</p>

  <p>The <dfn id=dom-alert><code>alert(<var>message</var>)</code></dfn> method, when
  invoked, must run the following steps:</p>

  <ol><li><p>If the <a id=simple-dialogs:event-loop href=webappapis.html#event-loop>event loop</a>'s <a id=simple-dialogs:termination-nesting-level href=browsing-the-web.html#termination-nesting-level>termination nesting level</a> is nonzero,
   optionally return.</li><li><p>If the <a id=simple-dialogs:active-sandboxing-flag-set href=origin.html#active-sandboxing-flag-set>active sandboxing flag set</a> of this <code id=simple-dialogs:window><a href=window-object.html#window>Window</a></code> object's <a href=window-object.html#concept-document-window id=simple-dialogs:concept-document-window>associated <code>Document</code></a> has the <a id=simple-dialogs:sandboxed-modals-flag href=origin.html#sandboxed-modals-flag>sandboxed
   modals flag</a> set, then return.</li><li><p>Optionally, return. (For example, the user agent might give the user the option
   to ignore all alerts, and would thus abort at this step whenever the method was
   invoked.)</li><li><p>If the method was invoked with no arguments, then let <var>message</var> be the
   empty string; otherwise, let <var>message</var> be the method's first
   argument.</li><li><p>Set <var>message</var> to the result of <a href=#optionally-truncate-a-simple-dialog-string id=simple-dialogs:optionally-truncate-a-simple-dialog-string>optionally truncating</a> <var>message</var>.</li><li><p>Show <var>message</var> to the user.</li><li><p>Optionally, <a id=simple-dialogs:pause href=webappapis.html#pause>pause</a> while waiting for the user to acknowledge the
   message.</li></ol>

  <p>The <dfn id=dom-confirm><code>confirm(<var>message</var>)</code></dfn> method,
  when invoked, must run the following steps:</p>

  <ol><li><p>If the <a id=simple-dialogs:event-loop-2 href=webappapis.html#event-loop>event loop</a>'s <a id=simple-dialogs:termination-nesting-level-2 href=browsing-the-web.html#termination-nesting-level>termination nesting level</a> is nonzero,
   optionally return false.</li><li><p>If the <a id=simple-dialogs:active-sandboxing-flag-set-2 href=origin.html#active-sandboxing-flag-set>active sandboxing flag set</a> of this <code id=simple-dialogs:window-2><a href=window-object.html#window>Window</a></code> object's <a href=window-object.html#concept-document-window id=simple-dialogs:concept-document-window-2>associated <code>Document</code></a> has the <a id=simple-dialogs:sandboxed-modals-flag-2 href=origin.html#sandboxed-modals-flag>sandboxed
   modals flag</a> set, then return.</li><li><p>Optionally, return false. (For example, the user agent might give
   the user the option to ignore all prompts, and would thus abort at this step whenever the method
   was invoked.)</li><li><p>Set <var>message</var> to the result of <a href=#optionally-truncate-a-simple-dialog-string id=simple-dialogs:optionally-truncate-a-simple-dialog-string-2>optionally truncating</a> <var>message</var>.</li><li><p>Show <var>message</var> to the user, and ask the user to respond with a positive or
   negative response.</li><li><p><a id=simple-dialogs:pause-2 href=webappapis.html#pause>Pause</a> until the user responds either positively or negatively.</li><li><p>If the user responded positively, return true; otherwise, the user responded negatively:
   return false.</li></ol>

  <p>The <dfn id=dom-prompt><code>prompt(<var>message</var>, <var>default</var>)</code></dfn>
  method, when invoked, must run the following steps:</p>

  <ol><li><p>If the <a id=simple-dialogs:event-loop-3 href=webappapis.html#event-loop>event loop</a>'s <a id=simple-dialogs:termination-nesting-level-3 href=browsing-the-web.html#termination-nesting-level>termination nesting level</a> is nonzero,
   optionally return null.</li><li><p>If the <a id=simple-dialogs:active-sandboxing-flag-set-3 href=origin.html#active-sandboxing-flag-set>active sandboxing flag set</a> of this <code id=simple-dialogs:window-3><a href=window-object.html#window>Window</a></code> object's <a href=window-object.html#concept-document-window id=simple-dialogs:concept-document-window-3>associated <code>Document</code></a> has the <a id=simple-dialogs:sandboxed-modals-flag-3 href=origin.html#sandboxed-modals-flag>sandboxed
   modals flag</a> set, then return.</li><li><p>Optionally, return null. (For example, the user agent might give the
   user the option to ignore all prompts, and would thus abort at this step whenever the method was
   invoked.)</li><li><p>Set <var>message</var> to the result of <a href=#optionally-truncate-a-simple-dialog-string id=simple-dialogs:optionally-truncate-a-simple-dialog-string-3>optionally truncating</a> <var>message</var>.</li><li><p>Set <var>default</var> to the result of <a href=#optionally-truncate-a-simple-dialog-string id=simple-dialogs:optionally-truncate-a-simple-dialog-string-4>optionally truncating</a> <var>default</var>.</li><li><p>Show <var>message</var> to the user, and ask the user to either respond with a string
   value or abort. The response must be defaulted to the value given by <var>default</var>.</li><li><p><a id=simple-dialogs:pause-3 href=webappapis.html#pause>Pause</a> while waiting for the user's response.</li><li><p>If the user aborts, then return null; otherwise, return the string that the user responded
   with.</li></ol>

  


  <h4 id=printing><span class=secno>8.7.2</span> Printing<a href=#printing class=self-link></a></h4>

  <dl class=domintro><dt><var>window</var> . <code id=dom-print-dev><a href=#dom-print>print</a></code>()<dd>

    <p>ページを印刷するようユーザーに指示する。</p>

   </dl>

  

  <p>When the <dfn id=dom-print><code>print()</code></dfn> method is invoked, if the
  <code id=printing:document><a href=dom.html#document>Document</a></code> is <a id=printing:ready-for-post-load-tasks href=parsing.html#ready-for-post-load-tasks>ready for post-load tasks</a>, then the user agent must
  run the <a href=#printing-steps id=printing:printing-steps>printing steps</a> <a id=printing:in-parallel href=infrastructure.html#in-parallel>in parallel</a>. Otherwise, the user agent must only set the
  <dfn id=print-when-loaded>print when loaded</dfn> flag on the <code id=printing:document-2><a href=dom.html#document>Document</a></code>.</p>


  <p>User agents should also run the <a href=#printing-steps id=printing:printing-steps-2>printing steps</a> whenever the user asks for the
  opportunity to <a id=printing:obtain-a-physical-form href=rendering.html#obtain-a-physical-form>obtain a physical form</a> (e.g. printed copy), or the representation of a
  physical form (e.g. PDF copy), of a document.</p>

  <p>The <dfn id=printing-steps>printing steps</dfn> are as follows:</p>

  <ol><li>

    <p>The user agent may display a message to the user or return (or both).</p>

    <p class=example>For instance, a kiosk browser could silently ignore any invocations of the
    <code id=printing:dom-print><a href=#dom-print>print()</a></code> method.</p>

    <p class=example>For instance, a browser on a mobile device could detect that there are no
    printers in the vicinity and display a message saying so before continuing to offer a "save to
    PDF" option.</p>

   </li><li>

    <p>If the <a id=printing:active-sandboxing-flag-set href=origin.html#active-sandboxing-flag-set>active sandboxing flag set</a> of this <code id=printing:window><a href=window-object.html#window>Window</a></code> object's <a href=window-object.html#concept-document-window id=printing:concept-document-window>associated <code>Document</code></a> has the <a id=printing:sandboxed-modals-flag href=origin.html#sandboxed-modals-flag>sandboxed
    modals flag</a> set, then return.</p>

    <p class=note>If the printing dialog is blocked by a <code id=printing:document-3><a href=dom.html#document>Document</a></code>'s sandbox,
    then neither the <code id=printing:event-beforeprint><a href=indices.html#event-beforeprint>beforeprint</a></code> nor <code id=printing:event-afterprint><a href=indices.html#event-afterprint>afterprint</a></code> events will be fired.</p>

   </li><li>

    <p>The user agent must <a href=https://dom.spec.whatwg.org/#concept-event-fire id=printing:concept-event-fire data-x-internal=concept-event-fire>fire an event</a> named <code id=printing:event-beforeprint-2><a href=indices.html#event-beforeprint>beforeprint</a></code> at the <a id=printing:concept-relevant-global href=webappapis.html#concept-relevant-global>relevant global object</a> of the
    <code id=printing:document-4><a href=dom.html#document>Document</a></code> that is being printed, as well as any <a href=browsers.html#nested-browsing-context id=printing:nested-browsing-context>nested browsing contexts</a> in it.</p>

    <p class=example>The <code id=printing:event-beforeprint-3><a href=indices.html#event-beforeprint>beforeprint</a></code> event can be used to
    annotate the printed copy, for instance adding the time at which the document was printed.</p>

   </li><li>

    <p>The user agent should offer the user the opportunity to <a id=printing:obtain-a-physical-form-2 href=rendering.html#obtain-a-physical-form>obtain a physical form</a>
    (or the representation of a physical form) of the document. The user agent may wait for the user
    to either accept or decline before returning; if so, the user agent must <a id=printing:pause href=webappapis.html#pause>pause</a>
    while the method is waiting. Even if the user agent doesn't wait at this point, the user agent
    must use the state of the relevant documents as they are at this point in the algorithm if and
    when it eventually creates the alternate form.</p>

   </li><li>

    <p>The user agent must <a href=https://dom.spec.whatwg.org/#concept-event-fire id=printing:concept-event-fire-2 data-x-internal=concept-event-fire>fire an event</a> named <code id=printing:event-afterprint-2><a href=indices.html#event-afterprint>afterprint</a></code> at the <a id=printing:concept-relevant-global-2 href=webappapis.html#concept-relevant-global>relevant global object</a> of the
    <code id=printing:document-5><a href=dom.html#document>Document</a></code> that is being printed, as well as any <a href=browsers.html#nested-browsing-context id=printing:nested-browsing-context-2>nested browsing contexts</a> in it.</p>

    <p class=example>The <code id=printing:event-afterprint-3><a href=indices.html#event-afterprint>afterprint</a></code> event can be used to
    revert annotations added in the earlier event, as well as showing post-printing UI. For
    instance, if a page is walking the user through the steps of applying for a home loan, the
    script could automatically advance to the next step after having printed a form or other.</p>

   </li></ol>

  


  <nav><a href=dynamic-markup-insertion.html>← 8.4 Dynamic markup insertion</a> — <a href=./>Table of Contents</a> — <a href=system-state.html>8.8 System state and capabilities →</a></nav>
</body></html>