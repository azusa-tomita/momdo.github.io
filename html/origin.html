<!DOCTYPE html><html class="split" lang="ja"><script src="https://html.spec.whatwg.org/link-fixup.js" defer=""></script><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"><title>HTML Standard 日本語訳</title><meta content="#3c790a" name="theme-color"><link rel="stylesheet" href="https://resources.whatwg.org/spec.css" crossorigin=""><link rel="stylesheet" href="https://resources.whatwg.org/standard.css" crossorigin=""><link rel="stylesheet" href="https://resources.whatwg.org/standard-shared-with-dev.css" crossorigin=""><link rel="icon" href="https://resources.whatwg.org/logo.svg" crossorigin=""><link rel="stylesheet" href="https://html.spec.whatwg.org/styles.css" crossorigin=""><script>
   function toggleStatus(div) {
     div.parentNode.classList.toggle('wrapped');
   }
   function setLinkFragment(link) {
     link.hash = location.hash;
   }
  </script><body>
  
  <script async="" crossorigin="" src="./html-dfn.js"></script>
  <script data-file-issue-url="https://github.com/momdo/momdo.github.io/issues/new" async="" crossorigin="" src="https://resources.whatwg.org/file-issue.js"></script>
  
  <header id="head" class="head with-buttons"><a href="https://whatwg.org/" class="logo"><img width="100" alt="WHATWG" crossorigin="" src="https://resources.whatwg.org/logo.svg" height="100"></a><hgroup><h1 class="allcaps">HTML</h1><h2 id="living-standard" class="no-num no-toc">Living Standard — Last Updated <span class="pubdate">21 September 2020</span></h2></hgroup>
   
   

   
  </header>

  

  

  

  
  

  
  

  

  <nav><a href="window-object.html">← 7.3 Windowオブジェクト</a> — <a href="./">目次</a> — <a href="history.html">7.9 セッション履歴およびナビゲーション →</a></nav><ol class="toc"><li id="toc-browsers"><ol><li><a href="origin.html#origin"><span class="secno">7.5</span> 生成元</a><ol><li><a href="origin.html#sites"><span class="secno">7.5.1</span> Sites</a><li><a href="origin.html#relaxing-the-same-origin-restriction"><span class="secno">7.5.2</span> 同一生成元制限を緩和する</a><li><a href="origin.html#origin-isolation"><span class="secno">7.5.3</span> 生成元の分離</a></ol><li><a href="origin.html#sandboxing"><span class="secno">7.6</span> サンドボックス</a><li><a href="origin.html#cross-origin-opener-policies"><span class="secno">7.7</span> 生成元をまたいだオープナーポリシー</a><ol><li><a href="origin.html#the-cross-origin-opener-policy-header"><span class="secno">7.7.1</span> `<code>Cross-Origin-Opener-Policy</code>` ヘッダー</a><li><a href="origin.html#browsing-context-group-switches-due-to-cross-origin-opener-policy"><span class="secno">7.7.2</span> 生成元をまたいだオープナーポリシーによるブラウジングコンテキストグループスイッチ</a></ol><li><a href="origin.html#coep"><span class="secno">7.8</span> 生成元をまたいだ埋め込みポリシー</a><ol><li><a href="origin.html#the-headers"><span class="secno">7.8.1</span> ヘッダー</a><li><a href="origin.html#embedder-policy-checks"><span class="secno">7.8.2</span> 埋め込みポリシーチェック</a></ol></ol></ol><h3 id="origin"><span class="secno">7.5</span> 生成元<a href="#origin" class="self-link"></a></h3>
  

  <p>生成元は、ウェブのセキュリティモデルの基本的な通貨である。生成元を共有するウェブプラットフォーム内の2つの当事者が互いに信頼し、同一の権限を有すると仮定される。異なる生成元をもつ当事者は、互いに潜在的に悪意があると見なされ、互いから程度を変化させるよう隔離される。</p>

  <p class="example">たとえば、<code>bank.example.com</code>でホストされるExample Bankのウェブサイトは、<code>charity.example.org</code>でホストExample CharityのウェブサイトのDOMを検査しようとすると、<a id="origin:securityerror" href="https://triple-underscore.github.io/WebIDL-ja.html#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a> <code id="origin:domexception"><a data-x-internal="domexception" href="https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException">DOMException</a></code> が発生する。</p>

  <hr>

  <p id="origin-2"><dfn id="concept-origin" data-export="">生成元</dfn>は次のいずれかである：</p>

  <dl><dt><dfn id="concept-origin-opaque" data-export="">不透明な生成元</dfn><dd><p>内部値であり、シリアライズされていないために再作成することができない（<a href="#ascii-serialisation-of-an-origin" id="origin:ascii-serialisation-of-an-origin">生成元のシリアライズ</a>ごとに"<code>null</code>"としてシリアライズされる）。意味のある操作は、透過性のテストのみである。<dt><dfn id="concept-origin-tuple" data-export="">タプルの生成元</dfn><dd><p><a href="#concept-origin-tuple" id="origin:concept-origin-tuple">タプル</a>は以下で構成される：<ul class="brief"><li><dfn data-dfn-for="origin" id="concept-origin-scheme" data-export="">スキーム</dfn>（<a href="https://triple-underscore.github.io/URL-ja.html#concept-url-scheme" id="origin:concept-url-scheme" data-x-internal="concept-url-scheme">スキーム</a>）。<li><dfn data-dfn-for="origin" id="concept-origin-host" data-export="">ホスト</dfn>（<a href="https://triple-underscore.github.io/URL-ja.html#concept-host" id="origin:concept-host" data-x-internal="concept-host">ホスト</a>）。<li><dfn data-dfn-for="origin" id="concept-origin-port" data-export="">ポート</dfn>（<a href="https://triple-underscore.github.io/URL-ja.html#concept-url-port" id="origin:concept-url-port" data-x-internal="concept-url-port">ポート</a>）。<li><dfn data-dfn-for="origin" id="concept-origin-domain" data-export="">ドメイン</dfn>（<a href="https://triple-underscore.github.io/URL-ja.html#concept-domain" id="origin:concept-domain" data-x-internal="concept-domain">ドメイン</a>）。特に明記されていない限り、null。</ul>
   </dl>

  <p class="note"><a href="#concept-origin" id="origin:concept-origin">生成元</a>は、たとえば複数の<code id="origin:document"><a href="dom.html#document">Document</a></code>オブジェクト間で共有できます。さらに、<a href="#concept-origin" id="origin:concept-origin-2">生成元</a>は一般に不変である。<a href="#concept-origin-tuple" id="origin:concept-origin-tuple-2">タプルの生成元</a>の<a href="#concept-origin-domain" id="origin:concept-origin-domain">ドメイン</a>のみ、および<code id="origin:dom-document-domain"><a href="#dom-document-domain">document.domain</a></code> APIを介してのみ変更できる。</p>

  <p><a href="#concept-origin" id="origin:concept-origin-3">生成元</a><var>origin</var>の<dfn id="concept-origin-effective-domain" data-export="">有効ドメイン</dfn>は、次のように計算される：</p>

  <ol><li><p><var>origin</var>が<a href="#concept-origin-opaque" id="origin:concept-origin-opaque">不透明な生成元</a>である場合、nullを返す。<li><p><var>origin</var>の<a href="#concept-origin-domain" id="origin:concept-origin-domain-2">ドメイン</a>がnullでない場合、<var>origin</var>の<a href="#concept-origin-domain" id="origin:concept-origin-domain-3">ドメイン</a>を返す。<li><p><var>origin</var>の<a href="#concept-origin-host" id="origin:concept-origin-host">ホスト</a>を返す。</ol>

  

  <p>Various specification objects are defined to have an <a href="#concept-origin" id="origin:concept-origin-4">origin</a>. These <a href="#concept-origin" id="origin:concept-origin-5">origins</a> are determined as follows:</p>

  <dl><dt>For <code id="origin:document-2"><a href="dom.html#document">Document</a></code> objects<dd><p>The <a href="browsers.html#creating-a-new-browsing-context" id="origin:creating-a-new-browsing-context">create a new browsing context</a> and <a href="browsing-the-web.html#navigate" id="origin:navigate">navigation</a> algorithms assign the <a href="#concept-origin" id="origin:concept-origin-6">origin</a> at construction time. Otherwise, the default default behavior as defined in <cite>DOM</cite> applies. <a href="references.html#refsDOM">[DOM]</a></p>
   <dt>For images of <code id="origin:the-img-element"><a href="embedded-content.html#the-img-element">img</a></code> elements<dd><dl class="switch"><dt>If the <a href="images.html#img-req-data" id="origin:img-req-data">image data</a> is <a id="origin:cors-cross-origin" href="urls-and-fetching.html#cors-cross-origin">CORS-cross-origin</a><dd><p>A unique <a href="#concept-origin-opaque" id="origin:concept-origin-opaque-2">opaque origin</a> assigned when the image is created.<dt>If the <a href="images.html#img-req-data" id="origin:img-req-data-2">image data</a> is <a id="origin:cors-same-origin" href="urls-and-fetching.html#cors-same-origin">CORS-same-origin</a><dd><p>The <code id="origin:the-img-element-2"><a href="embedded-content.html#the-img-element">img</a></code> element's <a id="origin:node-document" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>'s <a href="#concept-origin" id="origin:concept-origin-7">origin</a>.</dl>
   <dt>For <code id="origin:the-audio-element"><a href="media.html#the-audio-element">audio</a></code> and <code id="origin:the-video-element"><a href="media.html#the-video-element">video</a></code> elements<dd><dl class="switch"><dt>If the <a id="origin:media-data" href="media.html#media-data">media data</a> is <a id="origin:cors-cross-origin-2" href="urls-and-fetching.html#cors-cross-origin">CORS-cross-origin</a><dd><p>A unique <a href="#concept-origin-opaque" id="origin:concept-origin-opaque-3">opaque origin</a> assigned when the <a id="origin:media-data-2" href="media.html#media-data">media data</a> is fetched.<dt>If the <a id="origin:media-data-3" href="media.html#media-data">media data</a> is <a id="origin:cors-same-origin-2" href="urls-and-fetching.html#cors-same-origin">CORS-same-origin</a><dd><p>The <a id="origin:media-element" href="media.html#media-element">media element</a>'s <a id="origin:node-document-2" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>'s <a href="#concept-origin" id="origin:concept-origin-8">origin</a>.</dl>
   </dl>

  <p>Other specifications can override the above definitions by themselves specifying the origin of a particular <code id="origin:document-3"><a href="dom.html#document">Document</a></code> object, image, or <a id="origin:media-element-2" href="media.html#media-element">media element</a>.</p>

  <hr>

  <p>The <dfn id="ascii-serialisation-of-an-origin" data-lt="serialization of an
  origin|ASCII serialization of an origin" data-export="">serialization of an origin</dfn> is the string obtained by applying the following algorithm to the given <a href="#concept-origin" id="origin:concept-origin-9">origin</a> <var>origin</var>:</p>

  <ol><li><p>If <var>origin</var> is an <a href="#concept-origin-opaque" id="origin:concept-origin-opaque-4">opaque origin</a>, then return "<code>null</code>".<li><p>Otherwise, let <var>result</var> be <var>origin</var>'s <a href="#concept-origin-scheme" id="origin:concept-origin-scheme">scheme</a>.<li><p>Append "<code>://</code>" to <var>result</var>.<li><p>Append <var>origin</var>'s <a href="#concept-origin-host" id="origin:concept-origin-host-2">host</a>, <a href="https://triple-underscore.github.io/URL-ja.html#concept-host-serializer" id="origin:host-serializer" data-x-internal="host-serializer">serialized</a>, to <var>result</var>.<li><p>If <var>origin</var>'s <a href="#concept-origin-port" id="origin:concept-origin-port">port</a> is non-null, append a U+003A COLON character (:), and <var>origin</var>'s <a href="#concept-origin-port" id="origin:concept-origin-port-2">port</a>, <a href="https://triple-underscore.github.io/URL-ja.html#serialize-an-integer" id="origin:serialize-an-integer" data-x-internal="serialize-an-integer">serialized</a>, to <var>result</var>.<li><p>Return <var>result</var>.</ol>

  <p class="example">The <a href="#ascii-serialisation-of-an-origin" id="origin:ascii-serialisation-of-an-origin-2">serialization</a> of ("<code>https</code>", "<code>xn--maraa-rta.example</code>", null, null) is "<code>https://xn--maraa-rta.example</code>".</p>

  <p id="unicode-serialisation-of-an-origin" class="note">There used to also be a <i>Unicode serialization of an origin</i>. However, it was never widely adopted.</p>

  <hr>

  <p>Two <a href="#concept-origin" id="origin:concept-origin-10">origins</a>, <var>A</var> and <var>B</var>, are said to be <dfn id="same-origin" data-export="">same origin</dfn> if the following algorithm returns true:</p>

  <ol><li><p>If <var>A</var> and <var>B</var> are the same <a href="#concept-origin-opaque" id="origin:concept-origin-opaque-5">opaque origin</a>, then return true.<li><p>If <var>A</var> and <var>B</var> are both <a href="#concept-origin-tuple" id="origin:concept-origin-tuple-3">tuple origins</a> and their <a href="#concept-origin-scheme" id="origin:concept-origin-scheme-2">schemes</a>, <a href="#concept-origin-host" id="origin:concept-origin-host-3">hosts</a>, and <a href="#concept-origin-port" id="origin:concept-origin-port-3">port</a> are identical, then return true.<li><p>falseを返す。</ol>

  <p>Two <a href="#concept-origin" id="origin:concept-origin-11">origins</a>, <var>A</var> and <var>B</var>, are said to be <dfn id="same-origin-domain" data-export="">same origin-domain</dfn> if the following algorithm returns true:</p>

  <ol><li><p>If <var>A</var> and <var>B</var> are the same <a href="#concept-origin-opaque" id="origin:concept-origin-opaque-6">opaque origin</a>, then return true.<li><p>If <var>A</var> and <var>B</var> are both <a href="#concept-origin-tuple" id="origin:concept-origin-tuple-4">tuple origins</a>, run these substeps:</p>

    <ol><li><p>If <var>A</var> and <var>B</var>'s <a href="#concept-origin-scheme" id="origin:concept-origin-scheme-3">schemes</a> are identical, and their <a href="#concept-origin-domain" id="origin:concept-origin-domain-4">domains</a> are identical and non-null, then return true.<li><p>Otherwise, if <var>A</var> and <var>B</var> are <a href="#same-origin" id="origin:same-origin">same origin</a> and their <a href="#concept-origin-domain" id="origin:concept-origin-domain-5">domains</a> are identical and null, then return true.</ol>

   <li><p>falseを返す。</ol>

  <div class="example"><table><tr><th><var>A</var><th><var>B</var><th><a href="#same-origin" id="origin:same-origin-2">same origin</a><th><a href="#same-origin-domain" id="origin:same-origin-domain">same origin-domain</a><tr><td>("<code>https</code>", "<code>example.org</code>", null, null)<td>("<code>https</code>", "<code>example.org</code>", null, null)<td>✅<td>✅<tr><td>("<code>https</code>", "<code>example.org</code>", 314, null)<td>("<code>https</code>", "<code>example.org</code>", 420, null)<td>❌<td>❌<tr><td>("<code>https</code>", "<code>example.org</code>", 314, "<code>example.org</code>")<td>("<code>https</code>", "<code>example.org</code>", 420, "<code>example.org</code>")<td>❌<td>✅<tr><td>("<code>https</code>", "<code>example.org</code>", null, null)<td>("<code>https</code>", "<code>example.org</code>", null, "<code>example.org</code>")<td>✅<td>❌<tr><td>("<code>https</code>", "<code>example.org</code>", null, "<code>example.org</code>")<td>("<code>http</code>", "<code>example.org</code>", null, "<code>example.org</code>")<td>❌<td>❌</table>
  </div>


  <h4 id="sites"><span class="secno">7.5.1</span> Sites<a href="#sites" class="self-link"></a></h4>

  <p>A <dfn id="scheme-and-registrable-domain" data-export="">scheme-and-registrable-domain</dfn> is a <a id="sites:tuple" href="https://triple-underscore.github.io/infra-ja.html#tuple" data-x-internal="tuple">tuple</a> of a <a href="https://triple-underscore.github.io/URL-ja.html#concept-url-scheme" id="sites:concept-url-scheme" data-x-internal="concept-url-scheme">scheme</a> and a <a href="https://triple-underscore.github.io/URL-ja.html#concept-domain" id="sites:concept-domain" data-x-internal="concept-domain">domain</a>.</p>

  <p>A <dfn id="site" data-export="">site</dfn> is an <a href="#concept-origin-opaque" id="sites:concept-origin-opaque">opaque origin</a>, a <a href="#concept-origin-tuple" id="sites:concept-origin-tuple">tuple origin</a> whose <a href="#concept-origin-host" id="sites:concept-origin-host">host</a>'s <a id="sites:registrable-domain" href="https://triple-underscore.github.io/URL-ja.html#host-registrable-domain" data-x-internal="registrable-domain">registrable domain</a> is null, or a <a href="#scheme-and-registrable-domain" id="sites:scheme-and-registrable-domain">scheme-and-registrable-domain</a>.</p>

  <p>To <dfn id="obtain-a-site" data-export="">obtain a site</dfn>, given an origin <var>origin</var>, run these steps:</p>

  <ol><li><p>If <var>origin</var> is an <a href="#concept-origin-opaque" id="sites:concept-origin-opaque-2">opaque origin</a>, then return <var>origin</var>.<li><p>If <var>origin</var>'s <a href="#concept-origin-host" id="sites:concept-origin-host-2">host</a>'s <a id="sites:registrable-domain-2" href="https://triple-underscore.github.io/URL-ja.html#host-registrable-domain" data-x-internal="registrable-domain">registrable domain</a> is null, then return <var>origin</var>.<li><p>Return (<var>origin</var>'s <a href="#concept-origin-scheme" id="sites:concept-origin-scheme">scheme</a>, <var>origin</var>'s <a href="#concept-origin-host" id="sites:concept-origin-host-3">host</a>'s <a id="sites:registrable-domain-3" href="https://triple-underscore.github.io/URL-ja.html#host-registrable-domain" data-x-internal="registrable-domain">registrable domain</a>).</ol>

  <p>Two <a href="#concept-origin" id="sites:concept-origin">origins</a>, <var>A</var> and <var>B</var>, are said to be <dfn id="schemelessly-same-site" data-export="">schemelessly same site</dfn> if the following algorithm returns true:</p>

  <ol><li><p>If <var>A</var> and <var>B</var> are the same <a href="#concept-origin-opaque" id="sites:concept-origin-opaque-3">opaque origin</a>, then return true.<li><p>If <var>A</var> and <var>B</var> are both <a href="#concept-origin-tuple" id="sites:concept-origin-tuple-2">tuple origins</a>, then:</p>

    <ol><li><p>Let <var>hostA</var> be <var>A</var>'s <a href="#concept-origin-host" id="sites:concept-origin-host-4">host</a>, and let <var>hostB</var> be <var>B</var>'s <a href="#concept-origin-host" id="sites:concept-origin-host-5">host</a>.<li><p>If <var>hostA</var> <a href="https://triple-underscore.github.io/URL-ja.html#concept-host-equals" id="sites:host-equals" data-x-internal="host-equals">equals</a> <var>hostB</var> and <var>hostA</var>'s <a id="sites:registrable-domain-4" href="https://triple-underscore.github.io/URL-ja.html#host-registrable-domain" data-x-internal="registrable-domain">registrable domain</a> is null, then return true.<li><p>If <var>hostA</var>'s <a id="sites:registrable-domain-5" href="https://triple-underscore.github.io/URL-ja.html#host-registrable-domain" data-x-internal="registrable-domain">registrable domain</a> <a href="https://triple-underscore.github.io/URL-ja.html#concept-host-equals" id="sites:host-equals-2" data-x-internal="host-equals">equals</a> <var>hostB</var>'s <a id="sites:registrable-domain-6" href="https://triple-underscore.github.io/URL-ja.html#host-registrable-domain" data-x-internal="registrable-domain">registrable domain</a> and is non-null, then return true.</ol>
   <li><p>falseを返す。</ol>

  <p>Two <a href="#concept-origin" id="sites:concept-origin-2">origins</a>, <var>A</var> and <var>B</var>, are said to be <dfn id="same-site" data-export="">same site</dfn> if both of the following statements are true:</p>

  <ul><li><p><var>A</var> and <var>B</var> are <a href="#schemelessly-same-site" id="sites:schemelessly-same-site">schemelessly same site</a><li><p><var>A</var> and <var>B</var> are either both <a href="#concept-origin-opaque" id="sites:concept-origin-opaque-4">opaque origins</a>, or both <a href="#concept-origin-tuple" id="sites:concept-origin-tuple-3">tuple origins</a> with the same <a href="#concept-origin-scheme" id="sites:concept-origin-scheme-2">scheme</a></ul>

  <p class="note">Unlike the <a href="#same-origin" id="sites:same-origin">same origin</a> and <a href="#same-origin-domain" id="sites:same-origin-domain">same origin-domain</a> concepts, for <a href="#schemelessly-same-site" id="sites:schemelessly-same-site-2">schemelessly same site</a> and <a href="#same-site" id="sites:same-site">same site</a>, the <a href="#concept-origin-port" id="sites:concept-origin-port">port</a> and <a href="#concept-origin-domain" id="sites:concept-origin-domain">domain</a> components are ignored.</p>

  <p class="warning">For the reasons <a href="https://triple-underscore.github.io/URL-ja.html#warning-avoid-psl">explained in <cite>URL</cite></a>, the <a href="#same-site" id="sites:same-site-2">same site</a> and <a href="#schemelessly-same-site" id="sites:schemelessly-same-site-3">schemelessly same site</a> concepts should be avoided when possible, in favor of <a href="#same-origin" id="sites:same-origin-2">same origin</a> checks.</p>

  <div id="example-same-site" class="example"><p>Given that <code>wildlife.museum</code>, <code>museum</code>, and <code>com</code> are <a href="https://triple-underscore.github.io/URL-ja.html#host-public-suffix" id="sites:public-suffix" data-x-internal="public-suffix">public suffixes</a> and that <code>example.com</code> is not:</p>

   <table><tr><th><var>A</var><th><var>B</var><th><a href="#schemelessly-same-site" id="sites:schemelessly-same-site-4">schemelessly same site</a><th><a href="#same-site" id="sites:same-site-3">same site</a><tr><td>("<code>https</code>", "<code>example.com</code>")<td>("<code>https</code>", "<code>sub.example.com</code>")<td>✅<td>✅<tr><td>("<code>https</code>", "<code>example.com</code>")<td>("<code>https</code>", "<code>sub.other.example.com</code>")<td>✅<td>✅<tr><td>("<code>https</code>", "<code>example.com</code>")<td>("<code>http</code>", "<code>non-secure.example.com</code>")<td>✅<td>❌<tr><td>("<code>https</code>", "<code>r.wildlife.museum</code>")<td>("<code>https</code>", "<code>sub.r.wildlife.museum</code>")<td>✅<td>✅<tr><td>("<code>https</code>", "<code>r.wildlife.museum</code>")<td>("<code>https</code>", "<code>sub.other.r.wildlife.museum</code>")<td>✅<td>✅<tr><td>("<code>https</code>", "<code>r.wildlife.museum</code>")<td>("<code>https</code>", "<code>other.wildlife.museum</code>")<td>❌<td>❌<tr><td>("<code>https</code>", "<code>r.wildlife.museum</code>")<td>("<code>https</code>", "<code>wildlife.museum</code>")<td>❌<td>❌<tr><td>("<code>https</code>", "<code>wildlife.museum</code>")<td>("<code>https</code>", "<code>wildlife.museum</code>")<td>✅<td>✅</table>

   <p>(Here we have omitted the <a href="#concept-origin-port" id="sites:concept-origin-port-2">port</a> and <a href="#concept-origin-domain" id="sites:concept-origin-domain-2">domain</a> components since they are not considered.)</p>
  </div>

  


  <h4 id="relaxing-the-same-origin-restriction"><span class="secno">7.5.2</span> 同一生成元制限を緩和する<a href="#relaxing-the-same-origin-restriction" class="self-link"></a></h4><div class="mdn-anno wrapped"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/domain" title="The domain property of the Document interface gets/sets the domain portion of the origin of the current document, as used by the same-origin policy.">Document/domain</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span></div></div></div>

  <dl class="domintro"><dt><var>document</var> . <code id="dom-document-domain-dev"><a href="#dom-document-domain">domain</a></code> [ = <var>domain</var> ]<dd><p>セキュリティチェックのために使用される現在のドメインを返す。</p>

    <p>サブドメインを削除する値に設定し、<a href="#concept-origin" id="relaxing-the-same-origin-restriction:concept-origin">生成元</a>の<a href="#concept-origin-domain" id="relaxing-the-same-origin-restriction:concept-origin-domain">ドメイン</a>を変更し、同じドメインの他のサブドメイン（同じことを行う場合）のページが互いにアクセスできるようにすることができる。これにより、ドメインの異なるホスト上のページが、互いのDOMに同期的にアクセスできるようになる。</p>

    <p>サンドボックス化された<code id="relaxing-the-same-origin-restriction:the-iframe-element"><a href="iframe-embed-object.html#the-iframe-element">iframe</a></code>、<a href="#concept-origin-opaque" id="relaxing-the-same-origin-restriction:concept-origin-opaque">不透明な生成元</a>をもつ<code id="relaxing-the-same-origin-restriction:document"><a href="dom.html#document">Document</a></code>、<a href="browsers.html#concept-document-bc" id="relaxing-the-same-origin-restriction:concept-document-bc">ブラウジングコンテキスト</a>のない<code id="relaxing-the-same-origin-restriction:document-2"><a href="dom.html#document">Document</a></code>、および"<code id="relaxing-the-same-origin-restriction:document-domain-feature"><a href="infrastructure.html#document-domain-feature">document-domain</a></code>"機能が無効になっている場合、セッターは<a id="relaxing-the-same-origin-restriction:securityerror" href="https://triple-underscore.github.io/WebIDL-ja.html#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a>例外を投げる。In cases where <code id="relaxing-the-same-origin-restriction:dom-crossoriginisolated"><a href="webappapis.html#dom-crossoriginisolated">crossOriginIsolated</a></code> or <code id="relaxing-the-same-origin-restriction:dom-originisolated"><a href="#dom-originisolated">originIsolated</a></code> return true, the setter will do nothing.</p>
   </dl>

  <div class="critical"><p><code id="relaxing-the-same-origin-restriction:dom-document-domain"><a href="#dom-document-domain">document.domain</a></code>セッターの使用を避ける。これは、同一生成元ポリシーが提供するセキュリティ保護を損なうものである。これは共有ホスティングを使用している場合に特に顕著である。たとえば、信頼できない第三者が同じIPアドレスだが異なるポートで HTTP サーバーをホストできる場合、<code id="relaxing-the-same-origin-restriction:dom-document-domain-2"><a href="#dom-document-domain">document.domain</a></code>セッターを使用した後に生成元を比較するときにポートが無視されるため、通常は同じホスト上の2つの異なるサイトを保護する同一生成元の保護が失敗する。</p>

   <p>これらのセキュリティ上の落とし穴があるため、この機能はウェブプラットフォームから削除されるプロセスにある。（これは何年もかかる長いプロセスである。）</p>

   <p>代わりに、安全な方法で生成元間で通信するために、<code id="relaxing-the-same-origin-restriction:dom-window-postmessage"><a href="web-messaging.html#dom-window-postmessage">postMessage()</a></code>または<code id="relaxing-the-same-origin-restriction:messagechannel"><a href="web-messaging.html#messagechannel">MessageChannel</a></code>オブジェクトを使用する。</p>
  </div>

  

  <p>The <dfn id="dom-document-domain"><code>domain</code></dfn> getter steps are:</p>

  <ol><li><p>Let <var>effectiveDomain</var> be <a id="relaxing-the-same-origin-restriction:this" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a>'s <a href="#concept-origin" id="relaxing-the-same-origin-restriction:concept-origin-2">origin</a>'s <a href="#concept-origin-effective-domain" id="relaxing-the-same-origin-restriction:concept-origin-effective-domain">effective domain</a>.<li><p>If <var>effectiveDomain</var> is null, then return the empty string.<li><p>Return <var>effectiveDomain</var>, <a href="https://triple-underscore.github.io/URL-ja.html#concept-host-serializer" id="relaxing-the-same-origin-restriction:host-serializer" data-x-internal="host-serializer">serialized</a>.</ol>

  <p>The <code id="relaxing-the-same-origin-restriction:dom-document-domain-3"><a href="#dom-document-domain">domain</a></code> setter steps are:</p>

  <ol><li><p>If <a id="relaxing-the-same-origin-restriction:this-2" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a>'s <a href="browsers.html#concept-document-bc" id="relaxing-the-same-origin-restriction:concept-document-bc-2">browsing context</a> is null, then throw a <a id="relaxing-the-same-origin-restriction:securityerror-2" href="https://triple-underscore.github.io/WebIDL-ja.html#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a> <code id="relaxing-the-same-origin-restriction:domexception"><a data-x-internal="domexception" href="https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException">DOMException</a></code>.<li><p>If <a id="relaxing-the-same-origin-restriction:this-3" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a>'s <a href="#active-sandboxing-flag-set" id="relaxing-the-same-origin-restriction:active-sandboxing-flag-set">active sandboxing flag set</a> has its <a href="#sandboxed-document.domain-browsing-context-flag" id="relaxing-the-same-origin-restriction:sandboxed-document.domain-browsing-context-flag">sandboxed <code>document.domain</code> browsing context flag</a> set, then throw a <a id="relaxing-the-same-origin-restriction:securityerror-3" href="https://triple-underscore.github.io/WebIDL-ja.html#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a> <code id="relaxing-the-same-origin-restriction:domexception-2"><a data-x-internal="domexception" href="https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException">DOMException</a></code>.<li><p>If <a id="relaxing-the-same-origin-restriction:this-4" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a> is not <a id="relaxing-the-same-origin-restriction:allowed-to-use" href="iframe-embed-object.html#allowed-to-use">allowed to use</a> the "<code id="relaxing-the-same-origin-restriction:document-domain-feature-2"><a href="infrastructure.html#document-domain-feature">document-domain</a></code>" feature, then throw a <a id="relaxing-the-same-origin-restriction:securityerror-4" href="https://triple-underscore.github.io/WebIDL-ja.html#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a> <code id="relaxing-the-same-origin-restriction:domexception-3"><a data-x-internal="domexception" href="https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException">DOMException</a></code>.<li><p>Let <var>effectiveDomain</var> be <a id="relaxing-the-same-origin-restriction:this-5" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a>'s <a href="#concept-origin" id="relaxing-the-same-origin-restriction:concept-origin-3">origin</a>'s <a href="#concept-origin-effective-domain" id="relaxing-the-same-origin-restriction:concept-origin-effective-domain-2">effective domain</a>.<li><p>If <var>effectiveDomain</var> is null, then throw a <a id="relaxing-the-same-origin-restriction:securityerror-5" href="https://triple-underscore.github.io/WebIDL-ja.html#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a> <code id="relaxing-the-same-origin-restriction:domexception-4"><a data-x-internal="domexception" href="https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException">DOMException</a></code>.<li><p>If the given value <a href="#is-a-registrable-domain-suffix-of-or-is-equal-to" id="relaxing-the-same-origin-restriction:is-a-registrable-domain-suffix-of-or-is-equal-to">is not a registrable domain suffix of and is not equal to</a> <var>effectiveDomain</var>, then throw a <a id="relaxing-the-same-origin-restriction:securityerror-6" href="https://triple-underscore.github.io/WebIDL-ja.html#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a> <code id="relaxing-the-same-origin-restriction:domexception-5"><a data-x-internal="domexception" href="https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException">DOMException</a></code>.<li><p>If the <a id="relaxing-the-same-origin-restriction:surrounding-agent" href="https://tc39.es/ecma262/#surrounding-agent" data-x-internal="surrounding-agent">surrounding agent</a>'s <a id="relaxing-the-same-origin-restriction:agent-cluster" href="https://tc39.es/ecma262/#sec-agent-clusters" data-x-internal="agent-cluster">agent cluster</a>'s <a id="relaxing-the-same-origin-restriction:cross-origin-isolated" href="webappapis.html#cross-origin-isolated">cross-origin isolated</a> is true, then return.<li><p>If the <a id="relaxing-the-same-origin-restriction:surrounding-agent-2" href="https://tc39.es/ecma262/#surrounding-agent" data-x-internal="surrounding-agent">surrounding agent</a>'s <a id="relaxing-the-same-origin-restriction:agent-cluster-2" href="https://tc39.es/ecma262/#sec-agent-clusters" data-x-internal="agent-cluster">agent cluster</a>'s <a id="relaxing-the-same-origin-restriction:origin-isolated" href="webappapis.html#origin-isolated">origin-isolated</a> is true, then return.<li><p>Set <var>this</var>'s <a href="#concept-origin" id="relaxing-the-same-origin-restriction:concept-origin-4">origin</a>'s <a href="#concept-origin-domain" id="relaxing-the-same-origin-restriction:concept-origin-domain-2">domain</a> to the result of <a href="https://triple-underscore.github.io/URL-ja.html#concept-host-parser" id="relaxing-the-same-origin-restriction:host-parser" data-x-internal="host-parser">parsing</a> the given value.</ol>

  <p>To determine if a string <var>hostSuffixString</var> <dfn id="is-a-registrable-domain-suffix-of-or-is-equal-to" data-lt="is a registrable
  domain suffix of or is equal to|is not a registrable domain suffix of and is not equal to" data-export="">is a registrable domain suffix of or is equal to</dfn> a <a href="https://triple-underscore.github.io/URL-ja.html#concept-host" id="relaxing-the-same-origin-restriction:concept-host" data-x-internal="concept-host">host</a> <var>originalHost</var>, run these steps:</p>
  

  <ol><li><p>If <var>hostSuffixString</var> is the empty string, then return false.<li><p>Let <var>host</var> be the result of <a href="https://triple-underscore.github.io/URL-ja.html#concept-host-parser" id="relaxing-the-same-origin-restriction:host-parser-2" data-x-internal="host-parser">parsing</a> <var>hostSuffixString</var>.<li><p>If <var>host</var> is failure, then return false.<li><p>If <var>host</var> does not <a href="https://triple-underscore.github.io/URL-ja.html#concept-host-equals" id="relaxing-the-same-origin-restriction:host-equals" data-x-internal="host-equals">equal</a> <var>originalHost</var>, then:</p>

    <ol><li><p>If <var>host</var> or <var>originalHost</var> is not a <a href="https://triple-underscore.github.io/URL-ja.html#concept-domain" id="relaxing-the-same-origin-restriction:concept-domain" data-x-internal="concept-domain">domain</a>, then return false.</p>

      <p class="note">This excludes <a href="https://triple-underscore.github.io/URL-ja.html#concept-host" id="relaxing-the-same-origin-restriction:concept-host-2" data-x-internal="concept-host">hosts</a> that are an <a id="relaxing-the-same-origin-restriction:ipv4-address" href="https://triple-underscore.github.io/URL-ja.html#concept-ipv4" data-x-internal="ipv4-address">IPv4 address</a> or an <a id="relaxing-the-same-origin-restriction:ipv6-address" href="https://triple-underscore.github.io/URL-ja.html#concept-ipv6" data-x-internal="ipv6-address">IPv6 address</a>.</p>
     <li><p>If <var>host</var>, prefixed by a U+002E FULL STOP (.), does not exactly match the end of <var>originalHost</var>, then return false.<li><p>If <var>host</var> <a href="https://triple-underscore.github.io/URL-ja.html#concept-host-equals" id="relaxing-the-same-origin-restriction:host-equals-2" data-x-internal="host-equals">equals</a> <var>host</var>'s <a id="relaxing-the-same-origin-restriction:public-suffix" href="https://triple-underscore.github.io/URL-ja.html#host-public-suffix" data-x-internal="public-suffix">public suffix</a>, then return false. <a href="references.html#refsURL">[URL]</a></ol>
   <li><p>Return true.</ol>

  



  <h4 id="origin-isolation"><span class="secno">7.5.3</span> 生成元の分離<a href="#origin-isolation" class="self-link"></a></h4>

  <dl class="domintro"><dt>window . <code id="dom-originisolated-dev"><a href="#dom-originisolated">originIsolated</a></code><dd><p>この節で説明されている方法で、この<code id="origin-isolation:window"><a href="window-object.html#window">Window</a></code>が生成元から分離されている場合にtrueを返す。</p>
   </dl>

  <p><a id="origin-isolation:secure-context" href="webappapis.html#secure-context">セキュアなコンテキスト</a>で配信される<code id="origin-isolation:document"><a href="dom.html#document">Document</a></code>は、`<code id="origin-isolation:origin-isolation-2"><a href="iana.html#origin-isolation-2">Origin-Isolation</a></code>` HTTP レスポンスヘッダーを使用することで、 生成元の分離をオプトインすることができる。このヘッダーは<a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html" id="origin-isolation:http-structured-header" data-x-internal="http-structured-header">構造化されたヘッダー</a>であり、その値は<a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html#boolean" id="origin-isolation:http-structured-header-boolean" data-x-internal="http-structured-header-boolean">真偽値</a>でなければらない。<a href="references.html#refsSTRUCTURED-FIELDS">[STRUCTURED-FIELDS]</a></p>

  <p><a href="browsing-the-web.html#initialise-the-document-object" id="origin-isolation:initialise-the-document-object">新しい<code>Document</code>オブジェクトの作成と初期化</a>の処理モデルによって、<a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html#boolean" id="origin-isolation:http-structured-header-boolean-2" data-x-internal="http-structured-header-boolean">構造化されたヘッダー</a>の真偽値ではない値（すなわち、`<code>?1</code>`）は無視される。</p>

  <p>このヘッダーを使用すると、結果として得られる<code id="origin-isolation:document-2"><a href="dom.html#document">Document</a></code>の<a id="origin-isolation:agent-cluster-key" href="webappapis.html#agent-cluster-key">エージェントクラスタキー</a>は、<a href="#obtain-a-site" id="origin-isolation:obtain-a-site">対応するサイト</a>ではなく、その<a href="#concept-origin" id="origin-isolation:concept-origin">生成元</a>となる。目に見える効果として、これは<code id="origin-isolation:dom-document-domain"><a href="#dom-document-domain">document.domain</a></code>を使用して<a href="#relaxing-the-same-origin-restriction">同一生成元の制限を緩和</a>しようとしても何も実行されない代わりに、<code id="origin-isolation:webassembly.module"><a data-x-internal="webassembly.module" href="https://webassembly.github.io/spec/js-api/#module">WebAssembly.Module</a></code>オブジェクトを生成元をまたいだ<code id="origin-isolation:document-3"><a href="dom.html#document">Document</a></code>に送信することができなくなることである（たとえ<a href="#same-site" id="origin-isolation:same-site">同じサイト</a>であっても）。水面下で、この分離により、ユーザーエージェントは、プロセスやスレッドなどの<a href="https://tc39.es/ecma262/#sec-agent-clusters" id="origin-isolation:agent-cluster" data-x-internal="agent-cluster">エージェントクラスター</a>に対応する実装固有のリソースをより効率的に割り当てることが可能になる。</p>

  <p><a id="origin-isolation:browsing-context-group" href="browsers.html#browsing-context-group">ブラウジングコンテキストグループ</a>内では、`<code id="origin-isolation:origin-isolation-2-2"><a href="iana.html#origin-isolation-2">Origin-Isolation</a></code>`ヘッダーは、たとえ一方がヘッダーを送信し、他方が送信しない場合でも、同一生成元の<code id="origin-isolation:document-4"><a href="dom.html#document">Document</a></code>オブジェクトが異なる<a href="https://tc39.es/ecma262/#sec-agent-clusters" id="origin-isolation:agent-cluster-2" data-x-internal="agent-cluster">エージェントクラスター</a>で終わる原因にはならないことに注意する。This is prevented by means of the <a id="origin-isolation:historical-agent-cluster-key-map" href="browsers.html#historical-agent-cluster-key-map">historical agent cluster key map</a>.</p>

  <p class="note">つまり、<code id="origin-isolation:dom-originisolated"><a href="#dom-originisolated">originIsolated</a></code>ゲッターは、同じ<a id="origin-isolation:browsing-context-group-2" href="browsers.html#browsing-context-group">ブラウジングコンテキストグループ</a>内の以前にロードされた同一生成元のページでヘッダーが省略されていた場合、たとえヘッダーが設定されていても、falseを返すことができるということである。同様に、ヘッダーが設定されていなくてもtrueを返すことができる。</p>

  <p>The <dfn id="dom-originisolated"><code>originIsolated</code></dfn> getter steps are to return the <a id="origin-isolation:surrounding-agent" href="https://tc39.es/ecma262/#surrounding-agent" data-x-internal="surrounding-agent">surrounding agent</a>'s <a id="origin-isolation:agent-cluster-3" href="https://tc39.es/ecma262/#sec-agent-clusters" data-x-internal="agent-cluster">agent cluster</a>'s <a id="origin-isolation:origin-isolated" href="webappapis.html#origin-isolated">origin-isolated</a>.</p>

  <p class="note"><a href="#obtain-a-site" id="origin-isolation:obtain-a-site-2">サイトを取得</a>して<a href="#concept-origin" id="origin-isolation:concept-origin-2">生成元</a>を返す<code id="origin-isolation:document-5"><a href="dom.html#document">Document</a></code>は、無条件に生成元の分離がされているとみなすことができる。その場合、ヘッダーは効果がない。</p>

  <p class="note">同様に、<a id="origin-isolation:cross-origin-isolated" href="webappapis.html#cross-origin-isolated">生成元をまたいだ分離</a><a id="origin-isolation:agent-cluster-4" href="https://tc39.es/ecma262/#sec-agent-clusters" data-x-internal="agent-cluster">エージェントクラスター</a>内の<code id="origin-isolation:document-6"><a href="dom.html#document">Document</a></code>は自動的に生成元分離がされる。生成元をまたいだ分離を達成するために使用される`<code id="origin-isolation:cross-origin-opener-policy-2"><a href="iana.html#cross-origin-opener-policy-2">Cross-Origin-Opener-Policy</a></code>`および`<code id="origin-isolation:cross-origin-embedder-policy"><a href="iana.html#cross-origin-embedder-policy">Cross-Origin-Embedder-Policy</a></code>`ヘッダーは、同じアドレス空間内のすべてのものがそこに存在することを保証することを目的としているため、`<code id="origin-isolation:origin-isolation-2-3"><a href="iana.html#origin-isolation-2">Origin-Isolation</a></code>`ヘッダーは、リソースの割り当てに関する実装への追加のヒントとして有用であるかもしれない。しかし、それを追加しても、著者のコードに追加の目に見える影響はない。</p>



  <h3 id="sandboxing"><span class="secno">7.6</span> サンドボックス<a href="#sandboxing" class="self-link"></a></h3>

  <p><dfn id="sandboxing-flag-set" data-export="">サンドボックスフラグセット</dfn>は以下のフラグの0個以上のセットであり、これは潜在的に信頼されないリソースが持つ能力を制限するために使用される：</p>

  <dl><dt><dfn id="sandboxed-navigation-browsing-context-flag" data-export="">サンドボックス化されたナビゲーションブラウジングコンテキストフラグ</dfn><dd><p>このフラグは、コンテンツが、<a href="browsing-the-web.html#sandboxLinks">サンドボックス化されたブラウジングコンテキスト自体</a>（またはその中にさらにネストされたブラウジングコンテキスト）、<a href="browsers.html#auxiliary-browsing-context" id="sandboxing:auxiliary-browsing-context">補助ブラウジングコンテキスト</a>（次に定義される<a href="#sandboxed-auxiliary-navigation-browsing-context-flag" id="sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag">サンドボックス化された補助ナビゲーションブラウジングコンテキストフラグ</a>によって保護されている）、および<a id="sandboxing:top-level-browsing-context" href="browsers.html#top-level-browsing-context">トップレベルブラウジングコンテキスト</a>（<a href="#sandboxed-top-level-navigation-without-user-activation-browsing-context-flag" id="sandboxing:sandboxed-top-level-navigation-without-user-activation-browsing-context-flag">サンドボックス化されたユーザー起動ブラウジングコンテキストフラグなしのトップレベルナビゲーション</a>、および以下に定義される<a href="#sandboxed-top-level-navigation-with-user-activation-browsing-context-flag" id="sandboxing:sandboxed-top-level-navigation-with-user-activation-browsing-context-flag">サンドボックス化されたユーザー起動ブラウジングコンテキストフラグありトップレベルナビゲーション</a>によって保護されている）以外のブラウジングコンテキストをナビゲートすることを防止するものである。</p>

    <p><a href="#sandboxed-auxiliary-navigation-browsing-context-flag" id="sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag-2">サンドボックス化された補助ナビゲーションブラウジングコンテキストフラグ</a>が設定されない場合、それにもかかわらず一定の場合における制限はポップアップ（新しい<a href="browsers.html#top-level-browsing-context" id="sandboxing:top-level-browsing-context-2">トップレベルブラウジングコンテキスト</a>）を開くことができる。これらの<a href="browsers.html#browsing-context" id="sandboxing:browsing-context">ブラウジングコンテキスト</a>は常に、<dfn id="one-permitted-sandboxed-navigator">1つの許可されたサンドボックス化されたナビゲーター</dfn>を持ち、実際に移動するために作成した<a id="sandboxing:browsing-context-2" href="browsers.html#browsing-context">ブラウジングコンテキスト</a>を許可する、ブラウジングコンテキストが作成されるときに設定を持つ。（そうでなければ、<a href="#sandboxed-navigation-browsing-context-flag" id="sandboxing:sandboxed-navigation-browsing-context-flag">サンドボックス化されたナビゲーションブラウジングコンテキストフラグ</a>は、それらが開かれた場合であってもナビゲートされていくのを防ぐだろう。）</p>
   <dt><dfn id="sandboxed-auxiliary-navigation-browsing-context-flag" data-export="">サンドボックス化された補助ナビゲーションブラウジングコンテキストフラグ</dfn><dd><p>このフラグは、<a href="browsers.html#sandboxWindowOpen">コンテンツが新しい補助ブラウジングコンテキストを作成するのを防ぐ</a>。 たとえば、<code id="sandboxing:attr-hyperlink-target"><a href="links.html#attr-hyperlink-target">target</a></code>属性や<code id="sandboxing:dom-open"><a href="window-object.html#dom-open">window.open()</a></code>メソッドを使用する。</p>
   <dt><dfn id="sandboxed-top-level-navigation-without-user-activation-browsing-context-flag" data-export="">ユーザーによるアクティブ化なしでサンドボックス化されたトップレベルナビゲーションブラウジングコンテキストフラグ</dfn><dd><p>このフラグは、<a href="browsing-the-web.html#sandboxLinks">それらの<span>トップレベルブラウジングコンテキスト</span>のナビゲートからコンテンツを防ぎ</a>、かつ<a href="window-object.html#sandboxClose">それらの<span>トップレベルブラウジングコンテキスト</span>の遮断からコンテンツを防ぐ</a>。サンドボックス化されたブラウジングコンテキストの<a id="sandboxing:active-window" href="browsers.html#active-window">アクティブウィンドウ</a>が<a id="sandboxing:transient-activation" href="interaction.html#transient-activation">一時的なアクティブ化</a>を持たない場合にのみ考慮される。</p>

    <p><a href="#sandboxed-top-level-navigation-without-user-activation-browsing-context-flag" id="sandboxing:sandboxed-top-level-navigation-without-user-activation-browsing-context-flag-2">ユーザーによるアクティブ化なしでサンドボックス化されたトップレベルナビゲーションブラウジングコンテキストフラグ</a>が設定されて<em>いない</em>場合、コンテンツはその<a id="sandboxing:top-level-browsing-context-3" href="browsers.html#top-level-browsing-context">トップレベルブラウジングコンテキスト</a>をナビゲートすることができるが、他の<a href="browsers.html#browsing-context" id="sandboxing:browsing-context-3">ブラウジングコンテキスト</a>は、<a href="#sandboxed-navigation-browsing-context-flag" id="sandboxing:sandboxed-navigation-browsing-context-flag-2">サンドボックス化されたナビゲーションブラウジングコンテキストフラグ</a>、および<a href="#sandboxed-auxiliary-navigation-browsing-context-flag" id="sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag-3">サンドボックス化された補助ナビゲーションブラウジングコンテキストフラグ</a>によって保護されたままである。</p>
   <dt><dfn id="sandboxed-top-level-navigation-with-user-activation-browsing-context-flag" data-export="">ユーザーによるアクティブ化でサンドボックス化されたトップレベルナビゲーションブラウジングコンテキストフラグ</dfn><dd><p>このフラグは、<a href="browsing-the-web.html#sandboxLinks">それらの<span>トップレベルブラウジングコンテキスト</span>のナビゲートからコンテンツを防ぎ</a>、かつ<a href="window-object.html#sandboxClose">それらの<span>トップレベルブラウジングコンテキスト</span>の遮断からコンテンツを防ぐ</a>。サンドボックス化されたブラウジングコンテキストの<a id="sandboxing:active-window-2" href="browsers.html#active-window">アクティブウィンドウ</a>が<a id="sandboxing:transient-activation-2" href="interaction.html#transient-activation">一時的なアクティブ化</a>を持つ場合にのみ考慮される。</p>

    <p><a href="#sandboxed-top-level-navigation-without-user-activation-browsing-context-flag" id="sandboxing:sandboxed-top-level-navigation-without-user-activation-browsing-context-flag-3">ユーザーによるアクティブ化なしでサンドボックス化されたブラウジングコンテキストフラグ</a>と同様に、このフラグは<a id="sandboxing:top-level-browsing-context-4" href="browsers.html#top-level-browsing-context">トップレベルブラウジングコンテキスト</a>にのみ影響する。 設定されていない場合、他の<a href="browsers.html#browsing-context" id="sandboxing:browsing-context-4">ブラウジングコンテキスト</a>が他のフラグによって保護されている可能性がある。</p>
   <dt><dfn id="sandboxed-plugins-browsing-context-flag" data-export="">サンドボックス化されたプラグインブラウジングコンテキストフラグ</dfn><dd><p>このフラグは、<a href="iframe-embed-object.html#sandboxPluginEmbed"><code>embed</code>要素</a>、<a href="iframe-embed-object.html#sandboxPluginObject"><code>object</code>要素</a>を使用するか、または<a id="sandboxing:nested-browsing-context" href="browsers.html#nested-browsing-context">ネストされたブラウジングコンテキスト</a>の<a href="browsing-the-web.html#sandboxPluginNavigate">ナビゲーション</a>を介するかに関係なく、それらの<a href="infrastructure.html#plugin" id="sandboxing:plugin-2">プラグイン</a>が<a href="infrastructure.html#concept-plugin-secure" id="sandboxing:concept-plugin-secure">保護</a>されない限り、コンテンツが<a href="infrastructure.html#plugin" id="sandboxing:plugin">プラグイン</a>をインスタンス化できないようにする。<dt><dfn id="sandboxed-origin-browsing-context-flag" data-export="">サンドボックス化された生成元ブラウジングコンテキストフラグ</dfn><dd><p>このフラグは、<a href="browsers.html#sandboxOrigin">一意な生成元にコンテンツを強制する</a>。したがって、同一<a href="#concept-origin" id="sandboxing:concept-origin">生成元</a>から他のコンテンツにアクセスすることを防止する。</p>

    <p>このフラグはまた、<a href="dom.html#sandboxCookies"><code>document.cookie</code> IDL属性からの読み取りまたは書き込みをするスクリプトを防止し</a>、<code id="sandboxing:dom-localstorage"><a href="webstorage.html#dom-localstorage">localStorage</a></code>へのアクセスをブロックする。</p>
   <dt><dfn id="sandboxed-forms-browsing-context-flag" data-export="">サンドボックス化されたフォームブラウジングコンテキストフラグ</dfn><dd><p>このフラグは<a href="form-control-infrastructure.html#sandboxSubmitBlocked">フォーム送信をブロックする</a>。</p>
   <dt><dfn id="sandboxed-pointer-lock-browsing-context-flag" data-export="">サンドボックス化されたポインターロックブラウジングコンテキストフラグ</dfn><dd><p>このフラグはPointer Lock APIを無効にする。<a href="references.html#refsPOINTERLOCK">[POINTERLOCK]</a></p>
   <dt><dfn id="sandboxed-scripts-browsing-context-flag" data-export="">サンドボックス化されたスクリプトブラウジングコンテキストフラグ</dfn><dd><p>このフラグは、<a href="webappapis.html#sandboxScriptBlocked">スクリプトの実行をブロックする</a>。</p>
   <dt><dfn id="sandboxed-automatic-features-browsing-context-flag" data-export="">サンドボックス化された自動機能ブラウジングコンテキストフラグ</dfn><dd><p>このフラグは、<a href="media.html#attr-media-autoplay" id="sandboxing:attr-media-autoplay">自動ビデオ再生</a>や<a href="interaction.html#attr-fe-autofocus" id="sandboxing:attr-fe-autofocus">自動フォームコントロールフォーカス</a>などの、自動的に切り替える機能をブロックする。</p>
   <dt><dfn id="sandboxed-document.domain-browsing-context-flag" data-export="">サンドボックス化された<code>document.domain</code>ブラウジングコンテキストフラグ</dfn><dd><p>このフラグは、コンテンツが<code id="sandboxing:dom-document-domain"><a href="#dom-document-domain">document.domain</a></code>セッターを使用することから防ぐ。</p>
   <dt><dfn id="sandbox-propagates-to-auxiliary-browsing-contexts-flag" data-export="">サンドボックスが補助ブラウジングコンテキストに伝播するフラグ</dfn><dd><p>このフラグは、コンテンツが作成する<a id="sandboxing:auxiliary-browsing-context-2" href="browsers.html#auxiliary-browsing-context">補助ブラウジングコンテキスト</a>がコンテンツの<a href="#active-sandboxing-flag-set" id="sandboxing:active-sandboxing-flag-set">アクティブなサンドボックスフラグセット</a>を継承するのを保証することで、そのコンテンツがサンドボックスをエスケープするのを防ぐ。</p>
   <dt><dfn id="sandboxed-modals-flag" data-export="">サンドボックス化されたモーダルフラグ</dfn><dd><p>このフラグは、コンテンツが以下の機能のいずれかを使用してモーダルダイアログを生成するのを防ぐ：</p>

    <ul><li><code id="sandboxing:dom-alert"><a href="timers-and-user-prompts.html#dom-alert">window.alert()</a></code><li><code id="sandboxing:dom-confirm"><a href="timers-and-user-prompts.html#dom-confirm">window.confirm()</a></code><li><code id="sandboxing:dom-print"><a href="timers-and-user-prompts.html#dom-print">window.print()</a></code><li><code id="sandboxing:dom-prompt"><a href="timers-and-user-prompts.html#dom-prompt">window.prompt()</a></code><li><code id="sandboxing:event-beforeunload"><a href="indices.html#event-beforeunload">beforeunload</a></code>イベント</ul>
   <dt><dfn id="sandboxed-orientation-lock-browsing-context-flag" data-export="">サンドボックス化された方向ロックブラウジングコンテキストフラグ</dfn><dd><p>このフラグは、画面の向きをロックする機能を無効にする。<a href="references.html#refsSCREENORIENTATION">[SCREENORIENTATION]</a></p>
   <dt><dfn id="sandboxed-presentation-browsing-context-flag" data-export="">サンドボックス化されたプレゼンテーションブラウジングコンテキストフラグ</dfn><dd><p>このフラグはPresentation APIを無効にする。 <a href="references.html#refsPRESENTATION">[PRESENTATION]</a></p>
   <dt><dfn id="sandboxed-downloads-browsing-context-flag" data-export="">サンドボックス化されたダウンロードブラウジングコンテキストフラグ</dfn><dd><p>このフラグは、<a href="links.html#downloading-hyperlinks" id="sandboxing:downloading-hyperlinks">ハイパーリンクのダウンロード</a>または<a id="sandboxing:as-a-download" href="links.html#as-a-download">ダウンロードとして</a>処理される<a href="browsing-the-web.html#process-a-navigate-response" id="sandboxing:process-a-navigate-response">ナビゲーション</a>のいずれを介して、コンテンツがダウンロードを開始またはインスタンス化するのを防ぐ。</p>
   </dl>

  <p>When the user agent is to <dfn id="parse-a-sandboxing-directive" data-export="">parse a sandboxing directive</dfn>, given a string <var>input</var>, a <a href="#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set">sandboxing flag set</a> <var>output</var>, it must run the following steps:</p>

  <ol><li><p><a href="https://triple-underscore.github.io/infra-ja.html#split-on-ascii-whitespace" id="sandboxing:split-a-string-on-spaces" data-x-internal="split-a-string-on-spaces">Split <var>input</var> on ASCII whitespace</a>, to obtain <var>tokens</var>.<li><p><var>output</var>を空にする。<li><p><var>output</var>に次のフラグを追加する：</p>

    <ul><li><p><a href="#sandboxed-navigation-browsing-context-flag" id="sandboxing:sandboxed-navigation-browsing-context-flag-3">サンドボックス化されたナビゲーションブラウジングコンテキストフラグ</a><li><p><var>tokens</var>が<dfn id="attr-iframe-sandbox-allow-popups"><code>allow-popups</code></dfn>キーワードを含む場合を除いて、<a href="#sandboxed-auxiliary-navigation-browsing-context-flag" id="sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag-4">サンドボックス化された補助ナビゲーションブラウジングコンテキストフラグ</a><li><p>The <a href="#sandboxed-top-level-navigation-without-user-activation-browsing-context-flag" id="sandboxing:sandboxed-top-level-navigation-without-user-activation-browsing-context-flag-4">sandboxed top-level navigation without user activation browsing context flag</a>, unless <var>tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-top-navigation"><code>allow-top-navigation</code></dfn> keyword.<li><p>The <a href="#sandboxed-top-level-navigation-with-user-activation-browsing-context-flag" id="sandboxing:sandboxed-top-level-navigation-with-user-activation-browsing-context-flag-2">sandboxed top-level navigation with user activation browsing context flag</a>, unless <var>tokens</var> contains either the <dfn id="attr-iframe-sandbox-allow-top-navigation-by-user-activation"><code>allow-top-navigation-by-user-activation</code></dfn> keyword or the <code id="sandboxing:attr-iframe-sandbox-allow-top-navigation"><a href="#attr-iframe-sandbox-allow-top-navigation">allow-top-navigation</a></code> keyword.</p>

      <p class="note">This means that if the <code id="sandboxing:attr-iframe-sandbox-allow-top-navigation-2"><a href="#attr-iframe-sandbox-allow-top-navigation">allow-top-navigation</a></code> is present, the <code id="sandboxing:attr-iframe-sandbox-allow-top-navigation-by-user-activation"><a href="#attr-iframe-sandbox-allow-top-navigation-by-user-activation">allow-top-navigation-by-user-activation</a></code> keyword will have no effect. For this reason, specifying both is a document conformance error.</p>
     <li><p><a href="#sandboxed-plugins-browsing-context-flag" id="sandboxing:sandboxed-plugins-browsing-context-flag">サンドボックス化されたプラグインブラウジングコンテキストフラグ</a><li><p><var>tokens</var>が<dfn id="attr-iframe-sandbox-allow-same-origin"><code>allow-same-origin</code></dfn>キーワードを含む場合を除いて、<a href="#sandboxed-origin-browsing-context-flag" id="sandboxing:sandboxed-origin-browsing-context-flag">サンドボックス化された生成元ブラウジングコンテキストフラグ</a></p>

      <div class="note"><p><code id="sandboxing:attr-iframe-sandbox-allow-same-origin"><a href="#attr-iframe-sandbox-allow-same-origin">allow-same-origin</a></code>キーワードは2つの例を対象とする。</p>

       <p>1つ目は、依然としてサンドボックス化されたコンテンツのDOMへのアクセスを可能する一方で、スクリプトを無効にするためにサンドボックス化されるべき同じサイトからコンテンツを許可するために使用できる。</p>

       <p>2つ目は、サードパーティサイトからコンテンツを埋め込むために使用でき、データなどを格納するためにデータベースAPIを使用して、その元のサイトに戻る通信から埋め込まれたページを妨げることなく、ポップアップなどを開いてから、そのサイトを防ぐためにサンドボックス化する。</p>
      </div>
     <li><p><var>tokens</var>が<dfn id="attr-iframe-sandbox-allow-forms"><code>allow-forms</code></dfn>キーワードを含む場合を除いて、<a href="#sandboxed-forms-browsing-context-flag" id="sandboxing:sandboxed-forms-browsing-context-flag">サンドボックス化されたフォームブラウジングコンテキストフラグ</a><li><p><var>tokens</var>が<dfn id="attr-iframe-sandbox-allow-pointer-lock"><code>allow-pointer-lock</code></dfn>キーワードを含む場合を除いて、<a href="#sandboxed-pointer-lock-browsing-context-flag" id="sandboxing:sandboxed-pointer-lock-browsing-context-flag">サンドボックス化されたポインターロックブラウジングコンテキストフラグ</a><li><p><var>tokens</var>が<dfn id="attr-iframe-sandbox-allow-scripts"><code>allow-scripts</code></dfn>キーワードを含む場合を除いて、<a href="#sandboxed-scripts-browsing-context-flag" id="sandboxing:sandboxed-scripts-browsing-context-flag">サンドボックス化されたスクリプトブラウジングコンテキストフラグ</a><li><p><var>tokens</var>が（上記で定義された）<code id="sandboxing:attr-iframe-sandbox-allow-scripts"><a href="#attr-iframe-sandbox-allow-scripts">allow-scripts</a></code>キーワードを含む場合を除いて、<a href="#sandboxed-automatic-features-browsing-context-flag" id="sandboxing:sandboxed-automatic-features-browsing-context-flag">サンドボックス化された自動機能ブラウジングコンテキストフラグ</a></p>

      <p class="note">このフラグは、スクリプトと同じキーワードで緩和される。なぜなら、スクリプトが有効である場合にこれらの機能はいずれにせよ些細なことで実行でき、宣言的な機能を使用できるようにするよりむしろサンドボックス化された場合に、著者がそれら機能を実行するためのスクリプトを使用するよう強制することが不幸であるためである。</p>
     <li><p><a href="#sandboxed-document.domain-browsing-context-flag" id="sandboxing:sandboxed-document.domain-browsing-context-flag">サンドボックス化された<code>document.domain</code>ブラウジングコンテキストフラグ</a>。<li><p>The <a href="#sandbox-propagates-to-auxiliary-browsing-contexts-flag" id="sandboxing:sandbox-propagates-to-auxiliary-browsing-contexts-flag">sandbox propagates to auxiliary browsing contexts flag</a>, unless <var>tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-popups-to-escape-sandbox"><code>allow-popups-to-escape-sandbox</code></dfn> keyword.<li><p>The <a href="#sandboxed-modals-flag" id="sandboxing:sandboxed-modals-flag">sandboxed modals flag</a>, unless <var>tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-modals"><code>allow-modals</code></dfn> keyword.<li><p>The <a href="#sandboxed-orientation-lock-browsing-context-flag" id="sandboxing:sandboxed-orientation-lock-browsing-context-flag">sandboxed orientation lock browsing context flag</a>, unless <var>tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-orientation-lock"><code>allow-orientation-lock</code></dfn> keyword.<li><p>The <a href="#sandboxed-presentation-browsing-context-flag" id="sandboxing:sandboxed-presentation-browsing-context-flag">sandboxed presentation browsing context flag</a>, unless <var>tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-presentation"><code>allow-presentation</code></dfn> keyword.<li><p>The <a href="#sandboxed-downloads-browsing-context-flag" id="sandboxing:sandboxed-downloads-browsing-context-flag">sandboxed downloads browsing context flag</a>, unless <var> tokens</var> contains the <dfn id="attr-iframe-sandbox-allow-downloads"><code>allow-downloads</code></dfn> keyword.</ul>
   </ol>

  <hr>

  <p>すべての<a id="sandboxing:top-level-browsing-context-5" href="browsers.html#top-level-browsing-context">トップレベルブラウジングコンテキスト</a>は、<dfn id="popup-sandboxing-flag-set">ポップアップサンドボックス化 フラグセット</dfn>を持ち、これは<a href="#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set-2">サンドボックス化フラグセット</a>である。<a id="sandboxing:browsing-context-5" href="browsers.html#browsing-context">ブラウジングコンテキスト</a>が作成される場合、その<a href="#popup-sandboxing-flag-set" id="sandboxing:popup-sandboxing-flag-set">ポップアップサンド化フラグセット</a>は空でなければならない。これは、<a id="sandboxing:the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name" href="browsers.html#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name">ブラウジングコンテキストを選択するための規則</a>と、<a href="#obtain-browsing-context-navigation" id="sandboxing:obtain-browsing-context-navigation">ナビゲーション応答に使用するブラウジングコンテキストを取得する</a>ためのアルゴリズムで構成されている。</p>

  <p>すべての<code id="sandboxing:the-iframe-element"><a href="iframe-embed-object.html#the-iframe-element">iframe</a></code>要素は、<dfn id="iframe-sandboxing-flag-set"><code>iframe</code>サンドボックス化フラグセット</dfn>を持ち、これは<a href="#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set-3">サンドボックス化フラグセット</a>である。<a href="#iframe-sandboxing-flag-set" id="sandboxing:iframe-sandboxing-flag-set"><code>iframe</code>サンドボックス化フラグセット</a>のどのフラグが特定の時間にセットされるかは、<code id="sandboxing:the-iframe-element-2"><a href="iframe-embed-object.html#the-iframe-element">iframe</a></code>要素の<code id="sandboxing:attr-iframe-sandbox"><a href="iframe-embed-object.html#attr-iframe-sandbox">sandbox</a></code> 属性によって決定される。</p>

  <p>すべての<code id="sandboxing:document"><a href="dom.html#document">Document</a></code>は、<dfn data-dfn-for="Document" id="active-sandboxing-flag-set" data-export="">アクティブなサンドボックス化フラグセット</dfn>を持ち、これは<a href="#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set-4">サンドボックス化フラグセット</a>である、<code id="sandboxing:document-2"><a href="dom.html#document">Document</a></code>が作成される場合、その<a href="#active-sandboxing-flag-set" id="sandboxing:active-sandboxing-flag-set-2">アクティブなサンドボックス化フラグセット</a>は空でなければならない。それは、<a href="browsing-the-web.html#navigate" id="sandboxing:navigate">ナビゲーションアルゴリズム</a>によって追加される。</p>

  <p><a href="browsing-the-web.html#navigate" id="sandboxing:navigate-2">ナビゲーションアルゴリズム</a>によって得られるすべてのリソースは、<dfn id="forced-sandboxing-flag-set" data-export="">強制サンドボックス化フラグセット</dfn>を持ち、これは<a href="#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set-5">サンドボックス化フラグセット</a>である。デフォルトでリソースは、その<a href="#forced-sandboxing-flag-set" id="sandboxing:forced-sandboxing-flag-set">強制サンドボックス化フラグセット</a>で設定されるフラグを持たないが、他の仕様は、特定のフラグがセットされていることを定義できる。</p>

  <p class="note">具体的には、<a href="#forced-sandboxing-flag-set" id="sandboxing:forced-sandboxing-flag-set-2">強制サンドボックス化フラグセット</a>が<cite>Content Security Policy</cite>によって使用される。<a href="references.html#refsCSP">[CSP]</a></p>

  <hr>

  <p>nullまたは要素<var>embedder</var>を与えられた、<a href="browsers.html#concept-document-bc" id="sandboxing:concept-document-bc">ブラウジングコンテキスト</a><var>browsing context</var>の<dfn id="determining-the-creation-sandboxing-flags">作成サンドボックス化フラグを決定する</dfn>ためには、次の<a href="#sandboxing-flag-set" id="sandboxing:sandboxing-flag-set-6">サンドボックス化フラグセット</a>に存在するフラグの<a href="https://triple-underscore.github.io/infra-ja.html#set-union" id="sandboxing:set-union" data-x-internal="set-union">和</a>を返す。</p>

  <ul><li><p><var>embedder</var>がnullである場合：<var>browsing context</var>の<a href="#popup-sandboxing-flag-set" id="sandboxing:popup-sandboxing-flag-set-2">ポップアップサンドボックス化フラグセット</a>のフラグセット。<li><p><var>embedder</var>が要素である場合：<var>embedder</var>の<a href="#iframe-sandboxing-flag-set" id="sandboxing:iframe-sandboxing-flag-set-2"><code>iframe</code>サンドボックス化フラグセット</a>のフラグセット。<li><p><var>embedder</var>が要素である場合：<var>embedder</var>の<a id="sandboxing:node-document" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">ノード文書</a>の<a href="#active-sandboxing-flag-set" id="sandboxing:active-sandboxing-flag-set-3">アクティブなサンドボックス化フラグセット</a>のフラグセット。</ul>

  <p>作成後、<a href="browsers.html#concept-document-bc" id="sandboxing:concept-document-bc-2">ブラウジングコンテキスト</a><var>browsing context</var>の<dfn id="concept-bc-sandboxing-flags">サンドボックス化フラグ</dfn>は、<var>browsing context</var>および<var>browsing context</var>の<a href="browsers.html#bc-container" id="sandboxing:bc-container">コンテナー</a>に与えられた<a href="#determining-the-creation-sandboxing-flags" id="sandboxing:determining-the-creation-sandboxing-flags">作成サンドボックス化フラグを決定した</a>結果となる。<h3 id="cross-origin-opener-policies"><span class="secno">7.7</span> 生成元をまたいだオープナーポリシー<a href="#cross-origin-opener-policies" class="self-link"></a></h3>

  <p><dfn id="cross-origin-opener-policy">生成元をまたいだオープナーポリシー</dfn>は、<a id="cross-origin-opener-policies:top-level-browsing-context" href="browsers.html#top-level-browsing-context">トップレベルブラウジングコンテキスト</a>にナビゲートされたドキュメントに対し、新しい<a id="cross-origin-opener-policies:top-level-browsing-context-2" href="browsers.html#top-level-browsing-context">トップレベルブラウジングコンテキスト</a>および、それに対応する<a href="browsers.html#tlbc-group" id="cross-origin-opener-policies:tlbc-group">グループ</a>の作成を強制できる。次のいずれかの値を持つ：</p>

  <dl><dt>"<dfn id="coop-unsafe-none"><code>unsafe-none</code></dfn>"<dd><p>これは（現在の）デフォルトであり、文書が別の<a href="#cross-origin-opener-policy" id="cross-origin-opener-policies:cross-origin-opener-policy">生成元をまたいだオープナーポリシー</a>を指定しない限り、文書がその前の文書と同じ<a id="cross-origin-opener-policies:top-level-browsing-context-3" href="browsers.html#top-level-browsing-context">トップレベルブラウジングコンテキスト</a>を占有することを意味する。<dt>"<dfn id="coop-same-origin-allow-popups"><code>same-origin-allow-popups</code></dfn>"<dd><p>これは、前の文書が同じ<a href="#cross-origin-opener-policy" id="cross-origin-opener-policies:cross-origin-opener-policy-2">生成元をまたいだオープナーポリシー</a>を指定しており、それらが<a href="#same-origin" id="cross-origin-opener-policies:same-origin">同一生成元</a>でない限り、文書の新しい<a id="cross-origin-opener-policies:top-level-browsing-context-4" href="browsers.html#top-level-browsing-context">トップレベルブラウジングコンテキスト</a>を強制的に作成する。<dt>"<dfn id="coop-same-origin"><code>same-origin</code></dfn>"<dd><p>これは、"<code id="cross-origin-opener-policies:coop-same-origin-allow-popups"><a href="#coop-same-origin-allow-popups">same-origin-allow-popups</a></code>"と同じように動作するが、作成される<a id="cross-origin-opener-policies:auxiliary-browsing-context" href="browsers.html#auxiliary-browsing-context">補助ブラウジングコンテキスト</a>は、同じ<a href="#cross-origin-opener-policy" id="cross-origin-opener-policies:cross-origin-opener-policy-3">生成元をまたいだオープナーポリシー</a>を持つ<a href="#same-origin" id="cross-origin-opener-policies:same-origin-2">同一生成元</a>の文書を含める必要があることが追加される。さもなければ、オープナーに非公開で表示される。<dt>"<dfn id="coop-same-origin-plus-coep"><code>same-origin-plus-COEP</code></dfn>"<dd><p>これは"<code id="cross-origin-opener-policies:coop-same-origin"><a href="#coop-same-origin">same-origin</a></code>"と同じように動作するが、（新しい）<a id="cross-origin-opener-policies:top-level-browsing-context-5" href="browsers.html#top-level-browsing-context">トップレベルブラウジングコンテキスト</a>の<a href="browsers.html#tlbc-group" id="cross-origin-opener-policies:tlbc-group-2">グループ</a>の<a href="browsers.html#bcg-cross-origin-isolated" id="cross-origin-opener-policies:bcg-cross-origin-isolated">生成元をまたいだ分離</a>をtrueに設定することが追加される。</p>

    <p class="note">"<code id="cross-origin-opener-policies:coop-same-origin-plus-coep"><a href="#coop-same-origin-plus-coep">same-origin-plus-COEP</a></code>" は、`<code id="cross-origin-opener-policies:cross-origin-opener-policy-2-2"><a href="iana.html#cross-origin-opener-policy-2">Cross-Origin-Opener-Policy</a></code>`ヘッダーで直接設定することはできないが、`<code><a href="iana.html#cross-origin-opener-policy-2" id="cross-origin-opener-policies:cross-origin-opener-policy-2-3">Cross-Origin-Opener-Policy</a>: <a href="#coop-same-origin" id="cross-origin-opener-policies:coop-same-origin-2">same-origin</a></code>` と`<code><a id="cross-origin-opener-policies:cross-origin-embedder-policy" href="iana.html#cross-origin-embedder-policy">Cross-Origin-Embedder-Policy</a>: require-corp</code>`の両方を一緒に設定した組み合わせから生じる。</p>
   </dl>

  <p><dfn id="matching-coop">生成元をまたいだオープナーポリシーを照合する</dfn>には、<a href="#cross-origin-opener-policy" id="cross-origin-opener-policies:cross-origin-opener-policy-4">生成元をまたいだオープナーポリシー</a><var>A</var>、<a href="#concept-origin" id="cross-origin-opener-policies:concept-origin">生成元</a><var>originA</var>、<a href="#cross-origin-opener-policy" id="cross-origin-opener-policies:cross-origin-opener-policy-5">生成元をまたいだオープナーポリシー</a><var>B</var>、<a href="#concept-origin" id="cross-origin-opener-policies:concept-origin-2">生成元</a><var>originB</var>を指定した場合に：</p>

  <ol><li><p><var>A</var>が"<code id="cross-origin-opener-policies:coop-unsafe-none"><a href="#coop-unsafe-none">unsafe-none</a></code>"かつ<var>B</var>が"<code id="cross-origin-opener-policies:coop-unsafe-none-2"><a href="#coop-unsafe-none">unsafe-none</a></code>"である場合、trueを返す。<li><p><var>A</var>が"<code id="cross-origin-opener-policies:coop-unsafe-none-3"><a href="#coop-unsafe-none">unsafe-none</a></code>"または<var>B</var>が"<code id="cross-origin-opener-policies:coop-unsafe-none-4"><a href="#coop-unsafe-none">unsafe-none</a></code>"である場合、falseを返す。<li><p><var>A</var>が<var>B</var>であり、かつ<var>originA</var>が"<var>originB</var>をもつ<a href="#same-origin" id="cross-origin-opener-policies:same-origin-3">同一生成元</a>である場合、trueを返す。<li><p>falseを返す。</ol>

  <h4 id="the-cross-origin-opener-policy-header"><span class="secno">7.7.1</span> `<code id="the-cross-origin-opener-policy-header:cross-origin-opener-policy-2"><a href="iana.html#cross-origin-opener-policy-2">Cross-Origin-Opener-Policy</a></code>` ヘッダー<a href="#the-cross-origin-opener-policy-header" class="self-link"></a></h4>

  <p><code id="the-cross-origin-opener-policy-header:document"><a href="dom.html#document">Document</a></code>の<a href="dom.html#concept-document-coop" id="the-cross-origin-opener-policy-header:concept-document-coop">生成元をまたいだオープナーポリシー</a>は  `<code id="the-cross-origin-opener-policy-header:cross-origin-opener-policy-2-2"><a href="iana.html#cross-origin-opener-policy-2">Cross-Origin-Opener-Policy</a></code>` HTTPレスポンスヘッダーから派生する。このヘッダーは<a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html" id="the-cross-origin-opener-policy-header:http-structured-header" data-x-internal="http-structured-header">構造化されたヘッダー</a>であり、その値は<a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html#token" id="the-cross-origin-opener-policy-header:http-structured-header-token" data-x-internal="http-structured-header-token">トークン</a>でなければならない。<a href="references.html#refsSTRUCTURED-FIELDS">[STRUCTURED-FIELDS]</a></p>

  <p>妥当な<a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html#token" id="the-cross-origin-opener-policy-header:http-structured-header-token-2" data-x-internal="http-structured-header-token">トークン</a>値は、"<code id="the-cross-origin-opener-policy-header:coop-unsafe-none"><a href="#coop-unsafe-none">unsafe-none</a></code>"、"<code id="the-cross-origin-opener-policy-header:coop-same-origin-allow-popups"><a href="#coop-same-origin-allow-popups">same-origin-allow-popups</a></code>"、および"<code id="the-cross-origin-opener-policy-header:coop-same-origin"><a href="#coop-same-origin">same-origin</a></code>"である。</p>

  <p class="note">以下に説明する処理モデルに従って、ユーザーエージェントは、このヘッダーに無効な値が含まれている場合、そのヘッダーを無視する。同様に、値が<a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html#token" id="the-cross-origin-opener-policy-header:http-structured-header-token-3" data-x-internal="http-structured-header-token">トークン</a>として解析できない場合、ユーザーエージェントはこのヘッダーを無視する。</p>

  <hr>

  <p>To <dfn id="obtain-coop">obtain a cross-origin opener policy</dfn> given a <a href="https://triple-underscore.github.io/Fetch-ja.html#concept-response" id="the-cross-origin-opener-policy-header:concept-response" data-x-internal="concept-response">response</a> <var>response</var> and an <a id="the-cross-origin-opener-policy-header:environment" href="webappapis.html#environment">environment</a> <var>reservedEnvironment</var>:</p>

  <ol><li><p>If <var>reservedEnvironment</var> is a <a id="the-cross-origin-opener-policy-header:non-secure-context" href="webappapis.html#non-secure-context">non-secure context</a>, then return "<code id="the-cross-origin-opener-policy-header:coop-unsafe-none-2"><a href="#coop-unsafe-none">unsafe-none</a></code>".<li><p>Let <var>value</var> be the result of <a id="the-cross-origin-opener-policy-header:getting-a-structured-field-value" href="https://triple-underscore.github.io/Fetch-ja.html#concept-header-list-get-structured-header" data-x-internal="getting-a-structured-field-value">getting a structured field value</a> given `<code id="the-cross-origin-opener-policy-header:cross-origin-opener-policy-2-3"><a href="iana.html#cross-origin-opener-policy-2">Cross-Origin-Opener-Policy</a></code>` and "<code>item</code>" from <var>response</var>'s <a href="https://triple-underscore.github.io/Fetch-ja.html#concept-response-header-list" id="the-cross-origin-opener-policy-header:concept-response-header-list" data-x-internal="concept-response-header-list">header list</a>.<li><p>If <var>value</var> is null, then return "<code id="the-cross-origin-opener-policy-header:coop-unsafe-none-3"><a href="#coop-unsafe-none">unsafe-none</a></code>".<li><p>If <var>value</var>[0] is not "<code id="the-cross-origin-opener-policy-header:coop-same-origin-2"><a href="#coop-same-origin">same-origin</a></code>" or "<code id="the-cross-origin-opener-policy-header:coop-same-origin-allow-popups-2"><a href="#coop-same-origin-allow-popups">same-origin-allow-popups</a></code>", then return "<code id="the-cross-origin-opener-policy-header:coop-unsafe-none-4"><a href="#coop-unsafe-none">unsafe-none</a></code>".<li><p>If <var>value</var>[0] is "<code id="the-cross-origin-opener-policy-header:coop-same-origin-3"><a href="#coop-same-origin">same-origin</a></code>", then:</p>

    <ol><li><p>Let <var>coep</var> be the result of <a href="#obtain-an-embedder-policy" id="the-cross-origin-opener-policy-header:obtain-an-embedder-policy">obtaining an embedder policy</a> from <var>response</var>.<li><p>If <var>coep</var>'s <a href="#embedder-policy-value-2" id="the-cross-origin-opener-policy-header:embedder-policy-value-2">value</a> is "<code>require-corp</code>", then return "<code id="the-cross-origin-opener-policy-header:coop-same-origin-plus-coep"><a href="#coop-same-origin-plus-coep">same-origin-plus-COEP</a></code>".</ol>
   <li><p>Return <var>value</var>[0].</ol>

  <h4 id="browsing-context-group-switches-due-to-cross-origin-opener-policy"><span class="secno">7.7.2</span> Browsing context group switches due to cross-origin opener policy<a href="#browsing-context-group-switches-due-to-cross-origin-opener-policy" class="self-link"></a></h4>

  <p>A <dfn id="coop-enforcement-result">cross-origin opener policy enforcement result</dfn> is a <a id="browsing-context-group-switches-due-to-cross-origin-opener-policy:struct" href="https://triple-underscore.github.io/infra-ja.html#struct" data-x-internal="struct">struct</a> with the following <a href="https://triple-underscore.github.io/infra-ja.html#struct-item" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:struct-item" data-x-internal="struct-item">items</a>:</p>

  <ul><li><p>A boolean <dfn id="coop-enforcement-bcg-switch">needs a browsing context group switch</dfn>.<li><p>An <a href="#concept-origin" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:concept-origin">origin</a> <dfn id="coop-enforcement-origin">origin</dfn>.<li><p>A <a href="#cross-origin-opener-policy" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:cross-origin-opener-policy">cross-origin opener policy</a> <dfn id="coop-enforcement-coop">cross-origin opener policy</dfn>.</ul>

  <p>To <dfn id="coop-enforce">enforce a response's cross-origin opener policy</dfn>, given a <a id="browsing-context-group-switches-due-to-cross-origin-opener-policy:browsing-context" href="browsers.html#browsing-context">browsing context</a> <var>browsingContext</var>, an <a href="#concept-origin" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:concept-origin-2">origin</a> <var>responseOrigin</var>, a <a href="#cross-origin-opener-policy" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:cross-origin-opener-policy-2">cross-origin opener policy</a> <var>responseCOOP</var>, and a <a href="#coop-enforcement-result" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-enforcement-result">cross-origin opener policy enforcement result</a> <var>currentCOOPEnforcementResult</var>:</p>

  <ol><li><p>Let <var>newCOOPEnforcementResult</var> be a new <a href="#coop-enforcement-result" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-enforcement-result-2">cross-origin opener policy enforcement result</a> whose <a href="#coop-enforcement-bcg-switch" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-enforcement-bcg-switch">needs a browsing context group switch</a> is <var>currentCOOPEnforcementResult</var>'s <a href="#coop-enforcement-bcg-switch" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-enforcement-bcg-switch-2">needs a browsing context group switch</a>, <a href="#coop-enforcement-origin" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-enforcement-origin">origin</a> is <var>responseOrigin</var>, and <a href="#coop-enforcement-coop" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-enforcement-coop">cross-origin opener policy</a> is <var>responseCOOP</var>.<li><p>Let <var>isInitialAboutBlank</var> be false.<li><p>If <var>browsingContext</var>'s only entry in its <a id="browsing-context-group-switches-due-to-cross-origin-opener-policy:session-history" href="history.html#session-history">session history</a> is the <code id="browsing-context-group-switches-due-to-cross-origin-opener-policy:about:blank"><a href="infrastructure.html#about:blank">about:blank</a></code> <code id="browsing-context-group-switches-due-to-cross-origin-opener-policy:document"><a href="dom.html#document">Document</a></code> that was added when <var>browsingContext</var> was <a href="browsers.html#creating-a-new-browsing-context" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:creating-a-new-browsing-context">created</a>, then set <var>isInitialAboutBlank</var> to true.<li><p>If the result of <a href="#matching-coop" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:matching-coop">matching</a> <var>currentCOOPEnforcementResult</var>'s <a href="#coop-enforcement-coop" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-enforcement-coop-2">cross-origin opener policy</a>, <var>currentCOOPEnforcementResult</var>'s <a href="#coop-enforcement-origin" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-enforcement-origin-2">origin</a>, <var>responseCOOP</var>, and <var>responseOrigin</var> is true, then return <var>newCOOPEnforcementResult</var>.<li><p>If all of the following are true:</p>

    <ul class="brief"><li><p><var>isInitialAboutBlank</var><li><p><var>currentCOOPEnforcementResult</var>'s <a href="#coop-enforcement-coop" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-enforcement-coop-3">cross-origin opener policy</a> is "<code id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-same-origin-allow-popups"><a href="#coop-same-origin-allow-popups">same-origin-allow-popups</a></code>"<li><p><var>responseCOOP</var> is "<code id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-unsafe-none"><a href="#coop-unsafe-none">unsafe-none</a></code>"</ul>

    <p>then return <var>newCOOPEnforcementResult</var>.</p>
   <li><p>Set <var>newCOOPEnforcementResult</var>'s <a href="#coop-enforcement-bcg-switch" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-enforcement-bcg-switch-3">needs a browsing context group switch</a> to true.<li><p>Return <var>newCOOPEnforcementResult</var>.</ol>

  <p>To <dfn id="obtain-browsing-context-navigation">obtain a browsing context to use for a navigation response</dfn>, given a <a href="browsers.html#browsing-context" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:browsing-context-2">browsing context</a> <var>browsingContext</var>, a <a href="#sandboxing-flag-set" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:sandboxing-flag-set">sandboxing flag set</a> <var>sandboxFlags</var>, and a <a href="#cross-origin-opener-policy" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:cross-origin-opener-policy-3">cross-origin opener policy</a> <var>navigationCOOP</var>:</p>

  <ol><li><p>Assert: <var>browsingContext</var> is a <a id="browsing-context-group-switches-due-to-cross-origin-opener-policy:top-level-browsing-context" href="browsers.html#top-level-browsing-context">top-level browsing context</a>.<li><p>Let <var>newBrowsingContext</var> be the result of <a id="browsing-context-group-switches-due-to-cross-origin-opener-policy:creating-a-new-top-level-browsing-context" href="browsers.html#creating-a-new-top-level-browsing-context">creating a new top-level browsing context</a>.<li><p>If <var>navigationCOOP</var> is "<code id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-same-origin-plus-coep"><a href="#coop-same-origin-plus-coep">same-origin-plus-COEP</a></code>", then set <var>newBrowsingContext</var>'s <a href="browsers.html#tlbc-group" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:tlbc-group">group</a>'s <a href="browsers.html#bcg-cross-origin-isolated" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:bcg-cross-origin-isolated">cross-origin isolated</a> to true.<li><p>If <var>sandboxFlags</var> is not empty, then:</p>
    <ol><li><p>Assert: <var>navigationCOOP</var> is "<code id="browsing-context-group-switches-due-to-cross-origin-opener-policy:coop-unsafe-none-2"><a href="#coop-unsafe-none">unsafe-none</a></code>".<li><p>Assert: <var>newBrowsingContext</var>'s <a href="#popup-sandboxing-flag-set" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:popup-sandboxing-flag-set">popup sandboxing flag set</a> <a href="https://triple-underscore.github.io/infra-ja.html#list-empty" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:list-is-empty" data-x-internal="list-is-empty">is empty</a>.<li><p>Set <var>newBrowsingContext</var>'s <a href="#popup-sandboxing-flag-set" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:popup-sandboxing-flag-set-2">popup sandboxing flag set</a> to a <a href="https://triple-underscore.github.io/infra-ja.html#list-clone" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:list-clone" data-x-internal="list-clone">clone</a> of <var>sandboxFlags</var>.</ol>
   <li><p><a href="window-object.html#a-browsing-context-is-discarded" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:a-browsing-context-is-discarded">Discard</a> <var>browsingContext</var>.</p>

    <p class="note">This has no effect on <var>browsingContext</var>'s <a href="browsers.html#tlbc-group" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:tlbc-group-2">group</a>, unless <var>browsingContext</var> was its sole <a id="browsing-context-group-switches-due-to-cross-origin-opener-policy:top-level-browsing-context-2" href="browsers.html#top-level-browsing-context">top-level browsing context</a>. In that case, the user agent might delete the <a id="browsing-context-group-switches-due-to-cross-origin-opener-policy:browsing-context-group" href="browsers.html#browsing-context-group">browsing context group</a> which no longer contains any <a href="browsers.html#browsing-context" id="browsing-context-group-switches-due-to-cross-origin-opener-policy:browsing-context-3">browsing contexts</a>.</p>
   <li><p>Return <var>newBrowsingContext</var>.</ol>

  <p class="XXX">The impact of swapping browsing context groups following a navigation is not fully defined. It is currently under discussion in <a href="https://github.com/whatwg/html/issues/5350">issue #5350</a>.</p>



  <h3 id="coep"><span class="secno">7.8</span> 生成元をまたいだ埋め込みポリシー<a href="#coep" class="self-link"></a></h3>

  <p><dfn id="embedder-policy-value" data-export="">埋め込みポリシー値</dfn>は、リソース所有者から明示的に許可されていない生成元をまたいだリソースの取得を制御する。そのような値は2つある：</p>

  <dl><dt>"<dfn data-dfn-for="embedder policy value" id="coep-unsafe-none" data-export=""><code>unsafe-none</code></dfn>"<dd><p>これはデフォルトの値である。この値を使用するとき、<a id="coep:cors-protocol" href="https://triple-underscore.github.io/Fetch-ja.html#http-cors-protocol" data-x-internal="cors-protocol">CORSプロトコル</a>または`<code id="coep:cross-origin-resource-policy"><a data-x-internal="cross-origin-resource-policy" href="https://triple-underscore.github.io/Fetch-ja.html#http-cross-origin-resource-policy">Cross-Origin-Resource-Policy</a></code>`ヘッダーを通して明示的な許可を与えることなしに生成元をまたいだリソースをフェッチすることができる。<dt>"<dfn data-dfn-for="embedder policy value" id="coep-require-corp" data-export=""><code>require-corp</code></dfn>"<dd><p>この値を使用するとき、生成元をまたいだリソースをフェッチするには、<a id="coep:cors-protocol-2" href="https://triple-underscore.github.io/Fetch-ja.html#http-cors-protocol" data-x-internal="cors-protocol">CORSプロトコル</a>または`<code id="coep:cross-origin-resource-policy-2"><a data-x-internal="cross-origin-resource-policy" href="https://triple-underscore.github.io/Fetch-ja.html#http-cross-origin-resource-policy">Cross-Origin-Resource-Policy</a></code>`ヘッダーを通してサーバーの明示的な許可が必要となる。</dl>

  <p><dfn id="embedder-policy" data-export="">埋め込みポリシー</dfn>は次で構成される：</p>

  <ul><li><p><dfn data-dfn-for="embedder policy" id="embedder-policy-value-2" data-export="">値</dfn>。これは<a href="#embedder-policy-value" id="coep:embedder-policy-value">埋め込みポリシー値</a>であり、初期は"<code id="coep:coep-unsafe-none"><a href="#coep-unsafe-none">unsafe-none</a></code>"。<li><p><dfn data-dfn-for="embedder policy" id="embedder-policy-reporting-endpoint" data-export="">報告エンドポイント</dfn>文字列。初期は空文字列。<li><p><dfn data-dfn-for="embedder policy" id="embedder-policy-report-only-value" data-export="">報告のみの値</dfn>。これは<a href="#embedder-policy-value" id="coep:embedder-policy-value-2">埋め込みポリシー値</a>であり、初期は"<code id="coep:coep-unsafe-none-2"><a href="#coep-unsafe-none">unsafe-none</a></code>"。<li><p><dfn data-dfn-for="embedder
   policy" id="embedder-policy-report-only-reporting-endpoint" data-export="">報告のみの報告エンドポイント</dfn>文字列。初期は空文字列。</ul>

  <p><dfn id="coep-report-type" data-export="">"<code>coep</code>"報告タイプ</dfn>は、値が"<code>coep</code>"となる<a id="coep:report-type" href="https://w3c.github.io/reporting/#report-type" data-x-internal="report-type">報告タイプ</a>である。これは<a id="coep:visible-to-reportingobservers" href="https://w3c.github.io/reporting/#visible-to-reportingobservers" data-x-internal="visible-to-reportingobservers"><code>ReportingObserver</code>から可視</a>である。</p>

  <h4 id="the-headers"><span class="secno">7.8.1</span> ヘッダー<a href="#the-headers" class="self-link"></a></h4>

  <p>`<code id="the-headers:cross-origin-embedder-policy"><a href="iana.html#cross-origin-embedder-policy">Cross-Origin-Embedder-Policy</a></code>`および`<code id="the-headers:cross-origin-embedder-policy-report-only"><a href="iana.html#cross-origin-embedder-policy-report-only">Cross-Origin-Embedder-Policy-Report-Only</a></code>` HTTP レスポンスヘッダーフィールドは、サーバーが<a id="the-headers:environment-settings-object" href="webappapis.html#environment-settings-object">環境設定オブジェクト</a>の<a href="#embedder-policy" id="the-headers:embedder-policy">埋め込みポリシー</a>を宣言することを可能にする。このヘッダーは<a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html" id="the-headers:http-structured-header" data-x-internal="http-structured-header">構造化されたヘッダー</a>であり、その値は<a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html#token" id="the-headers:http-structured-header-token" data-x-internal="http-structured-header-token">トークン</a>でなければならない。<a href="references.html#refsSTRUCTURED-FIELDS">[STRUCTURED-FIELDS]</a><p>妥当な<a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html#token" id="the-headers:http-structured-header-token-2" data-x-internal="http-structured-header-token">トークン</a>の値は、<a href="#embedder-policy-value" id="the-headers:embedder-policy-value">埋め込みポリシー値</a>である。トークンはまた、付属の<a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-header-structure.html#param" id="the-headers:http-structured-header-parameters" data-x-internal="http-structured-header-parameters">パラメーター</a>を持ってもよい。これらのうち、"<dfn id="coep-report-to"><code>report-to</code></dfn>"パラメーターは、適切な報告エンドポイントを識別する<a id="the-headers:valid-url-string" href="https://triple-underscore.github.io/URL-ja.html#valid-url-string" data-x-internal="valid-url-string">妥当なURL文字列</a>を持つことができる。<a href="references.html#refsREPORTING">[REPORTING]</a></p>

  <div class="note"><p><a href="#obtain-an-embedder-policy" id="the-headers:obtain-an-embedder-policy">処理モデル</a>は、トークンとして解析できないヘッダーの存在下ではオープンに失敗する（デフォルトで"<code id="the-headers:coep-unsafe-none"><a href="#coep-unsafe-none">unsafe-none</a></code>"）。これには、与えられた応答に存在する`<code id="the-headers:cross-origin-embedder-policy-2"><a href="iana.html#cross-origin-embedder-policy">Cross-Origin-Embedder-Policy</a></code>`ヘッダーの複数のインスタンスを組み合わせて作成された不注意なリストが含まれる。</p>

   <table class="data"><thead><tr><th>`<code id="the-headers:cross-origin-embedder-policy-3"><a href="iana.html#cross-origin-embedder-policy">Cross-Origin-Embedder-Policy</a></code>`<th>最終<a href="#embedder-policy-value" id="the-headers:embedder-policy-value-2">埋め込みポリシー値</a><tbody><tr><td><em>No header delivered</em><td>"<code id="the-headers:coep-unsafe-none-2"><a href="#coep-unsafe-none">unsafe-none</a></code>"<tr><td>`<code>require-corp</code>`<td>"<code id="the-headers:coep-require-corp"><a href="#coep-require-corp">require-corp</a></code>"<tr><td>`<code>unknown-value</code>`<td>"<code id="the-headers:coep-unsafe-none-3"><a href="#coep-unsafe-none">unsafe-none</a></code>"<tr><td>`<code>require-corp, unknown-value</code>`<td>"<code id="the-headers:coep-unsafe-none-4"><a href="#coep-unsafe-none">unsafe-none</a></code>"<tr><td>`<code>unknown-value, unknown-value</code>`<td>"<code id="the-headers:coep-unsafe-none-5"><a href="#coep-unsafe-none">unsafe-none</a></code>"<tr><td>`<code>unknown-value, require-corp</code>`<td>"<code id="the-headers:coep-unsafe-none-6"><a href="#coep-unsafe-none">unsafe-none</a></code>"<tr><td>`<code>require-corp, require-corp</code>`<td>"<code id="the-headers:coep-unsafe-none-7"><a href="#coep-unsafe-none">unsafe-none</a></code>"</table>

   <p>（同じことが`<code id="the-headers:cross-origin-embedder-policy-report-only-2"><a href="iana.html#cross-origin-embedder-policy-report-only">Cross-Origin-Embedder-Policy-Report-Only</a></code>`にも適用される。）</p>
  </div>

  <hr>

  <p>To <dfn id="obtain-an-embedder-policy" data-export="">obtain an embedder policy</dfn> from a <a href="https://triple-underscore.github.io/Fetch-ja.html#concept-response" id="the-headers:concept-response" data-x-internal="concept-response">response</a> <var>response</var>:</p>

  <ol><li><p>Let <var>policy</var> be a new <a href="#embedder-policy" id="the-headers:embedder-policy-2">embedder policy</a>.<li><p>Let <var>parsedItem</var> be the result of <a id="the-headers:getting-a-structured-field-value" href="https://triple-underscore.github.io/Fetch-ja.html#concept-header-list-get-structured-header" data-x-internal="getting-a-structured-field-value">getting a structured field value</a> with `<code id="the-headers:cross-origin-embedder-policy-4"><a href="iana.html#cross-origin-embedder-policy">Cross-Origin-Embedder-Policy</a></code>` and "<code>item</code>" from <var>response</var>'s <a href="https://triple-underscore.github.io/Fetch-ja.html#concept-response-header-list" id="the-headers:concept-response-header-list" data-x-internal="concept-response-header-list">header list</a>.<li><p>If <var>parsedItem</var> is non-null and <var>parsedItem</var>[0] is "<code>require-corp</code>":</p>

    <ol><li><p>Set <var>policy</var>'s <a href="#embedder-policy-value-2" id="the-headers:embedder-policy-value-2-2">value</a> to "<code id="the-headers:coep-require-corp-2"><a href="#coep-require-corp">require-corp</a></code>".<li><p>If <var>parsedItem</var>[1]["<code id="the-headers:coep-report-to"><a href="#coep-report-to">report-to</a></code>"] <a href="https://triple-underscore.github.io/infra-ja.html#map-exists" id="the-headers:map-exists" data-x-internal="map-exists">exists</a>, then set <var>policy</var>'s <a href="#embedder-policy-reporting-endpoint" id="the-headers:embedder-policy-reporting-endpoint">endpoint</a> to <var>parsedItem</var>[1]["<code id="the-headers:coep-report-to-2"><a href="#coep-report-to">report-to</a></code>"].</ol>
   <li><p>Set <var>parsedItem</var> to the result of <a id="the-headers:getting-a-structured-field-value-2" href="https://triple-underscore.github.io/Fetch-ja.html#concept-header-list-get-structured-header" data-x-internal="getting-a-structured-field-value">getting a structured field value</a> with `<code id="the-headers:cross-origin-embedder-policy-report-only-3"><a href="iana.html#cross-origin-embedder-policy-report-only">Cross-Origin-Embedder-Policy-Report-Only</a></code>` and "<code>item</code>" from <var>response</var>'s <a href="https://triple-underscore.github.io/Fetch-ja.html#concept-response-header-list" id="the-headers:concept-response-header-list-2" data-x-internal="concept-response-header-list">header list</a>.<li><p>If <var>parsedItem</var> is non-null and <var>parsedItem</var>[0] is "<code>require-corp</code>":</p>

    <ol><li><p>Set <var>policy</var>'s <a href="#embedder-policy-report-only-value" id="the-headers:embedder-policy-report-only-value">report only value</a> to "<code id="the-headers:coep-require-corp-3"><a href="#coep-require-corp">require-corp</a></code>".<li><p>If <var>parsedItem</var>[1]["<code id="the-headers:coep-report-to-3"><a href="#coep-report-to">report-to</a></code>"] <a href="https://triple-underscore.github.io/infra-ja.html#map-exists" id="the-headers:map-exists-2" data-x-internal="map-exists">exists</a>, then set <var>policy</var>'s <a href="#embedder-policy-report-only-reporting-endpoint" id="the-headers:embedder-policy-report-only-reporting-endpoint">report only reporting endpoint</a> to <var>parsedItem</var>[1]["<code id="the-headers:coep-report-to-4"><a href="#coep-report-to">report-to</a></code>"].</ol>
   <li><p>Return <var>policy</var>.</ol>

  <h4 id="embedder-policy-checks"><span class="secno">7.8.2</span> Embedder policy checks<a href="#embedder-policy-checks" class="self-link"></a></h4>

  <p>To <dfn id="check-a-navigation-response's-adherence-to-its-embedder-policy">check a navigation response's adherence to its embedder policy</dfn> given a <a href="https://triple-underscore.github.io/Fetch-ja.html#concept-response" id="embedder-policy-checks:concept-response" data-x-internal="concept-response">response</a> <var>response</var> and a <a id="embedder-policy-checks:browsing-context" href="browsers.html#browsing-context">browsing context</a> <var>target</var>:</p>

  <ol><li><p>If <var>target</var> is not a <a id="embedder-policy-checks:child-browsing-context" href="browsers.html#child-browsing-context">child browsing context</a>, then return true.<li><p>Let <var>responsePolicy</var> be the result of <a href="#obtain-an-embedder-policy" id="embedder-policy-checks:obtain-an-embedder-policy">obtaining an embedder policy</a> from <var>response</var>.<li><p>Let <var>parentPolicy</var> be <var>target</var>'s <a href="browsers.html#bc-container-document" id="embedder-policy-checks:bc-container-document">container document</a>'s <a href="dom.html#concept-document-embedder-policy" id="embedder-policy-checks:concept-document-embedder-policy">embedder policy</a>.<li><p>If <var>parentPolicy</var>'s <a href="#embedder-policy-report-only-value" id="embedder-policy-checks:embedder-policy-report-only-value">report only value</a> is "<code id="embedder-policy-checks:coep-require-corp"><a href="#coep-require-corp">require-corp</a></code>" and <var>responsePolicy</var>'s <a href="#embedder-policy-value-2" id="embedder-policy-checks:embedder-policy-value-2">value</a> is "<code id="embedder-policy-checks:coep-unsafe-none"><a href="#coep-unsafe-none">unsafe-none</a></code>", then <a href="#queue-a-cross-origin-embedder-policy-inheritance-violation" id="embedder-policy-checks:queue-a-cross-origin-embedder-policy-inheritance-violation">queue a cross-origin embedder policy inheritance violation</a> with <var>response</var>, "<code>navigation</code>", <var>parentPolicy</var>'s <a href="#embedder-policy-report-only-reporting-endpoint" id="embedder-policy-checks:embedder-policy-report-only-reporting-endpoint">report only reporting endpoint</a>, "<code>reporting</code>", and <var>target</var>'s <a href="browsers.html#bc-container-document" id="embedder-policy-checks:bc-container-document-2">container document</a>'s <a id="embedder-policy-checks:relevant-settings-object" href="webappapis.html#relevant-settings-object">relevant settings object</a>.<li><p>If <var>parentPolicy</var>'s <a href="#embedder-policy-value-2" id="embedder-policy-checks:embedder-policy-value-2-2">value</a> is "<code id="embedder-policy-checks:coep-unsafe-none-2"><a href="#coep-unsafe-none">unsafe-none</a></code>" or <var>responsePolicy</var>'s <a href="#embedder-policy-value-2" id="embedder-policy-checks:embedder-policy-value-2-3">value</a> is "<code id="embedder-policy-checks:coep-require-corp-2"><a href="#coep-require-corp">require-corp</a></code>", then return true.<li><p><a href="#queue-a-cross-origin-embedder-policy-inheritance-violation" id="embedder-policy-checks:queue-a-cross-origin-embedder-policy-inheritance-violation-2">Queue a cross-origin embedder policy inheritance violation</a> with <var>response</var>, "<code>navigation</code>", <var>parentPolicy</var>'s <a href="#embedder-policy-reporting-endpoint" id="embedder-policy-checks:embedder-policy-reporting-endpoint">reporting endpoint</a>, "<code>enforce</code>", and <var>target</var>'s <a href="browsers.html#bc-container-document" id="embedder-policy-checks:bc-container-document-3">container document</a>'s <a id="embedder-policy-checks:relevant-settings-object-2" href="webappapis.html#relevant-settings-object">relevant settings object</a>.<li><p>falseを返す。</ol>

  <p>To <dfn id="check-a-global-object's-embedder-policy">check a global object's embedder policy</dfn> given a <code id="embedder-policy-checks:workerglobalscope"><a href="workers.html#workerglobalscope">WorkerGlobalScope</a></code> <var>workerGlobalScope</var>, an <a id="embedder-policy-checks:environment-settings-object" href="webappapis.html#environment-settings-object">environment settings object</a> <var>owner</var>, and a <a href="https://triple-underscore.github.io/Fetch-ja.html#concept-response" id="embedder-policy-checks:concept-response-2" data-x-internal="concept-response">response</a> <var>response</var>:</p>

  <ol><li><p>If <var>workerGlobalScope</var> is not a <code id="embedder-policy-checks:dedicatedworkerglobalscope"><a href="workers.html#dedicatedworkerglobalscope">DedicatedWorkerGlobalScope</a></code> object, then return true.<li><p>Let <var>policy</var> be <var>workerGlobalScope</var>'s <a href="workers.html#concept-workerglobalscope-embedder-policy" id="embedder-policy-checks:concept-workerglobalscope-embedder-policy">embedder policy</a>.<li><p>Let <var>ownerPolicy</var> be <var>owner</var>'s <a href="webappapis.html#concept-settings-object-embedder-policy" id="embedder-policy-checks:concept-settings-object-embedder-policy">embedder policy</a>.<li><p>If <var>ownerPolicy</var>'s <a href="#embedder-policy-report-only-value" id="embedder-policy-checks:embedder-policy-report-only-value-2">report only value</a> is "<code id="embedder-policy-checks:coep-require-corp-3"><a href="#coep-require-corp">require-corp</a></code>" and <var>policy</var>'s <a href="#embedder-policy-value-2" id="embedder-policy-checks:embedder-policy-value-2-4">value</a> is "<code id="embedder-policy-checks:coep-unsafe-none-3"><a href="#coep-unsafe-none">unsafe-none</a></code>", then <a href="#queue-a-cross-origin-embedder-policy-inheritance-violation" id="embedder-policy-checks:queue-a-cross-origin-embedder-policy-inheritance-violation-3">queue a cross-origin embedder policy inheritance violation</a> with <var>response</var>, "<code>worker initialization</code>", <var>owner's policy</var>'s <a href="#embedder-policy-report-only-reporting-endpoint" id="embedder-policy-checks:embedder-policy-report-only-reporting-endpoint-2">report only reporting endpoint</a>, "<code>reporting</code>", and <var>owner</var>.<li><p>If <var>ownerPolicy</var>'s <a href="#embedder-policy-value-2" id="embedder-policy-checks:embedder-policy-value-2-5">value</a> is "<code id="embedder-policy-checks:coep-unsafe-none-4"><a href="#coep-unsafe-none">unsafe-none</a></code>" or <var>policy</var>'s <a href="#embedder-policy-value-2" id="embedder-policy-checks:embedder-policy-value-2-6">value</a> is "<code id="embedder-policy-checks:coep-require-corp-4"><a href="#coep-require-corp">require-corp</a></code>", then return true.<li><p><a href="#queue-a-cross-origin-embedder-policy-inheritance-violation" id="embedder-policy-checks:queue-a-cross-origin-embedder-policy-inheritance-violation-4">Queue a cross-origin embedder policy inheritance violation</a> with <var>response</var>, "<code>worker initialization</code>", <var>owner's policy</var>'s <a href="#embedder-policy-reporting-endpoint" id="embedder-policy-checks:embedder-policy-reporting-endpoint-2">reporting endpoint</a>, "<code>enforce</code>", and <var>owner</var>.<li><p>falseを返す。</ol>

  <p>To <dfn id="queue-a-cross-origin-embedder-policy-inheritance-violation">queue a cross-origin embedder policy inheritance violation</dfn> given a <a href="https://triple-underscore.github.io/Fetch-ja.html#concept-response" id="embedder-policy-checks:concept-response-3" data-x-internal="concept-response">response</a> <var>response</var>, a string <var>type</var>, a string <var>endpoint</var>, a string <var>disposition</var>, and an <a id="embedder-policy-checks:environment-settings-object-2" href="webappapis.html#environment-settings-object">environment settings object</a> <var>settings</var>:</p>

  <ol><li><p>Let <var>serialized</var> be the result of <a href="https://triple-underscore.github.io/Fetch-ja.html#serialize-a-response-url-for-reporting" id="embedder-policy-checks:serialize-a-response-url-for-reporting" data-x-internal="serialize-a-response-url-for-reporting">serializing a response URL for reporting</a> with <var>response</var>.<li><p>Let <var>body</var> be a new object containing the following properties:</p>

    <table class="data"><thead><tr><th>key<th>value<tbody><tr><td>type<td><var>type</var><tr><td>blockedURL<td><var>serialized</var><tr><td>disposition<td><var>disposition</var></table>
   <li><p><a href="https://w3c.github.io/reporting/#queue-report" id="embedder-policy-checks:queue-a-report" data-x-internal="queue-a-report">Queue</a> <var>body</var> as the <a href="#coep-report-type" id="embedder-policy-checks:coep-report-type">"<code>coep</code>" report type</a> for <var>endpoint</var> on <var>settings</var>.</ol>



  <nav><a href="window-object.html">← 7.3 Windowオブジェクト</a> — <a href="./">目次</a> — <a href="history.html">7.9 セッション履歴およびナビゲーション →</a></nav>
